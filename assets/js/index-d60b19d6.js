const wp=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}};wp();var Xh=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Yh(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Zh={exports:{}};/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */(function(r){(function(e,t){r.exports=e.document?t(e,!0):function(n){if(!n.document)throw new Error("jQuery requires a window with a document");return t(n)}})(typeof window!="undefined"?window:Xh,function(e,t){var n=[],i=Object.getPrototypeOf,s=n.slice,a=n.flat?function(l){return n.flat.call(l)}:function(l){return n.concat.apply([],l)},o=n.push,u=n.indexOf,f={},h=f.toString,c=f.hasOwnProperty,d=c.toString,g=d.call(Object),x={},v=function(p){return typeof p=="function"&&typeof p.nodeType!="number"&&typeof p.item!="function"},b=function(p){return p!=null&&p===p.window},y=e.document,w={type:!0,src:!0,nonce:!0,noModule:!0};function S(l,p,_){_=_||y;var M,E,A=_.createElement("script");if(A.text=l,p)for(M in w)E=p[M]||p.getAttribute&&p.getAttribute(M),E&&A.setAttribute(M,E);_.head.appendChild(A).parentNode.removeChild(A)}function L(l){return l==null?l+"":typeof l=="object"||typeof l=="function"?f[h.call(l)]||"object":typeof l}var T="3.6.0",m=function(l,p){return new m.fn.init(l,p)};m.fn=m.prototype={jquery:T,constructor:m,length:0,toArray:function(){return s.call(this)},get:function(l){return l==null?s.call(this):l<0?this[l+this.length]:this[l]},pushStack:function(l){var p=m.merge(this.constructor(),l);return p.prevObject=this,p},each:function(l){return m.each(this,l)},map:function(l){return this.pushStack(m.map(this,function(p,_){return l.call(p,_,p)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(m.grep(this,function(l,p){return(p+1)%2}))},odd:function(){return this.pushStack(m.grep(this,function(l,p){return p%2}))},eq:function(l){var p=this.length,_=+l+(l<0?p:0);return this.pushStack(_>=0&&_<p?[this[_]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:n.sort,splice:n.splice},m.extend=m.fn.extend=function(){var l,p,_,M,E,A,R=arguments[0]||{},H=1,G=arguments.length,ee=!1;for(typeof R=="boolean"&&(ee=R,R=arguments[H]||{},H++),typeof R!="object"&&!v(R)&&(R={}),H===G&&(R=this,H--);H<G;H++)if((l=arguments[H])!=null)for(p in l)M=l[p],!(p==="__proto__"||R===M)&&(ee&&M&&(m.isPlainObject(M)||(E=Array.isArray(M)))?(_=R[p],E&&!Array.isArray(_)?A=[]:!E&&!m.isPlainObject(_)?A={}:A=_,E=!1,R[p]=m.extend(ee,A,M)):M!==void 0&&(R[p]=M));return R},m.extend({expando:"jQuery"+(T+Math.random()).replace(/\D/g,""),isReady:!0,error:function(l){throw new Error(l)},noop:function(){},isPlainObject:function(l){var p,_;return!l||h.call(l)!=="[object Object]"?!1:(p=i(l),p?(_=c.call(p,"constructor")&&p.constructor,typeof _=="function"&&d.call(_)===g):!0)},isEmptyObject:function(l){var p;for(p in l)return!1;return!0},globalEval:function(l,p,_){S(l,{nonce:p&&p.nonce},_)},each:function(l,p){var _,M=0;if(C(l))for(_=l.length;M<_&&p.call(l[M],M,l[M])!==!1;M++);else for(M in l)if(p.call(l[M],M,l[M])===!1)break;return l},makeArray:function(l,p){var _=p||[];return l!=null&&(C(Object(l))?m.merge(_,typeof l=="string"?[l]:l):o.call(_,l)),_},inArray:function(l,p,_){return p==null?-1:u.call(p,l,_)},merge:function(l,p){for(var _=+p.length,M=0,E=l.length;M<_;M++)l[E++]=p[M];return l.length=E,l},grep:function(l,p,_){for(var M,E=[],A=0,R=l.length,H=!_;A<R;A++)M=!p(l[A],A),M!==H&&E.push(l[A]);return E},map:function(l,p,_){var M,E,A=0,R=[];if(C(l))for(M=l.length;A<M;A++)E=p(l[A],A,_),E!=null&&R.push(E);else for(A in l)E=p(l[A],A,_),E!=null&&R.push(E);return a(R)},guid:1,support:x}),typeof Symbol=="function"&&(m.fn[Symbol.iterator]=n[Symbol.iterator]),m.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(l,p){f["[object "+p+"]"]=p.toLowerCase()});function C(l){var p=!!l&&"length"in l&&l.length,_=L(l);return v(l)||b(l)?!1:_==="array"||p===0||typeof p=="number"&&p>0&&p-1 in l}var N=function(l){var p,_,M,E,A,R,H,G,ee,he,Le,ae,xe,Ze,ht,$e,Zt,Xt,In,St="sizzle"+1*new Date,ut=l.document,Tn=0,xt=0,Bt=fa(),Ts=fa(),ca=fa(),Fn=fa(),or=function(P,k){return P===k&&(Le=!0),0},lr={}.hasOwnProperty,An=[],Pi=An.pop,qn=An.push,Ni=An.push,Qc=An.slice,cr=function(P,k){for(var Z=0,_e=P.length;Z<_e;Z++)if(P[Z]===k)return Z;return-1},Go="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",wt="[\\x20\\t\\r\\n\\f]",ur="(?:\\\\[\\da-fA-F]{1,6}"+wt+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Kc="\\["+wt+"*("+ur+")(?:"+wt+"*([*^$|!~]?=)"+wt+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+ur+"))|)"+wt+"*\\]",Wo=":("+ur+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Kc+")*)|.*)\\)|)",op=new RegExp(wt+"+","g"),ua=new RegExp("^"+wt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+wt+"+$","g"),lp=new RegExp("^"+wt+"*,"+wt+"*"),eu=new RegExp("^"+wt+"*([>+~]|"+wt+")"+wt+"*"),cp=new RegExp(wt+"|>"),up=new RegExp(Wo),hp=new RegExp("^"+ur+"$"),ha={ID:new RegExp("^#("+ur+")"),CLASS:new RegExp("^\\.("+ur+")"),TAG:new RegExp("^("+ur+"|[*])"),ATTR:new RegExp("^"+Kc),PSEUDO:new RegExp("^"+Wo),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+wt+"*(even|odd|(([+-]|)(\\d*)n|)"+wt+"*(?:([+-]|)"+wt+"*(\\d+)|))"+wt+"*\\)|)","i"),bool:new RegExp("^(?:"+Go+")$","i"),needsContext:new RegExp("^"+wt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+wt+"*((?:-\\d)?\\d*)"+wt+"*\\)|)(?=[^-]|$)","i")},fp=/HTML$/i,dp=/^(?:input|select|textarea|button)$/i,pp=/^h\d$/i,As=/^[^{]+\{\s*\[native \w/,mp=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,qo=/[+~]/,wi=new RegExp("\\\\[\\da-fA-F]{1,6}"+wt+"?|\\\\([^\\r\\n\\f])","g"),bi=function(P,k){var Z="0x"+P.slice(1)-65536;return k||(Z<0?String.fromCharCode(Z+65536):String.fromCharCode(Z>>10|55296,Z&1023|56320))},tu=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,nu=function(P,k){return k?P==="\0"?"\uFFFD":P.slice(0,-1)+"\\"+P.charCodeAt(P.length-1).toString(16)+" ":"\\"+P},iu=function(){ae()},gp=pa(function(P){return P.disabled===!0&&P.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{Ni.apply(An=Qc.call(ut.childNodes),ut.childNodes),An[ut.childNodes.length].nodeType}catch{Ni={apply:An.length?function(k,Z){qn.apply(k,Qc.call(Z))}:function(k,Z){for(var _e=k.length,te=0;k[_e++]=Z[te++];);k.length=_e-1}}}function Tt(P,k,Z,_e){var te,be,Re,He,qe,tt,et,rt=k&&k.ownerDocument,gt=k?k.nodeType:9;if(Z=Z||[],typeof P!="string"||!P||gt!==1&&gt!==9&&gt!==11)return Z;if(!_e&&(ae(k),k=k||xe,ht)){if(gt!==11&&(qe=mp.exec(P)))if(te=qe[1]){if(gt===9)if(Re=k.getElementById(te)){if(Re.id===te)return Z.push(Re),Z}else return Z;else if(rt&&(Re=rt.getElementById(te))&&In(k,Re)&&Re.id===te)return Z.push(Re),Z}else{if(qe[2])return Ni.apply(Z,k.getElementsByTagName(P)),Z;if((te=qe[3])&&_.getElementsByClassName&&k.getElementsByClassName)return Ni.apply(Z,k.getElementsByClassName(te)),Z}if(_.qsa&&!Fn[P+" "]&&(!$e||!$e.test(P))&&(gt!==1||k.nodeName.toLowerCase()!=="object")){if(et=P,rt=k,gt===1&&(cp.test(P)||eu.test(P))){for(rt=qo.test(P)&&Xo(k.parentNode)||k,(rt!==k||!_.scope)&&((He=k.getAttribute("id"))?He=He.replace(tu,nu):k.setAttribute("id",He=St)),tt=R(P),be=tt.length;be--;)tt[be]=(He?"#"+He:":scope")+" "+da(tt[be]);et=tt.join(",")}try{return Ni.apply(Z,rt.querySelectorAll(et)),Z}catch{Fn(P,!0)}finally{He===St&&k.removeAttribute("id")}}}return G(P.replace(ua,"$1"),k,Z,_e)}function fa(){var P=[];function k(Z,_e){return P.push(Z+" ")>M.cacheLength&&delete k[P.shift()],k[Z+" "]=_e}return k}function ei(P){return P[St]=!0,P}function ti(P){var k=xe.createElement("fieldset");try{return!!P(k)}catch{return!1}finally{k.parentNode&&k.parentNode.removeChild(k),k=null}}function jo(P,k){for(var Z=P.split("|"),_e=Z.length;_e--;)M.attrHandle[Z[_e]]=k}function ru(P,k){var Z=k&&P,_e=Z&&P.nodeType===1&&k.nodeType===1&&P.sourceIndex-k.sourceIndex;if(_e)return _e;if(Z){for(;Z=Z.nextSibling;)if(Z===k)return-1}return P?1:-1}function vp(P){return function(k){var Z=k.nodeName.toLowerCase();return Z==="input"&&k.type===P}}function yp(P){return function(k){var Z=k.nodeName.toLowerCase();return(Z==="input"||Z==="button")&&k.type===P}}function su(P){return function(k){return"form"in k?k.parentNode&&k.disabled===!1?"label"in k?"label"in k.parentNode?k.parentNode.disabled===P:k.disabled===P:k.isDisabled===P||k.isDisabled!==!P&&gp(k)===P:k.disabled===P:"label"in k?k.disabled===P:!1}}function hr(P){return ei(function(k){return k=+k,ei(function(Z,_e){for(var te,be=P([],Z.length,k),Re=be.length;Re--;)Z[te=be[Re]]&&(Z[te]=!(_e[te]=Z[te]))})})}function Xo(P){return P&&typeof P.getElementsByTagName!="undefined"&&P}_=Tt.support={},A=Tt.isXML=function(P){var k=P&&P.namespaceURI,Z=P&&(P.ownerDocument||P).documentElement;return!fp.test(k||Z&&Z.nodeName||"HTML")},ae=Tt.setDocument=function(P){var k,Z,_e=P?P.ownerDocument||P:ut;return _e==xe||_e.nodeType!==9||!_e.documentElement||(xe=_e,Ze=xe.documentElement,ht=!A(xe),ut!=xe&&(Z=xe.defaultView)&&Z.top!==Z&&(Z.addEventListener?Z.addEventListener("unload",iu,!1):Z.attachEvent&&Z.attachEvent("onunload",iu)),_.scope=ti(function(te){return Ze.appendChild(te).appendChild(xe.createElement("div")),typeof te.querySelectorAll!="undefined"&&!te.querySelectorAll(":scope fieldset div").length}),_.attributes=ti(function(te){return te.className="i",!te.getAttribute("className")}),_.getElementsByTagName=ti(function(te){return te.appendChild(xe.createComment("")),!te.getElementsByTagName("*").length}),_.getElementsByClassName=As.test(xe.getElementsByClassName),_.getById=ti(function(te){return Ze.appendChild(te).id=St,!xe.getElementsByName||!xe.getElementsByName(St).length}),_.getById?(M.filter.ID=function(te){var be=te.replace(wi,bi);return function(Re){return Re.getAttribute("id")===be}},M.find.ID=function(te,be){if(typeof be.getElementById!="undefined"&&ht){var Re=be.getElementById(te);return Re?[Re]:[]}}):(M.filter.ID=function(te){var be=te.replace(wi,bi);return function(Re){var He=typeof Re.getAttributeNode!="undefined"&&Re.getAttributeNode("id");return He&&He.value===be}},M.find.ID=function(te,be){if(typeof be.getElementById!="undefined"&&ht){var Re,He,qe,tt=be.getElementById(te);if(tt){if(Re=tt.getAttributeNode("id"),Re&&Re.value===te)return[tt];for(qe=be.getElementsByName(te),He=0;tt=qe[He++];)if(Re=tt.getAttributeNode("id"),Re&&Re.value===te)return[tt]}return[]}}),M.find.TAG=_.getElementsByTagName?function(te,be){if(typeof be.getElementsByTagName!="undefined")return be.getElementsByTagName(te);if(_.qsa)return be.querySelectorAll(te)}:function(te,be){var Re,He=[],qe=0,tt=be.getElementsByTagName(te);if(te==="*"){for(;Re=tt[qe++];)Re.nodeType===1&&He.push(Re);return He}return tt},M.find.CLASS=_.getElementsByClassName&&function(te,be){if(typeof be.getElementsByClassName!="undefined"&&ht)return be.getElementsByClassName(te)},Zt=[],$e=[],(_.qsa=As.test(xe.querySelectorAll))&&(ti(function(te){var be;Ze.appendChild(te).innerHTML="<a id='"+St+"'></a><select id='"+St+"-\r\\' msallowcapture=''><option selected=''></option></select>",te.querySelectorAll("[msallowcapture^='']").length&&$e.push("[*^$]="+wt+`*(?:''|"")`),te.querySelectorAll("[selected]").length||$e.push("\\["+wt+"*(?:value|"+Go+")"),te.querySelectorAll("[id~="+St+"-]").length||$e.push("~="),be=xe.createElement("input"),be.setAttribute("name",""),te.appendChild(be),te.querySelectorAll("[name='']").length||$e.push("\\["+wt+"*name"+wt+"*="+wt+`*(?:''|"")`),te.querySelectorAll(":checked").length||$e.push(":checked"),te.querySelectorAll("a#"+St+"+*").length||$e.push(".#.+[+~]"),te.querySelectorAll("\\\f"),$e.push("[\\r\\n\\f]")}),ti(function(te){te.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var be=xe.createElement("input");be.setAttribute("type","hidden"),te.appendChild(be).setAttribute("name","D"),te.querySelectorAll("[name=d]").length&&$e.push("name"+wt+"*[*^$|!~]?="),te.querySelectorAll(":enabled").length!==2&&$e.push(":enabled",":disabled"),Ze.appendChild(te).disabled=!0,te.querySelectorAll(":disabled").length!==2&&$e.push(":enabled",":disabled"),te.querySelectorAll("*,:x"),$e.push(",.*:")})),(_.matchesSelector=As.test(Xt=Ze.matches||Ze.webkitMatchesSelector||Ze.mozMatchesSelector||Ze.oMatchesSelector||Ze.msMatchesSelector))&&ti(function(te){_.disconnectedMatch=Xt.call(te,"*"),Xt.call(te,"[s!='']:x"),Zt.push("!=",Wo)}),$e=$e.length&&new RegExp($e.join("|")),Zt=Zt.length&&new RegExp(Zt.join("|")),k=As.test(Ze.compareDocumentPosition),In=k||As.test(Ze.contains)?function(te,be){var Re=te.nodeType===9?te.documentElement:te,He=be&&be.parentNode;return te===He||!!(He&&He.nodeType===1&&(Re.contains?Re.contains(He):te.compareDocumentPosition&&te.compareDocumentPosition(He)&16))}:function(te,be){if(be){for(;be=be.parentNode;)if(be===te)return!0}return!1},or=k?function(te,be){if(te===be)return Le=!0,0;var Re=!te.compareDocumentPosition-!be.compareDocumentPosition;return Re||(Re=(te.ownerDocument||te)==(be.ownerDocument||be)?te.compareDocumentPosition(be):1,Re&1||!_.sortDetached&&be.compareDocumentPosition(te)===Re?te==xe||te.ownerDocument==ut&&In(ut,te)?-1:be==xe||be.ownerDocument==ut&&In(ut,be)?1:he?cr(he,te)-cr(he,be):0:Re&4?-1:1)}:function(te,be){if(te===be)return Le=!0,0;var Re,He=0,qe=te.parentNode,tt=be.parentNode,et=[te],rt=[be];if(!qe||!tt)return te==xe?-1:be==xe?1:qe?-1:tt?1:he?cr(he,te)-cr(he,be):0;if(qe===tt)return ru(te,be);for(Re=te;Re=Re.parentNode;)et.unshift(Re);for(Re=be;Re=Re.parentNode;)rt.unshift(Re);for(;et[He]===rt[He];)He++;return He?ru(et[He],rt[He]):et[He]==ut?-1:rt[He]==ut?1:0}),xe},Tt.matches=function(P,k){return Tt(P,null,null,k)},Tt.matchesSelector=function(P,k){if(ae(P),_.matchesSelector&&ht&&!Fn[k+" "]&&(!Zt||!Zt.test(k))&&(!$e||!$e.test(k)))try{var Z=Xt.call(P,k);if(Z||_.disconnectedMatch||P.document&&P.document.nodeType!==11)return Z}catch{Fn(k,!0)}return Tt(k,xe,null,[P]).length>0},Tt.contains=function(P,k){return(P.ownerDocument||P)!=xe&&ae(P),In(P,k)},Tt.attr=function(P,k){(P.ownerDocument||P)!=xe&&ae(P);var Z=M.attrHandle[k.toLowerCase()],_e=Z&&lr.call(M.attrHandle,k.toLowerCase())?Z(P,k,!ht):void 0;return _e!==void 0?_e:_.attributes||!ht?P.getAttribute(k):(_e=P.getAttributeNode(k))&&_e.specified?_e.value:null},Tt.escape=function(P){return(P+"").replace(tu,nu)},Tt.error=function(P){throw new Error("Syntax error, unrecognized expression: "+P)},Tt.uniqueSort=function(P){var k,Z=[],_e=0,te=0;if(Le=!_.detectDuplicates,he=!_.sortStable&&P.slice(0),P.sort(or),Le){for(;k=P[te++];)k===P[te]&&(_e=Z.push(te));for(;_e--;)P.splice(Z[_e],1)}return he=null,P},E=Tt.getText=function(P){var k,Z="",_e=0,te=P.nodeType;if(te){if(te===1||te===9||te===11){if(typeof P.textContent=="string")return P.textContent;for(P=P.firstChild;P;P=P.nextSibling)Z+=E(P)}else if(te===3||te===4)return P.nodeValue}else for(;k=P[_e++];)Z+=E(k);return Z},M=Tt.selectors={cacheLength:50,createPseudo:ei,match:ha,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(P){return P[1]=P[1].replace(wi,bi),P[3]=(P[3]||P[4]||P[5]||"").replace(wi,bi),P[2]==="~="&&(P[3]=" "+P[3]+" "),P.slice(0,4)},CHILD:function(P){return P[1]=P[1].toLowerCase(),P[1].slice(0,3)==="nth"?(P[3]||Tt.error(P[0]),P[4]=+(P[4]?P[5]+(P[6]||1):2*(P[3]==="even"||P[3]==="odd")),P[5]=+(P[7]+P[8]||P[3]==="odd")):P[3]&&Tt.error(P[0]),P},PSEUDO:function(P){var k,Z=!P[6]&&P[2];return ha.CHILD.test(P[0])?null:(P[3]?P[2]=P[4]||P[5]||"":Z&&up.test(Z)&&(k=R(Z,!0))&&(k=Z.indexOf(")",Z.length-k)-Z.length)&&(P[0]=P[0].slice(0,k),P[2]=Z.slice(0,k)),P.slice(0,3))}},filter:{TAG:function(P){var k=P.replace(wi,bi).toLowerCase();return P==="*"?function(){return!0}:function(Z){return Z.nodeName&&Z.nodeName.toLowerCase()===k}},CLASS:function(P){var k=Bt[P+" "];return k||(k=new RegExp("(^|"+wt+")"+P+"("+wt+"|$)"))&&Bt(P,function(Z){return k.test(typeof Z.className=="string"&&Z.className||typeof Z.getAttribute!="undefined"&&Z.getAttribute("class")||"")})},ATTR:function(P,k,Z){return function(_e){var te=Tt.attr(_e,P);return te==null?k==="!=":k?(te+="",k==="="?te===Z:k==="!="?te!==Z:k==="^="?Z&&te.indexOf(Z)===0:k==="*="?Z&&te.indexOf(Z)>-1:k==="$="?Z&&te.slice(-Z.length)===Z:k==="~="?(" "+te.replace(op," ")+" ").indexOf(Z)>-1:k==="|="?te===Z||te.slice(0,Z.length+1)===Z+"-":!1):!0}},CHILD:function(P,k,Z,_e,te){var be=P.slice(0,3)!=="nth",Re=P.slice(-4)!=="last",He=k==="of-type";return _e===1&&te===0?function(qe){return!!qe.parentNode}:function(qe,tt,et){var rt,gt,At,nt,$t,dn,Bn=be!==Re?"nextSibling":"previousSibling",It=qe.parentNode,Cs=He&&qe.nodeName.toLowerCase(),Ls=!et&&!He,On=!1;if(It){if(be){for(;Bn;){for(nt=qe;nt=nt[Bn];)if(He?nt.nodeName.toLowerCase()===Cs:nt.nodeType===1)return!1;dn=Bn=P==="only"&&!dn&&"nextSibling"}return!0}if(dn=[Re?It.firstChild:It.lastChild],Re&&Ls){for(nt=It,At=nt[St]||(nt[St]={}),gt=At[nt.uniqueID]||(At[nt.uniqueID]={}),rt=gt[P]||[],$t=rt[0]===Tn&&rt[1],On=$t&&rt[2],nt=$t&&It.childNodes[$t];nt=++$t&&nt&&nt[Bn]||(On=$t=0)||dn.pop();)if(nt.nodeType===1&&++On&&nt===qe){gt[P]=[Tn,$t,On];break}}else if(Ls&&(nt=qe,At=nt[St]||(nt[St]={}),gt=At[nt.uniqueID]||(At[nt.uniqueID]={}),rt=gt[P]||[],$t=rt[0]===Tn&&rt[1],On=$t),On===!1)for(;(nt=++$t&&nt&&nt[Bn]||(On=$t=0)||dn.pop())&&!((He?nt.nodeName.toLowerCase()===Cs:nt.nodeType===1)&&++On&&(Ls&&(At=nt[St]||(nt[St]={}),gt=At[nt.uniqueID]||(At[nt.uniqueID]={}),gt[P]=[Tn,On]),nt===qe)););return On-=te,On===_e||On%_e===0&&On/_e>=0}}},PSEUDO:function(P,k){var Z,_e=M.pseudos[P]||M.setFilters[P.toLowerCase()]||Tt.error("unsupported pseudo: "+P);return _e[St]?_e(k):_e.length>1?(Z=[P,P,"",k],M.setFilters.hasOwnProperty(P.toLowerCase())?ei(function(te,be){for(var Re,He=_e(te,k),qe=He.length;qe--;)Re=cr(te,He[qe]),te[Re]=!(be[Re]=He[qe])}):function(te){return _e(te,0,Z)}):_e}},pseudos:{not:ei(function(P){var k=[],Z=[],_e=H(P.replace(ua,"$1"));return _e[St]?ei(function(te,be,Re,He){for(var qe,tt=_e(te,null,He,[]),et=te.length;et--;)(qe=tt[et])&&(te[et]=!(be[et]=qe))}):function(te,be,Re){return k[0]=te,_e(k,null,Re,Z),k[0]=null,!Z.pop()}}),has:ei(function(P){return function(k){return Tt(P,k).length>0}}),contains:ei(function(P){return P=P.replace(wi,bi),function(k){return(k.textContent||E(k)).indexOf(P)>-1}}),lang:ei(function(P){return hp.test(P||"")||Tt.error("unsupported lang: "+P),P=P.replace(wi,bi).toLowerCase(),function(k){var Z;do if(Z=ht?k.lang:k.getAttribute("xml:lang")||k.getAttribute("lang"))return Z=Z.toLowerCase(),Z===P||Z.indexOf(P+"-")===0;while((k=k.parentNode)&&k.nodeType===1);return!1}}),target:function(P){var k=l.location&&l.location.hash;return k&&k.slice(1)===P.id},root:function(P){return P===Ze},focus:function(P){return P===xe.activeElement&&(!xe.hasFocus||xe.hasFocus())&&!!(P.type||P.href||~P.tabIndex)},enabled:su(!1),disabled:su(!0),checked:function(P){var k=P.nodeName.toLowerCase();return k==="input"&&!!P.checked||k==="option"&&!!P.selected},selected:function(P){return P.parentNode&&P.parentNode.selectedIndex,P.selected===!0},empty:function(P){for(P=P.firstChild;P;P=P.nextSibling)if(P.nodeType<6)return!1;return!0},parent:function(P){return!M.pseudos.empty(P)},header:function(P){return pp.test(P.nodeName)},input:function(P){return dp.test(P.nodeName)},button:function(P){var k=P.nodeName.toLowerCase();return k==="input"&&P.type==="button"||k==="button"},text:function(P){var k;return P.nodeName.toLowerCase()==="input"&&P.type==="text"&&((k=P.getAttribute("type"))==null||k.toLowerCase()==="text")},first:hr(function(){return[0]}),last:hr(function(P,k){return[k-1]}),eq:hr(function(P,k,Z){return[Z<0?Z+k:Z]}),even:hr(function(P,k){for(var Z=0;Z<k;Z+=2)P.push(Z);return P}),odd:hr(function(P,k){for(var Z=1;Z<k;Z+=2)P.push(Z);return P}),lt:hr(function(P,k,Z){for(var _e=Z<0?Z+k:Z>k?k:Z;--_e>=0;)P.push(_e);return P}),gt:hr(function(P,k,Z){for(var _e=Z<0?Z+k:Z;++_e<k;)P.push(_e);return P})}},M.pseudos.nth=M.pseudos.eq;for(p in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})M.pseudos[p]=vp(p);for(p in{submit:!0,reset:!0})M.pseudos[p]=yp(p);function au(){}au.prototype=M.filters=M.pseudos,M.setFilters=new au,R=Tt.tokenize=function(P,k){var Z,_e,te,be,Re,He,qe,tt=Ts[P+" "];if(tt)return k?0:tt.slice(0);for(Re=P,He=[],qe=M.preFilter;Re;){(!Z||(_e=lp.exec(Re)))&&(_e&&(Re=Re.slice(_e[0].length)||Re),He.push(te=[])),Z=!1,(_e=eu.exec(Re))&&(Z=_e.shift(),te.push({value:Z,type:_e[0].replace(ua," ")}),Re=Re.slice(Z.length));for(be in M.filter)(_e=ha[be].exec(Re))&&(!qe[be]||(_e=qe[be](_e)))&&(Z=_e.shift(),te.push({value:Z,type:be,matches:_e}),Re=Re.slice(Z.length));if(!Z)break}return k?Re.length:Re?Tt.error(P):Ts(P,He).slice(0)};function da(P){for(var k=0,Z=P.length,_e="";k<Z;k++)_e+=P[k].value;return _e}function pa(P,k,Z){var _e=k.dir,te=k.next,be=te||_e,Re=Z&&be==="parentNode",He=xt++;return k.first?function(qe,tt,et){for(;qe=qe[_e];)if(qe.nodeType===1||Re)return P(qe,tt,et);return!1}:function(qe,tt,et){var rt,gt,At,nt=[Tn,He];if(et){for(;qe=qe[_e];)if((qe.nodeType===1||Re)&&P(qe,tt,et))return!0}else for(;qe=qe[_e];)if(qe.nodeType===1||Re)if(At=qe[St]||(qe[St]={}),gt=At[qe.uniqueID]||(At[qe.uniqueID]={}),te&&te===qe.nodeName.toLowerCase())qe=qe[_e]||qe;else{if((rt=gt[be])&&rt[0]===Tn&&rt[1]===He)return nt[2]=rt[2];if(gt[be]=nt,nt[2]=P(qe,tt,et))return!0}return!1}}function Yo(P){return P.length>1?function(k,Z,_e){for(var te=P.length;te--;)if(!P[te](k,Z,_e))return!1;return!0}:P[0]}function xp(P,k,Z){for(var _e=0,te=k.length;_e<te;_e++)Tt(P,k[_e],Z);return Z}function ma(P,k,Z,_e,te){for(var be,Re=[],He=0,qe=P.length,tt=k!=null;He<qe;He++)(be=P[He])&&(!Z||Z(be,_e,te))&&(Re.push(be),tt&&k.push(He));return Re}function Zo(P,k,Z,_e,te,be){return _e&&!_e[St]&&(_e=Zo(_e)),te&&!te[St]&&(te=Zo(te,be)),ei(function(Re,He,qe,tt){var et,rt,gt,At=[],nt=[],$t=He.length,dn=Re||xp(k||"*",qe.nodeType?[qe]:qe,[]),Bn=P&&(Re||!k)?ma(dn,At,P,qe,tt):dn,It=Z?te||(Re?P:$t||_e)?[]:He:Bn;if(Z&&Z(Bn,It,qe,tt),_e)for(et=ma(It,nt),_e(et,[],qe,tt),rt=et.length;rt--;)(gt=et[rt])&&(It[nt[rt]]=!(Bn[nt[rt]]=gt));if(Re){if(te||P){if(te){for(et=[],rt=It.length;rt--;)(gt=It[rt])&&et.push(Bn[rt]=gt);te(null,It=[],et,tt)}for(rt=It.length;rt--;)(gt=It[rt])&&(et=te?cr(Re,gt):At[rt])>-1&&(Re[et]=!(He[et]=gt))}}else It=ma(It===He?It.splice($t,It.length):It),te?te(null,He,It,tt):Ni.apply(He,It)})}function $o(P){for(var k,Z,_e,te=P.length,be=M.relative[P[0].type],Re=be||M.relative[" "],He=be?1:0,qe=pa(function(rt){return rt===k},Re,!0),tt=pa(function(rt){return cr(k,rt)>-1},Re,!0),et=[function(rt,gt,At){var nt=!be&&(At||gt!==ee)||((k=gt).nodeType?qe(rt,gt,At):tt(rt,gt,At));return k=null,nt}];He<te;He++)if(Z=M.relative[P[He].type])et=[pa(Yo(et),Z)];else{if(Z=M.filter[P[He].type].apply(null,P[He].matches),Z[St]){for(_e=++He;_e<te&&!M.relative[P[_e].type];_e++);return Zo(He>1&&Yo(et),He>1&&da(P.slice(0,He-1).concat({value:P[He-2].type===" "?"*":""})).replace(ua,"$1"),Z,He<_e&&$o(P.slice(He,_e)),_e<te&&$o(P=P.slice(_e)),_e<te&&da(P))}et.push(Z)}return Yo(et)}function _p(P,k){var Z=k.length>0,_e=P.length>0,te=function(be,Re,He,qe,tt){var et,rt,gt,At=0,nt="0",$t=be&&[],dn=[],Bn=ee,It=be||_e&&M.find.TAG("*",tt),Cs=Tn+=Bn==null?1:Math.random()||.1,Ls=It.length;for(tt&&(ee=Re==xe||Re||tt);nt!==Ls&&(et=It[nt])!=null;nt++){if(_e&&et){for(rt=0,!Re&&et.ownerDocument!=xe&&(ae(et),He=!ht);gt=P[rt++];)if(gt(et,Re||xe,He)){qe.push(et);break}tt&&(Tn=Cs)}Z&&((et=!gt&&et)&&At--,be&&$t.push(et))}if(At+=nt,Z&&nt!==At){for(rt=0;gt=k[rt++];)gt($t,dn,Re,He);if(be){if(At>0)for(;nt--;)$t[nt]||dn[nt]||(dn[nt]=Pi.call(qe));dn=ma(dn)}Ni.apply(qe,dn),tt&&!be&&dn.length>0&&At+k.length>1&&Tt.uniqueSort(qe)}return tt&&(Tn=Cs,ee=Bn),$t};return Z?ei(te):te}return H=Tt.compile=function(P,k){var Z,_e=[],te=[],be=ca[P+" "];if(!be){for(k||(k=R(P)),Z=k.length;Z--;)be=$o(k[Z]),be[St]?_e.push(be):te.push(be);be=ca(P,_p(te,_e)),be.selector=P}return be},G=Tt.select=function(P,k,Z,_e){var te,be,Re,He,qe,tt=typeof P=="function"&&P,et=!_e&&R(P=tt.selector||P);if(Z=Z||[],et.length===1){if(be=et[0]=et[0].slice(0),be.length>2&&(Re=be[0]).type==="ID"&&k.nodeType===9&&ht&&M.relative[be[1].type]){if(k=(M.find.ID(Re.matches[0].replace(wi,bi),k)||[])[0],k)tt&&(k=k.parentNode);else return Z;P=P.slice(be.shift().value.length)}for(te=ha.needsContext.test(P)?0:be.length;te--&&(Re=be[te],!M.relative[He=Re.type]);)if((qe=M.find[He])&&(_e=qe(Re.matches[0].replace(wi,bi),qo.test(be[0].type)&&Xo(k.parentNode)||k))){if(be.splice(te,1),P=_e.length&&da(be),!P)return Ni.apply(Z,_e),Z;break}}return(tt||H(P,et))(_e,k,!ht,Z,!k||qo.test(P)&&Xo(k.parentNode)||k),Z},_.sortStable=St.split("").sort(or).join("")===St,_.detectDuplicates=!!Le,ae(),_.sortDetached=ti(function(P){return P.compareDocumentPosition(xe.createElement("fieldset"))&1}),ti(function(P){return P.innerHTML="<a href='#'></a>",P.firstChild.getAttribute("href")==="#"})||jo("type|href|height|width",function(P,k,Z){if(!Z)return P.getAttribute(k,k.toLowerCase()==="type"?1:2)}),(!_.attributes||!ti(function(P){return P.innerHTML="<input/>",P.firstChild.setAttribute("value",""),P.firstChild.getAttribute("value")===""}))&&jo("value",function(P,k,Z){if(!Z&&P.nodeName.toLowerCase()==="input")return P.defaultValue}),ti(function(P){return P.getAttribute("disabled")==null})||jo(Go,function(P,k,Z){var _e;if(!Z)return P[k]===!0?k.toLowerCase():(_e=P.getAttributeNode(k))&&_e.specified?_e.value:null}),Tt}(e);m.find=N,m.expr=N.selectors,m.expr[":"]=m.expr.pseudos,m.uniqueSort=m.unique=N.uniqueSort,m.text=N.getText,m.isXMLDoc=N.isXML,m.contains=N.contains,m.escapeSelector=N.escape;var z=function(l,p,_){for(var M=[],E=_!==void 0;(l=l[p])&&l.nodeType!==9;)if(l.nodeType===1){if(E&&m(l).is(_))break;M.push(l)}return M},W=function(l,p){for(var _=[];l;l=l.nextSibling)l.nodeType===1&&l!==p&&_.push(l);return _},B=m.expr.match.needsContext;function se(l,p){return l.nodeName&&l.nodeName.toLowerCase()===p.toLowerCase()}var $=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Q(l,p,_){return v(p)?m.grep(l,function(M,E){return!!p.call(M,E,M)!==_}):p.nodeType?m.grep(l,function(M){return M===p!==_}):typeof p!="string"?m.grep(l,function(M){return u.call(p,M)>-1!==_}):m.filter(p,l,_)}m.filter=function(l,p,_){var M=p[0];return _&&(l=":not("+l+")"),p.length===1&&M.nodeType===1?m.find.matchesSelector(M,l)?[M]:[]:m.find.matches(l,m.grep(p,function(E){return E.nodeType===1}))},m.fn.extend({find:function(l){var p,_,M=this.length,E=this;if(typeof l!="string")return this.pushStack(m(l).filter(function(){for(p=0;p<M;p++)if(m.contains(E[p],this))return!0}));for(_=this.pushStack([]),p=0;p<M;p++)m.find(l,E[p],_);return M>1?m.uniqueSort(_):_},filter:function(l){return this.pushStack(Q(this,l||[],!1))},not:function(l){return this.pushStack(Q(this,l||[],!0))},is:function(l){return!!Q(this,typeof l=="string"&&B.test(l)?m(l):l||[],!1).length}});var K,j=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,ie=m.fn.init=function(l,p,_){var M,E;if(!l)return this;if(_=_||K,typeof l=="string")if(l[0]==="<"&&l[l.length-1]===">"&&l.length>=3?M=[null,l,null]:M=j.exec(l),M&&(M[1]||!p))if(M[1]){if(p=p instanceof m?p[0]:p,m.merge(this,m.parseHTML(M[1],p&&p.nodeType?p.ownerDocument||p:y,!0)),$.test(M[1])&&m.isPlainObject(p))for(M in p)v(this[M])?this[M](p[M]):this.attr(M,p[M]);return this}else return E=y.getElementById(M[2]),E&&(this[0]=E,this.length=1),this;else return!p||p.jquery?(p||_).find(l):this.constructor(p).find(l);else{if(l.nodeType)return this[0]=l,this.length=1,this;if(v(l))return _.ready!==void 0?_.ready(l):l(m)}return m.makeArray(l,this)};ie.prototype=m.fn,K=m(y);var de=/^(?:parents|prev(?:Until|All))/,we={children:!0,contents:!0,next:!0,prev:!0};m.fn.extend({has:function(l){var p=m(l,this),_=p.length;return this.filter(function(){for(var M=0;M<_;M++)if(m.contains(this,p[M]))return!0})},closest:function(l,p){var _,M=0,E=this.length,A=[],R=typeof l!="string"&&m(l);if(!B.test(l)){for(;M<E;M++)for(_=this[M];_&&_!==p;_=_.parentNode)if(_.nodeType<11&&(R?R.index(_)>-1:_.nodeType===1&&m.find.matchesSelector(_,l))){A.push(_);break}}return this.pushStack(A.length>1?m.uniqueSort(A):A)},index:function(l){return l?typeof l=="string"?u.call(m(l),this[0]):u.call(this,l.jquery?l[0]:l):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(l,p){return this.pushStack(m.uniqueSort(m.merge(this.get(),m(l,p))))},addBack:function(l){return this.add(l==null?this.prevObject:this.prevObject.filter(l))}});function Ne(l,p){for(;(l=l[p])&&l.nodeType!==1;);return l}m.each({parent:function(l){var p=l.parentNode;return p&&p.nodeType!==11?p:null},parents:function(l){return z(l,"parentNode")},parentsUntil:function(l,p,_){return z(l,"parentNode",_)},next:function(l){return Ne(l,"nextSibling")},prev:function(l){return Ne(l,"previousSibling")},nextAll:function(l){return z(l,"nextSibling")},prevAll:function(l){return z(l,"previousSibling")},nextUntil:function(l,p,_){return z(l,"nextSibling",_)},prevUntil:function(l,p,_){return z(l,"previousSibling",_)},siblings:function(l){return W((l.parentNode||{}).firstChild,l)},children:function(l){return W(l.firstChild)},contents:function(l){return l.contentDocument!=null&&i(l.contentDocument)?l.contentDocument:(se(l,"template")&&(l=l.content||l),m.merge([],l.childNodes))}},function(l,p){m.fn[l]=function(_,M){var E=m.map(this,p,_);return l.slice(-5)!=="Until"&&(M=_),M&&typeof M=="string"&&(E=m.filter(M,E)),this.length>1&&(we[l]||m.uniqueSort(E),de.test(l)&&E.reverse()),this.pushStack(E)}});var Se=/[^\x20\t\r\n\f]+/g;function Ve(l){var p={};return m.each(l.match(Se)||[],function(_,M){p[M]=!0}),p}m.Callbacks=function(l){l=typeof l=="string"?Ve(l):m.extend({},l);var p,_,M,E,A=[],R=[],H=-1,G=function(){for(E=E||l.once,M=p=!0;R.length;H=-1)for(_=R.shift();++H<A.length;)A[H].apply(_[0],_[1])===!1&&l.stopOnFalse&&(H=A.length,_=!1);l.memory||(_=!1),p=!1,E&&(_?A=[]:A="")},ee={add:function(){return A&&(_&&!p&&(H=A.length-1,R.push(_)),function he(Le){m.each(Le,function(ae,xe){v(xe)?(!l.unique||!ee.has(xe))&&A.push(xe):xe&&xe.length&&L(xe)!=="string"&&he(xe)})}(arguments),_&&!p&&G()),this},remove:function(){return m.each(arguments,function(he,Le){for(var ae;(ae=m.inArray(Le,A,ae))>-1;)A.splice(ae,1),ae<=H&&H--}),this},has:function(he){return he?m.inArray(he,A)>-1:A.length>0},empty:function(){return A&&(A=[]),this},disable:function(){return E=R=[],A=_="",this},disabled:function(){return!A},lock:function(){return E=R=[],!_&&!p&&(A=_=""),this},locked:function(){return!!E},fireWith:function(he,Le){return E||(Le=Le||[],Le=[he,Le.slice?Le.slice():Le],R.push(Le),p||G()),this},fire:function(){return ee.fireWith(this,arguments),this},fired:function(){return!!M}};return ee};function ue(l){return l}function Ee(l){throw l}function Oe(l,p,_,M){var E;try{l&&v(E=l.promise)?E.call(l).done(p).fail(_):l&&v(E=l.then)?E.call(l,p,_):p.apply(void 0,[l].slice(M))}catch(A){_.apply(void 0,[A])}}m.extend({Deferred:function(l){var p=[["notify","progress",m.Callbacks("memory"),m.Callbacks("memory"),2],["resolve","done",m.Callbacks("once memory"),m.Callbacks("once memory"),0,"resolved"],["reject","fail",m.Callbacks("once memory"),m.Callbacks("once memory"),1,"rejected"]],_="pending",M={state:function(){return _},always:function(){return E.done(arguments).fail(arguments),this},catch:function(A){return M.then(null,A)},pipe:function(){var A=arguments;return m.Deferred(function(R){m.each(p,function(H,G){var ee=v(A[G[4]])&&A[G[4]];E[G[1]](function(){var he=ee&&ee.apply(this,arguments);he&&v(he.promise)?he.promise().progress(R.notify).done(R.resolve).fail(R.reject):R[G[0]+"With"](this,ee?[he]:arguments)})}),A=null}).promise()},then:function(A,R,H){var G=0;function ee(he,Le,ae,xe){return function(){var Ze=this,ht=arguments,$e=function(){var Xt,In;if(!(he<G)){if(Xt=ae.apply(Ze,ht),Xt===Le.promise())throw new TypeError("Thenable self-resolution");In=Xt&&(typeof Xt=="object"||typeof Xt=="function")&&Xt.then,v(In)?xe?In.call(Xt,ee(G,Le,ue,xe),ee(G,Le,Ee,xe)):(G++,In.call(Xt,ee(G,Le,ue,xe),ee(G,Le,Ee,xe),ee(G,Le,ue,Le.notifyWith))):(ae!==ue&&(Ze=void 0,ht=[Xt]),(xe||Le.resolveWith)(Ze,ht))}},Zt=xe?$e:function(){try{$e()}catch(Xt){m.Deferred.exceptionHook&&m.Deferred.exceptionHook(Xt,Zt.stackTrace),he+1>=G&&(ae!==Ee&&(Ze=void 0,ht=[Xt]),Le.rejectWith(Ze,ht))}};he?Zt():(m.Deferred.getStackHook&&(Zt.stackTrace=m.Deferred.getStackHook()),e.setTimeout(Zt))}}return m.Deferred(function(he){p[0][3].add(ee(0,he,v(H)?H:ue,he.notifyWith)),p[1][3].add(ee(0,he,v(A)?A:ue)),p[2][3].add(ee(0,he,v(R)?R:Ee))}).promise()},promise:function(A){return A!=null?m.extend(A,M):M}},E={};return m.each(p,function(A,R){var H=R[2],G=R[5];M[R[1]]=H.add,G&&H.add(function(){_=G},p[3-A][2].disable,p[3-A][3].disable,p[0][2].lock,p[0][3].lock),H.add(R[3].fire),E[R[0]]=function(){return E[R[0]+"With"](this===E?void 0:this,arguments),this},E[R[0]+"With"]=H.fireWith}),M.promise(E),l&&l.call(E,E),E},when:function(l){var p=arguments.length,_=p,M=Array(_),E=s.call(arguments),A=m.Deferred(),R=function(H){return function(G){M[H]=this,E[H]=arguments.length>1?s.call(arguments):G,--p||A.resolveWith(M,E)}};if(p<=1&&(Oe(l,A.done(R(_)).resolve,A.reject,!p),A.state()==="pending"||v(E[_]&&E[_].then)))return A.then();for(;_--;)Oe(E[_],R(_),A.reject);return A.promise()}});var re=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;m.Deferred.exceptionHook=function(l,p){e.console&&e.console.warn&&l&&re.test(l.name)&&e.console.warn("jQuery.Deferred exception: "+l.message,l.stack,p)},m.readyException=function(l){e.setTimeout(function(){throw l})};var ze=m.Deferred();m.fn.ready=function(l){return ze.then(l).catch(function(p){m.readyException(p)}),this},m.extend({isReady:!1,readyWait:1,ready:function(l){(l===!0?--m.readyWait:m.isReady)||(m.isReady=!0,!(l!==!0&&--m.readyWait>0)&&ze.resolveWith(y,[m]))}}),m.ready.then=ze.then;function je(){y.removeEventListener("DOMContentLoaded",je),e.removeEventListener("load",je),m.ready()}y.readyState==="complete"||y.readyState!=="loading"&&!y.documentElement.doScroll?e.setTimeout(m.ready):(y.addEventListener("DOMContentLoaded",je),e.addEventListener("load",je));var Ie=function(l,p,_,M,E,A,R){var H=0,G=l.length,ee=_==null;if(L(_)==="object"){E=!0;for(H in _)Ie(l,p,H,_[H],!0,A,R)}else if(M!==void 0&&(E=!0,v(M)||(R=!0),ee&&(R?(p.call(l,M),p=null):(ee=p,p=function(he,Le,ae){return ee.call(m(he),ae)})),p))for(;H<G;H++)p(l[H],_,R?M:M.call(l[H],H,p(l[H],_)));return E?l:ee?p.call(l):G?p(l[0],_):A},Be=/^-ms-/,Xe=/-([a-z])/g;function fe(l,p){return p.toUpperCase()}function ge(l){return l.replace(Be,"ms-").replace(Xe,fe)}var Ae=function(l){return l.nodeType===1||l.nodeType===9||!+l.nodeType};function ke(){this.expando=m.expando+ke.uid++}ke.uid=1,ke.prototype={cache:function(l){var p=l[this.expando];return p||(p={},Ae(l)&&(l.nodeType?l[this.expando]=p:Object.defineProperty(l,this.expando,{value:p,configurable:!0}))),p},set:function(l,p,_){var M,E=this.cache(l);if(typeof p=="string")E[ge(p)]=_;else for(M in p)E[ge(M)]=p[M];return E},get:function(l,p){return p===void 0?this.cache(l):l[this.expando]&&l[this.expando][ge(p)]},access:function(l,p,_){return p===void 0||p&&typeof p=="string"&&_===void 0?this.get(l,p):(this.set(l,p,_),_!==void 0?_:p)},remove:function(l,p){var _,M=l[this.expando];if(M!==void 0){if(p!==void 0)for(Array.isArray(p)?p=p.map(ge):(p=ge(p),p=p in M?[p]:p.match(Se)||[]),_=p.length;_--;)delete M[p[_]];(p===void 0||m.isEmptyObject(M))&&(l.nodeType?l[this.expando]=void 0:delete l[this.expando])}},hasData:function(l){var p=l[this.expando];return p!==void 0&&!m.isEmptyObject(p)}};var pe=new ke,O=new ke,F=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ye=/[A-Z]/g;function D(l){return l==="true"?!0:l==="false"?!1:l==="null"?null:l===+l+""?+l:F.test(l)?JSON.parse(l):l}function X(l,p,_){var M;if(_===void 0&&l.nodeType===1)if(M="data-"+p.replace(ye,"-$&").toLowerCase(),_=l.getAttribute(M),typeof _=="string"){try{_=D(_)}catch{}O.set(l,p,_)}else _=void 0;return _}m.extend({hasData:function(l){return O.hasData(l)||pe.hasData(l)},data:function(l,p,_){return O.access(l,p,_)},removeData:function(l,p){O.remove(l,p)},_data:function(l,p,_){return pe.access(l,p,_)},_removeData:function(l,p){pe.remove(l,p)}}),m.fn.extend({data:function(l,p){var _,M,E,A=this[0],R=A&&A.attributes;if(l===void 0){if(this.length&&(E=O.get(A),A.nodeType===1&&!pe.get(A,"hasDataAttrs"))){for(_=R.length;_--;)R[_]&&(M=R[_].name,M.indexOf("data-")===0&&(M=ge(M.slice(5)),X(A,M,E[M])));pe.set(A,"hasDataAttrs",!0)}return E}return typeof l=="object"?this.each(function(){O.set(this,l)}):Ie(this,function(H){var G;if(A&&H===void 0)return G=O.get(A,l),G!==void 0||(G=X(A,l),G!==void 0)?G:void 0;this.each(function(){O.set(this,l,H)})},null,p,arguments.length>1,null,!0)},removeData:function(l){return this.each(function(){O.remove(this,l)})}}),m.extend({queue:function(l,p,_){var M;if(l)return p=(p||"fx")+"queue",M=pe.get(l,p),_&&(!M||Array.isArray(_)?M=pe.access(l,p,m.makeArray(_)):M.push(_)),M||[]},dequeue:function(l,p){p=p||"fx";var _=m.queue(l,p),M=_.length,E=_.shift(),A=m._queueHooks(l,p),R=function(){m.dequeue(l,p)};E==="inprogress"&&(E=_.shift(),M--),E&&(p==="fx"&&_.unshift("inprogress"),delete A.stop,E.call(l,R,A)),!M&&A&&A.empty.fire()},_queueHooks:function(l,p){var _=p+"queueHooks";return pe.get(l,_)||pe.access(l,_,{empty:m.Callbacks("once memory").add(function(){pe.remove(l,[p+"queue",_])})})}}),m.fn.extend({queue:function(l,p){var _=2;return typeof l!="string"&&(p=l,l="fx",_--),arguments.length<_?m.queue(this[0],l):p===void 0?this:this.each(function(){var M=m.queue(this,l,p);m._queueHooks(this,l),l==="fx"&&M[0]!=="inprogress"&&m.dequeue(this,l)})},dequeue:function(l){return this.each(function(){m.dequeue(this,l)})},clearQueue:function(l){return this.queue(l||"fx",[])},promise:function(l,p){var _,M=1,E=m.Deferred(),A=this,R=this.length,H=function(){--M||E.resolveWith(A,[A])};for(typeof l!="string"&&(p=l,l=void 0),l=l||"fx";R--;)_=pe.get(A[R],l+"queueHooks"),_&&_.empty&&(M++,_.empty.add(H));return H(),E.promise(p)}});var J=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Y=new RegExp("^(?:([+-])=|)("+J+")([a-z%]*)$","i"),ve=["Top","Right","Bottom","Left"],Te=y.documentElement,Me=function(l){return m.contains(l.ownerDocument,l)},U={composed:!0};Te.getRootNode&&(Me=function(l){return m.contains(l.ownerDocument,l)||l.getRootNode(U)===l.ownerDocument});var ce=function(l,p){return l=p||l,l.style.display==="none"||l.style.display===""&&Me(l)&&m.css(l,"display")==="none"};function oe(l,p,_,M){var E,A,R=20,H=M?function(){return M.cur()}:function(){return m.css(l,p,"")},G=H(),ee=_&&_[3]||(m.cssNumber[p]?"":"px"),he=l.nodeType&&(m.cssNumber[p]||ee!=="px"&&+G)&&Y.exec(m.css(l,p));if(he&&he[3]!==ee){for(G=G/2,ee=ee||he[3],he=+G||1;R--;)m.style(l,p,he+ee),(1-A)*(1-(A=H()/G||.5))<=0&&(R=0),he=he/A;he=he*2,m.style(l,p,he+ee),_=_||[]}return _&&(he=+he||+G||0,E=_[1]?he+(_[1]+1)*_[2]:+_[2],M&&(M.unit=ee,M.start=he,M.end=E)),E}var Ue={};function q(l){var p,_=l.ownerDocument,M=l.nodeName,E=Ue[M];return E||(p=_.body.appendChild(_.createElement(M)),E=m.css(p,"display"),p.parentNode.removeChild(p),E==="none"&&(E="block"),Ue[M]=E,E)}function Pe(l,p){for(var _,M,E=[],A=0,R=l.length;A<R;A++)M=l[A],M.style&&(_=M.style.display,p?(_==="none"&&(E[A]=pe.get(M,"display")||null,E[A]||(M.style.display="")),M.style.display===""&&ce(M)&&(E[A]=q(M))):_!=="none"&&(E[A]="none",pe.set(M,"display",_)));for(A=0;A<R;A++)E[A]!=null&&(l[A].style.display=E[A]);return l}m.fn.extend({show:function(){return Pe(this,!0)},hide:function(){return Pe(this)},toggle:function(l){return typeof l=="boolean"?l?this.show():this.hide():this.each(function(){ce(this)?m(this).show():m(this).hide()})}});var ct=/^(?:checkbox|radio)$/i,pt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Nt=/^$|^module$|\/(?:java|ecma)script/i;(function(){var l=y.createDocumentFragment(),p=l.appendChild(y.createElement("div")),_=y.createElement("input");_.setAttribute("type","radio"),_.setAttribute("checked","checked"),_.setAttribute("name","t"),p.appendChild(_),x.checkClone=p.cloneNode(!0).cloneNode(!0).lastChild.checked,p.innerHTML="<textarea>x</textarea>",x.noCloneChecked=!!p.cloneNode(!0).lastChild.defaultValue,p.innerHTML="<option></option>",x.option=!!p.lastChild})();var ft={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ft.tbody=ft.tfoot=ft.colgroup=ft.caption=ft.thead,ft.th=ft.td,x.option||(ft.optgroup=ft.option=[1,"<select multiple='multiple'>","</select>"]);function _t(l,p){var _;return typeof l.getElementsByTagName!="undefined"?_=l.getElementsByTagName(p||"*"):typeof l.querySelectorAll!="undefined"?_=l.querySelectorAll(p||"*"):_=[],p===void 0||p&&se(l,p)?m.merge([l],_):_}function en(l,p){for(var _=0,M=l.length;_<M;_++)pe.set(l[_],"globalEval",!p||pe.get(p[_],"globalEval"))}var rn=/<|&#?\w+;/;function hn(l,p,_,M,E){for(var A,R,H,G,ee,he,Le=p.createDocumentFragment(),ae=[],xe=0,Ze=l.length;xe<Ze;xe++)if(A=l[xe],A||A===0)if(L(A)==="object")m.merge(ae,A.nodeType?[A]:A);else if(!rn.test(A))ae.push(p.createTextNode(A));else{for(R=R||Le.appendChild(p.createElement("div")),H=(pt.exec(A)||["",""])[1].toLowerCase(),G=ft[H]||ft._default,R.innerHTML=G[1]+m.htmlPrefilter(A)+G[2],he=G[0];he--;)R=R.lastChild;m.merge(ae,R.childNodes),R=Le.firstChild,R.textContent=""}for(Le.textContent="",xe=0;A=ae[xe++];){if(M&&m.inArray(A,M)>-1){E&&E.push(A);continue}if(ee=Me(A),R=_t(Le.appendChild(A),"script"),ee&&en(R),_)for(he=0;A=R[he++];)Nt.test(A.type||"")&&_.push(A)}return Le}var tr=/^([^.]*)(?:\.(.+)|)/;function $n(){return!0}function fn(){return!1}function Wn(l,p){return l===wr()==(p==="focus")}function wr(){try{return y.activeElement}catch{}}function nr(l,p,_,M,E,A){var R,H;if(typeof p=="object"){typeof _!="string"&&(M=M||_,_=void 0);for(H in p)nr(l,H,_,M,p[H],A);return l}if(M==null&&E==null?(E=_,M=_=void 0):E==null&&(typeof _=="string"?(E=M,M=void 0):(E=M,M=_,_=void 0)),E===!1)E=fn;else if(!E)return l;return A===1&&(R=E,E=function(G){return m().off(G),R.apply(this,arguments)},E.guid=R.guid||(R.guid=m.guid++)),l.each(function(){m.event.add(this,p,E,M,_)})}m.event={global:{},add:function(l,p,_,M,E){var A,R,H,G,ee,he,Le,ae,xe,Ze,ht,$e=pe.get(l);if(!!Ae(l))for(_.handler&&(A=_,_=A.handler,E=A.selector),E&&m.find.matchesSelector(Te,E),_.guid||(_.guid=m.guid++),(G=$e.events)||(G=$e.events=Object.create(null)),(R=$e.handle)||(R=$e.handle=function(Zt){return typeof m!="undefined"&&m.event.triggered!==Zt.type?m.event.dispatch.apply(l,arguments):void 0}),p=(p||"").match(Se)||[""],ee=p.length;ee--;)H=tr.exec(p[ee])||[],xe=ht=H[1],Ze=(H[2]||"").split(".").sort(),xe&&(Le=m.event.special[xe]||{},xe=(E?Le.delegateType:Le.bindType)||xe,Le=m.event.special[xe]||{},he=m.extend({type:xe,origType:ht,data:M,handler:_,guid:_.guid,selector:E,needsContext:E&&m.expr.match.needsContext.test(E),namespace:Ze.join(".")},A),(ae=G[xe])||(ae=G[xe]=[],ae.delegateCount=0,(!Le.setup||Le.setup.call(l,M,Ze,R)===!1)&&l.addEventListener&&l.addEventListener(xe,R)),Le.add&&(Le.add.call(l,he),he.handler.guid||(he.handler.guid=_.guid)),E?ae.splice(ae.delegateCount++,0,he):ae.push(he),m.event.global[xe]=!0)},remove:function(l,p,_,M,E){var A,R,H,G,ee,he,Le,ae,xe,Ze,ht,$e=pe.hasData(l)&&pe.get(l);if(!(!$e||!(G=$e.events))){for(p=(p||"").match(Se)||[""],ee=p.length;ee--;){if(H=tr.exec(p[ee])||[],xe=ht=H[1],Ze=(H[2]||"").split(".").sort(),!xe){for(xe in G)m.event.remove(l,xe+p[ee],_,M,!0);continue}for(Le=m.event.special[xe]||{},xe=(M?Le.delegateType:Le.bindType)||xe,ae=G[xe]||[],H=H[2]&&new RegExp("(^|\\.)"+Ze.join("\\.(?:.*\\.|)")+"(\\.|$)"),R=A=ae.length;A--;)he=ae[A],(E||ht===he.origType)&&(!_||_.guid===he.guid)&&(!H||H.test(he.namespace))&&(!M||M===he.selector||M==="**"&&he.selector)&&(ae.splice(A,1),he.selector&&ae.delegateCount--,Le.remove&&Le.remove.call(l,he));R&&!ae.length&&((!Le.teardown||Le.teardown.call(l,Ze,$e.handle)===!1)&&m.removeEvent(l,xe,$e.handle),delete G[xe])}m.isEmptyObject(G)&&pe.remove(l,"handle events")}},dispatch:function(l){var p,_,M,E,A,R,H=new Array(arguments.length),G=m.event.fix(l),ee=(pe.get(this,"events")||Object.create(null))[G.type]||[],he=m.event.special[G.type]||{};for(H[0]=G,p=1;p<arguments.length;p++)H[p]=arguments[p];if(G.delegateTarget=this,!(he.preDispatch&&he.preDispatch.call(this,G)===!1)){for(R=m.event.handlers.call(this,G,ee),p=0;(E=R[p++])&&!G.isPropagationStopped();)for(G.currentTarget=E.elem,_=0;(A=E.handlers[_++])&&!G.isImmediatePropagationStopped();)(!G.rnamespace||A.namespace===!1||G.rnamespace.test(A.namespace))&&(G.handleObj=A,G.data=A.data,M=((m.event.special[A.origType]||{}).handle||A.handler).apply(E.elem,H),M!==void 0&&(G.result=M)===!1&&(G.preventDefault(),G.stopPropagation()));return he.postDispatch&&he.postDispatch.call(this,G),G.result}},handlers:function(l,p){var _,M,E,A,R,H=[],G=p.delegateCount,ee=l.target;if(G&&ee.nodeType&&!(l.type==="click"&&l.button>=1)){for(;ee!==this;ee=ee.parentNode||this)if(ee.nodeType===1&&!(l.type==="click"&&ee.disabled===!0)){for(A=[],R={},_=0;_<G;_++)M=p[_],E=M.selector+" ",R[E]===void 0&&(R[E]=M.needsContext?m(E,this).index(ee)>-1:m.find(E,this,null,[ee]).length),R[E]&&A.push(M);A.length&&H.push({elem:ee,handlers:A})}}return ee=this,G<p.length&&H.push({elem:ee,handlers:p.slice(G)}),H},addProp:function(l,p){Object.defineProperty(m.Event.prototype,l,{enumerable:!0,configurable:!0,get:v(p)?function(){if(this.originalEvent)return p(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[l]},set:function(_){Object.defineProperty(this,l,{enumerable:!0,configurable:!0,writable:!0,value:_})}})},fix:function(l){return l[m.expando]?l:new m.Event(l)},special:{load:{noBubble:!0},click:{setup:function(l){var p=this||l;return ct.test(p.type)&&p.click&&se(p,"input")&&Jn(p,"click",$n),!1},trigger:function(l){var p=this||l;return ct.test(p.type)&&p.click&&se(p,"input")&&Jn(p,"click"),!0},_default:function(l){var p=l.target;return ct.test(p.type)&&p.click&&se(p,"input")&&pe.get(p,"click")||se(p,"a")}},beforeunload:{postDispatch:function(l){l.result!==void 0&&l.originalEvent&&(l.originalEvent.returnValue=l.result)}}}};function Jn(l,p,_){if(!_){pe.get(l,p)===void 0&&m.event.add(l,p,$n);return}pe.set(l,p,!1),m.event.add(l,p,{namespace:!1,handler:function(M){var E,A,R=pe.get(this,p);if(M.isTrigger&1&&this[p]){if(R.length)(m.event.special[p]||{}).delegateType&&M.stopPropagation();else if(R=s.call(arguments),pe.set(this,p,R),E=_(this,p),this[p](),A=pe.get(this,p),R!==A||E?pe.set(this,p,!1):A={},R!==A)return M.stopImmediatePropagation(),M.preventDefault(),A&&A.value}else R.length&&(pe.set(this,p,{value:m.event.trigger(m.extend(R[0],m.Event.prototype),R.slice(1),this)}),M.stopImmediatePropagation())}})}m.removeEvent=function(l,p,_){l.removeEventListener&&l.removeEventListener(p,_)},m.Event=function(l,p){if(!(this instanceof m.Event))return new m.Event(l,p);l&&l.type?(this.originalEvent=l,this.type=l.type,this.isDefaultPrevented=l.defaultPrevented||l.defaultPrevented===void 0&&l.returnValue===!1?$n:fn,this.target=l.target&&l.target.nodeType===3?l.target.parentNode:l.target,this.currentTarget=l.currentTarget,this.relatedTarget=l.relatedTarget):this.type=l,p&&m.extend(this,p),this.timeStamp=l&&l.timeStamp||Date.now(),this[m.expando]=!0},m.Event.prototype={constructor:m.Event,isDefaultPrevented:fn,isPropagationStopped:fn,isImmediatePropagationStopped:fn,isSimulated:!1,preventDefault:function(){var l=this.originalEvent;this.isDefaultPrevented=$n,l&&!this.isSimulated&&l.preventDefault()},stopPropagation:function(){var l=this.originalEvent;this.isPropagationStopped=$n,l&&!this.isSimulated&&l.stopPropagation()},stopImmediatePropagation:function(){var l=this.originalEvent;this.isImmediatePropagationStopped=$n,l&&!this.isSimulated&&l.stopImmediatePropagation(),this.stopPropagation()}},m.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},m.event.addProp),m.each({focus:"focusin",blur:"focusout"},function(l,p){m.event.special[l]={setup:function(){return Jn(this,l,Wn),!1},trigger:function(){return Jn(this,l),!0},_default:function(){return!0},delegateType:p}}),m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(l,p){m.event.special[l]={delegateType:p,bindType:p,handle:function(_){var M,E=this,A=_.relatedTarget,R=_.handleObj;return(!A||A!==E&&!m.contains(E,A))&&(_.type=R.origType,M=R.handler.apply(this,arguments),_.type=p),M}}}),m.fn.extend({on:function(l,p,_,M){return nr(this,l,p,_,M)},one:function(l,p,_,M){return nr(this,l,p,_,M,1)},off:function(l,p,_){var M,E;if(l&&l.preventDefault&&l.handleObj)return M=l.handleObj,m(l.delegateTarget).off(M.namespace?M.origType+"."+M.namespace:M.origType,M.selector,M.handler),this;if(typeof l=="object"){for(E in l)this.off(E,p,l[E]);return this}return(p===!1||typeof p=="function")&&(_=p,p=void 0),_===!1&&(_=fn),this.each(function(){m.event.remove(this,l,_,p)})}});var _s=/<script|<style|<link/i,ir=/checked\s*(?:[^=]|=\s*.checked.)/i,br=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function rr(l,p){return se(l,"table")&&se(p.nodeType!==11?p:p.firstChild,"tr")&&m(l).children("tbody")[0]||l}function ws(l){return l.type=(l.getAttribute("type")!==null)+"/"+l.type,l}function bs(l){return(l.type||"").slice(0,5)==="true/"?l.type=l.type.slice(5):l.removeAttribute("type"),l}function I(l,p){var _,M,E,A,R,H,G;if(p.nodeType===1){if(pe.hasData(l)&&(A=pe.get(l),G=A.events,G)){pe.remove(p,"handle events");for(E in G)for(_=0,M=G[E].length;_<M;_++)m.event.add(p,E,G[E][_])}O.hasData(l)&&(R=O.access(l),H=m.extend({},R),O.set(p,H))}}function le(l,p){var _=p.nodeName.toLowerCase();_==="input"&&ct.test(l.type)?p.checked=l.checked:(_==="input"||_==="textarea")&&(p.defaultValue=l.defaultValue)}function ne(l,p,_,M){p=a(p);var E,A,R,H,G,ee,he=0,Le=l.length,ae=Le-1,xe=p[0],Ze=v(xe);if(Ze||Le>1&&typeof xe=="string"&&!x.checkClone&&ir.test(xe))return l.each(function(ht){var $e=l.eq(ht);Ze&&(p[0]=xe.call(this,ht,$e.html())),ne($e,p,_,M)});if(Le&&(E=hn(p,l[0].ownerDocument,!1,l,M),A=E.firstChild,E.childNodes.length===1&&(E=A),A||M)){for(R=m.map(_t(E,"script"),ws),H=R.length;he<Le;he++)G=E,he!==ae&&(G=m.clone(G,!0,!0),H&&m.merge(R,_t(G,"script"))),_.call(l[he],G,he);if(H)for(ee=R[R.length-1].ownerDocument,m.map(R,bs),he=0;he<H;he++)G=R[he],Nt.test(G.type||"")&&!pe.access(G,"globalEval")&&m.contains(ee,G)&&(G.src&&(G.type||"").toLowerCase()!=="module"?m._evalUrl&&!G.noModule&&m._evalUrl(G.src,{nonce:G.nonce||G.getAttribute("nonce")},ee):S(G.textContent.replace(br,""),G,ee))}return l}function me(l,p,_){for(var M,E=p?m.filter(p,l):l,A=0;(M=E[A])!=null;A++)!_&&M.nodeType===1&&m.cleanData(_t(M)),M.parentNode&&(_&&Me(M)&&en(_t(M,"script")),M.parentNode.removeChild(M));return l}m.extend({htmlPrefilter:function(l){return l},clone:function(l,p,_){var M,E,A,R,H=l.cloneNode(!0),G=Me(l);if(!x.noCloneChecked&&(l.nodeType===1||l.nodeType===11)&&!m.isXMLDoc(l))for(R=_t(H),A=_t(l),M=0,E=A.length;M<E;M++)le(A[M],R[M]);if(p)if(_)for(A=A||_t(l),R=R||_t(H),M=0,E=A.length;M<E;M++)I(A[M],R[M]);else I(l,H);return R=_t(H,"script"),R.length>0&&en(R,!G&&_t(l,"script")),H},cleanData:function(l){for(var p,_,M,E=m.event.special,A=0;(_=l[A])!==void 0;A++)if(Ae(_)){if(p=_[pe.expando]){if(p.events)for(M in p.events)E[M]?m.event.remove(_,M):m.removeEvent(_,M,p.handle);_[pe.expando]=void 0}_[O.expando]&&(_[O.expando]=void 0)}}}),m.fn.extend({detach:function(l){return me(this,l,!0)},remove:function(l){return me(this,l)},text:function(l){return Ie(this,function(p){return p===void 0?m.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=p)})},null,l,arguments.length)},append:function(){return ne(this,arguments,function(l){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var p=rr(this,l);p.appendChild(l)}})},prepend:function(){return ne(this,arguments,function(l){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var p=rr(this,l);p.insertBefore(l,p.firstChild)}})},before:function(){return ne(this,arguments,function(l){this.parentNode&&this.parentNode.insertBefore(l,this)})},after:function(){return ne(this,arguments,function(l){this.parentNode&&this.parentNode.insertBefore(l,this.nextSibling)})},empty:function(){for(var l,p=0;(l=this[p])!=null;p++)l.nodeType===1&&(m.cleanData(_t(l,!1)),l.textContent="");return this},clone:function(l,p){return l=l==null?!1:l,p=p==null?l:p,this.map(function(){return m.clone(this,l,p)})},html:function(l){return Ie(this,function(p){var _=this[0]||{},M=0,E=this.length;if(p===void 0&&_.nodeType===1)return _.innerHTML;if(typeof p=="string"&&!_s.test(p)&&!ft[(pt.exec(p)||["",""])[1].toLowerCase()]){p=m.htmlPrefilter(p);try{for(;M<E;M++)_=this[M]||{},_.nodeType===1&&(m.cleanData(_t(_,!1)),_.innerHTML=p);_=0}catch{}}_&&this.empty().append(p)},null,l,arguments.length)},replaceWith:function(){var l=[];return ne(this,arguments,function(p){var _=this.parentNode;m.inArray(this,l)<0&&(m.cleanData(_t(this)),_&&_.replaceChild(p,this))},l)}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(l,p){m.fn[l]=function(_){for(var M,E=[],A=m(_),R=A.length-1,H=0;H<=R;H++)M=H===R?this:this.clone(!0),m(A[H])[p](M),o.apply(E,M.get());return this.pushStack(E)}});var De=new RegExp("^("+J+")(?!px)[a-z%]+$","i"),ot=function(l){var p=l.ownerDocument.defaultView;return(!p||!p.opener)&&(p=e),p.getComputedStyle(l)},Je=function(l,p,_){var M,E,A={};for(E in p)A[E]=l.style[E],l.style[E]=p[E];M=_.call(l);for(E in p)l.style[E]=A[E];return M},Ge=new RegExp(ve.join("|"),"i");(function(){function l(){if(!!ee){G.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",ee.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Te.appendChild(G).appendChild(ee);var he=e.getComputedStyle(ee);_=he.top!=="1%",H=p(he.marginLeft)===12,ee.style.right="60%",A=p(he.right)===36,M=p(he.width)===36,ee.style.position="absolute",E=p(ee.offsetWidth/3)===12,Te.removeChild(G),ee=null}}function p(he){return Math.round(parseFloat(he))}var _,M,E,A,R,H,G=y.createElement("div"),ee=y.createElement("div");!ee.style||(ee.style.backgroundClip="content-box",ee.cloneNode(!0).style.backgroundClip="",x.clearCloneStyle=ee.style.backgroundClip==="content-box",m.extend(x,{boxSizingReliable:function(){return l(),M},pixelBoxStyles:function(){return l(),A},pixelPosition:function(){return l(),_},reliableMarginLeft:function(){return l(),H},scrollboxSize:function(){return l(),E},reliableTrDimensions:function(){var he,Le,ae,xe;return R==null&&(he=y.createElement("table"),Le=y.createElement("tr"),ae=y.createElement("div"),he.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Le.style.cssText="border:1px solid",Le.style.height="1px",ae.style.height="9px",ae.style.display="block",Te.appendChild(he).appendChild(Le).appendChild(ae),xe=e.getComputedStyle(Le),R=parseInt(xe.height,10)+parseInt(xe.borderTopWidth,10)+parseInt(xe.borderBottomWidth,10)===Le.offsetHeight,Te.removeChild(he)),R}}))})();function Ye(l,p,_){var M,E,A,R,H=l.style;return _=_||ot(l),_&&(R=_.getPropertyValue(p)||_[p],R===""&&!Me(l)&&(R=m.style(l,p)),!x.pixelBoxStyles()&&De.test(R)&&Ge.test(p)&&(M=H.width,E=H.minWidth,A=H.maxWidth,H.minWidth=H.maxWidth=H.width=R,R=_.width,H.width=M,H.minWidth=E,H.maxWidth=A)),R!==void 0?R+"":R}function dt(l,p){return{get:function(){if(l()){delete this.get;return}return(this.get=p).apply(this,arguments)}}}var mt=["Webkit","Moz","ms"],yt=y.createElement("div").style,at={};function xi(l){for(var p=l[0].toUpperCase()+l.slice(1),_=mt.length;_--;)if(l=mt[_]+p,l in yt)return l}function Dt(l){var p=m.cssProps[l]||at[l];return p||(l in yt?l:at[l]=xi(l)||l)}var ui=/^(none|table(?!-c[ea]).+)/,Mn=/^--/,_i={position:"absolute",visibility:"hidden",display:"block"},Qn={letterSpacing:"0",fontWeight:"400"};function Gt(l,p,_){var M=Y.exec(p);return M?Math.max(0,M[2]-(_||0))+(M[3]||"px"):p}function Sn(l,p,_,M,E,A){var R=p==="width"?1:0,H=0,G=0;if(_===(M?"border":"content"))return 0;for(;R<4;R+=2)_==="margin"&&(G+=m.css(l,_+ve[R],!0,E)),M?(_==="content"&&(G-=m.css(l,"padding"+ve[R],!0,E)),_!=="margin"&&(G-=m.css(l,"border"+ve[R]+"Width",!0,E))):(G+=m.css(l,"padding"+ve[R],!0,E),_!=="padding"?G+=m.css(l,"border"+ve[R]+"Width",!0,E):H+=m.css(l,"border"+ve[R]+"Width",!0,E));return!M&&A>=0&&(G+=Math.max(0,Math.ceil(l["offset"+p[0].toUpperCase()+p.slice(1)]-A-G-H-.5))||0),G}function jt(l,p,_){var M=ot(l),E=!x.boxSizingReliable()||_,A=E&&m.css(l,"boxSizing",!1,M)==="border-box",R=A,H=Ye(l,p,M),G="offset"+p[0].toUpperCase()+p.slice(1);if(De.test(H)){if(!_)return H;H="auto"}return(!x.boxSizingReliable()&&A||!x.reliableTrDimensions()&&se(l,"tr")||H==="auto"||!parseFloat(H)&&m.css(l,"display",!1,M)==="inline")&&l.getClientRects().length&&(A=m.css(l,"boxSizing",!1,M)==="border-box",R=G in l,R&&(H=l[G])),H=parseFloat(H)||0,H+Sn(l,p,_||(A?"border":"content"),R,M,H)+"px"}m.extend({cssHooks:{opacity:{get:function(l,p){if(p){var _=Ye(l,"opacity");return _===""?"1":_}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(l,p,_,M){if(!(!l||l.nodeType===3||l.nodeType===8||!l.style)){var E,A,R,H=ge(p),G=Mn.test(p),ee=l.style;if(G||(p=Dt(H)),R=m.cssHooks[p]||m.cssHooks[H],_!==void 0){if(A=typeof _,A==="string"&&(E=Y.exec(_))&&E[1]&&(_=oe(l,p,E),A="number"),_==null||_!==_)return;A==="number"&&!G&&(_+=E&&E[3]||(m.cssNumber[H]?"":"px")),!x.clearCloneStyle&&_===""&&p.indexOf("background")===0&&(ee[p]="inherit"),(!R||!("set"in R)||(_=R.set(l,_,M))!==void 0)&&(G?ee.setProperty(p,_):ee[p]=_)}else return R&&"get"in R&&(E=R.get(l,!1,M))!==void 0?E:ee[p]}},css:function(l,p,_,M){var E,A,R,H=ge(p),G=Mn.test(p);return G||(p=Dt(H)),R=m.cssHooks[p]||m.cssHooks[H],R&&"get"in R&&(E=R.get(l,!0,_)),E===void 0&&(E=Ye(l,p,M)),E==="normal"&&p in Qn&&(E=Qn[p]),_===""||_?(A=parseFloat(E),_===!0||isFinite(A)?A||0:E):E}}),m.each(["height","width"],function(l,p){m.cssHooks[p]={get:function(_,M,E){if(M)return ui.test(m.css(_,"display"))&&(!_.getClientRects().length||!_.getBoundingClientRect().width)?Je(_,_i,function(){return jt(_,p,E)}):jt(_,p,E)},set:function(_,M,E){var A,R=ot(_),H=!x.scrollboxSize()&&R.position==="absolute",G=H||E,ee=G&&m.css(_,"boxSizing",!1,R)==="border-box",he=E?Sn(_,p,E,ee,R):0;return ee&&H&&(he-=Math.ceil(_["offset"+p[0].toUpperCase()+p.slice(1)]-parseFloat(R[p])-Sn(_,p,"border",!1,R)-.5)),he&&(A=Y.exec(M))&&(A[3]||"px")!=="px"&&(_.style[p]=M,M=m.css(_,p)),Gt(_,M,he)}}}),m.cssHooks.marginLeft=dt(x.reliableMarginLeft,function(l,p){if(p)return(parseFloat(Ye(l,"marginLeft"))||l.getBoundingClientRect().left-Je(l,{marginLeft:0},function(){return l.getBoundingClientRect().left}))+"px"}),m.each({margin:"",padding:"",border:"Width"},function(l,p){m.cssHooks[l+p]={expand:function(_){for(var M=0,E={},A=typeof _=="string"?_.split(" "):[_];M<4;M++)E[l+ve[M]+p]=A[M]||A[M-2]||A[0];return E}},l!=="margin"&&(m.cssHooks[l+p].set=Gt)}),m.fn.extend({css:function(l,p){return Ie(this,function(_,M,E){var A,R,H={},G=0;if(Array.isArray(M)){for(A=ot(_),R=M.length;G<R;G++)H[M[G]]=m.css(_,M[G],!1,A);return H}return E!==void 0?m.style(_,M,E):m.css(_,M)},l,p,arguments.length>1)}});function En(l,p,_,M,E){return new En.prototype.init(l,p,_,M,E)}m.Tween=En,En.prototype={constructor:En,init:function(l,p,_,M,E,A){this.elem=l,this.prop=_,this.easing=E||m.easing._default,this.options=p,this.start=this.now=this.cur(),this.end=M,this.unit=A||(m.cssNumber[_]?"":"px")},cur:function(){var l=En.propHooks[this.prop];return l&&l.get?l.get(this):En.propHooks._default.get(this)},run:function(l){var p,_=En.propHooks[this.prop];return this.options.duration?this.pos=p=m.easing[this.easing](l,this.options.duration*l,0,1,this.options.duration):this.pos=p=l,this.now=(this.end-this.start)*p+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),_&&_.set?_.set(this):En.propHooks._default.set(this),this}},En.prototype.init.prototype=En.prototype,En.propHooks={_default:{get:function(l){var p;return l.elem.nodeType!==1||l.elem[l.prop]!=null&&l.elem.style[l.prop]==null?l.elem[l.prop]:(p=m.css(l.elem,l.prop,""),!p||p==="auto"?0:p)},set:function(l){m.fx.step[l.prop]?m.fx.step[l.prop](l):l.elem.nodeType===1&&(m.cssHooks[l.prop]||l.elem.style[Dt(l.prop)]!=null)?m.style(l.elem,l.prop,l.now+l.unit):l.elem[l.prop]=l.now}}},En.propHooks.scrollTop=En.propHooks.scrollLeft={set:function(l){l.elem.nodeType&&l.elem.parentNode&&(l.elem[l.prop]=l.now)}},m.easing={linear:function(l){return l},swing:function(l){return .5-Math.cos(l*Math.PI)/2},_default:"swing"},m.fx=En.prototype.init,m.fx.step={};var Mr,oa,zd=/^(?:toggle|show|hide)$/,Ud=/queueHooks$/;function Fo(){oa&&(y.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Fo):e.setTimeout(Fo,m.fx.interval),m.fx.tick())}function kc(){return e.setTimeout(function(){Mr=void 0}),Mr=Date.now()}function la(l,p){var _,M=0,E={height:l};for(p=p?1:0;M<4;M+=2-p)_=ve[M],E["margin"+_]=E["padding"+_]=l;return p&&(E.opacity=E.width=l),E}function Hc(l,p,_){for(var M,E=(Kn.tweeners[p]||[]).concat(Kn.tweeners["*"]),A=0,R=E.length;A<R;A++)if(M=E[A].call(_,p,l))return M}function kd(l,p,_){var M,E,A,R,H,G,ee,he,Le="width"in p||"height"in p,ae=this,xe={},Ze=l.style,ht=l.nodeType&&ce(l),$e=pe.get(l,"fxshow");_.queue||(R=m._queueHooks(l,"fx"),R.unqueued==null&&(R.unqueued=0,H=R.empty.fire,R.empty.fire=function(){R.unqueued||H()}),R.unqueued++,ae.always(function(){ae.always(function(){R.unqueued--,m.queue(l,"fx").length||R.empty.fire()})}));for(M in p)if(E=p[M],zd.test(E)){if(delete p[M],A=A||E==="toggle",E===(ht?"hide":"show"))if(E==="show"&&$e&&$e[M]!==void 0)ht=!0;else continue;xe[M]=$e&&$e[M]||m.style(l,M)}if(G=!m.isEmptyObject(p),!(!G&&m.isEmptyObject(xe))){Le&&l.nodeType===1&&(_.overflow=[Ze.overflow,Ze.overflowX,Ze.overflowY],ee=$e&&$e.display,ee==null&&(ee=pe.get(l,"display")),he=m.css(l,"display"),he==="none"&&(ee?he=ee:(Pe([l],!0),ee=l.style.display||ee,he=m.css(l,"display"),Pe([l]))),(he==="inline"||he==="inline-block"&&ee!=null)&&m.css(l,"float")==="none"&&(G||(ae.done(function(){Ze.display=ee}),ee==null&&(he=Ze.display,ee=he==="none"?"":he)),Ze.display="inline-block")),_.overflow&&(Ze.overflow="hidden",ae.always(function(){Ze.overflow=_.overflow[0],Ze.overflowX=_.overflow[1],Ze.overflowY=_.overflow[2]})),G=!1;for(M in xe)G||($e?"hidden"in $e&&(ht=$e.hidden):$e=pe.access(l,"fxshow",{display:ee}),A&&($e.hidden=!ht),ht&&Pe([l],!0),ae.done(function(){ht||Pe([l]),pe.remove(l,"fxshow");for(M in xe)m.style(l,M,xe[M])})),G=Hc(ht?$e[M]:0,M,ae),M in $e||($e[M]=G.start,ht&&(G.end=G.start,G.start=0))}}function Hd(l,p){var _,M,E,A,R;for(_ in l)if(M=ge(_),E=p[M],A=l[_],Array.isArray(A)&&(E=A[1],A=l[_]=A[0]),_!==M&&(l[M]=A,delete l[_]),R=m.cssHooks[M],R&&"expand"in R){A=R.expand(A),delete l[M];for(_ in A)_ in l||(l[_]=A[_],p[_]=E)}else p[M]=E}function Kn(l,p,_){var M,E,A=0,R=Kn.prefilters.length,H=m.Deferred().always(function(){delete G.elem}),G=function(){if(E)return!1;for(var Le=Mr||kc(),ae=Math.max(0,ee.startTime+ee.duration-Le),xe=ae/ee.duration||0,Ze=1-xe,ht=0,$e=ee.tweens.length;ht<$e;ht++)ee.tweens[ht].run(Ze);return H.notifyWith(l,[ee,Ze,ae]),Ze<1&&$e?ae:($e||H.notifyWith(l,[ee,1,0]),H.resolveWith(l,[ee]),!1)},ee=H.promise({elem:l,props:m.extend({},p),opts:m.extend(!0,{specialEasing:{},easing:m.easing._default},_),originalProperties:p,originalOptions:_,startTime:Mr||kc(),duration:_.duration,tweens:[],createTween:function(Le,ae){var xe=m.Tween(l,ee.opts,Le,ae,ee.opts.specialEasing[Le]||ee.opts.easing);return ee.tweens.push(xe),xe},stop:function(Le){var ae=0,xe=Le?ee.tweens.length:0;if(E)return this;for(E=!0;ae<xe;ae++)ee.tweens[ae].run(1);return Le?(H.notifyWith(l,[ee,1,0]),H.resolveWith(l,[ee,Le])):H.rejectWith(l,[ee,Le]),this}}),he=ee.props;for(Hd(he,ee.opts.specialEasing);A<R;A++)if(M=Kn.prefilters[A].call(ee,l,he,ee.opts),M)return v(M.stop)&&(m._queueHooks(ee.elem,ee.opts.queue).stop=M.stop.bind(M)),M;return m.map(he,Hc,ee),v(ee.opts.start)&&ee.opts.start.call(l,ee),ee.progress(ee.opts.progress).done(ee.opts.done,ee.opts.complete).fail(ee.opts.fail).always(ee.opts.always),m.fx.timer(m.extend(G,{elem:l,anim:ee,queue:ee.opts.queue})),ee}m.Animation=m.extend(Kn,{tweeners:{"*":[function(l,p){var _=this.createTween(l,p);return oe(_.elem,l,Y.exec(p),_),_}]},tweener:function(l,p){v(l)?(p=l,l=["*"]):l=l.match(Se);for(var _,M=0,E=l.length;M<E;M++)_=l[M],Kn.tweeners[_]=Kn.tweeners[_]||[],Kn.tweeners[_].unshift(p)},prefilters:[kd],prefilter:function(l,p){p?Kn.prefilters.unshift(l):Kn.prefilters.push(l)}}),m.speed=function(l,p,_){var M=l&&typeof l=="object"?m.extend({},l):{complete:_||!_&&p||v(l)&&l,duration:l,easing:_&&p||p&&!v(p)&&p};return m.fx.off?M.duration=0:typeof M.duration!="number"&&(M.duration in m.fx.speeds?M.duration=m.fx.speeds[M.duration]:M.duration=m.fx.speeds._default),(M.queue==null||M.queue===!0)&&(M.queue="fx"),M.old=M.complete,M.complete=function(){v(M.old)&&M.old.call(this),M.queue&&m.dequeue(this,M.queue)},M},m.fn.extend({fadeTo:function(l,p,_,M){return this.filter(ce).css("opacity",0).show().end().animate({opacity:p},l,_,M)},animate:function(l,p,_,M){var E=m.isEmptyObject(l),A=m.speed(p,_,M),R=function(){var H=Kn(this,m.extend({},l),A);(E||pe.get(this,"finish"))&&H.stop(!0)};return R.finish=R,E||A.queue===!1?this.each(R):this.queue(A.queue,R)},stop:function(l,p,_){var M=function(E){var A=E.stop;delete E.stop,A(_)};return typeof l!="string"&&(_=p,p=l,l=void 0),p&&this.queue(l||"fx",[]),this.each(function(){var E=!0,A=l!=null&&l+"queueHooks",R=m.timers,H=pe.get(this);if(A)H[A]&&H[A].stop&&M(H[A]);else for(A in H)H[A]&&H[A].stop&&Ud.test(A)&&M(H[A]);for(A=R.length;A--;)R[A].elem===this&&(l==null||R[A].queue===l)&&(R[A].anim.stop(_),E=!1,R.splice(A,1));(E||!_)&&m.dequeue(this,l)})},finish:function(l){return l!==!1&&(l=l||"fx"),this.each(function(){var p,_=pe.get(this),M=_[l+"queue"],E=_[l+"queueHooks"],A=m.timers,R=M?M.length:0;for(_.finish=!0,m.queue(this,l,[]),E&&E.stop&&E.stop.call(this,!0),p=A.length;p--;)A[p].elem===this&&A[p].queue===l&&(A[p].anim.stop(!0),A.splice(p,1));for(p=0;p<R;p++)M[p]&&M[p].finish&&M[p].finish.call(this);delete _.finish})}}),m.each(["toggle","show","hide"],function(l,p){var _=m.fn[p];m.fn[p]=function(M,E,A){return M==null||typeof M=="boolean"?_.apply(this,arguments):this.animate(la(p,!0),M,E,A)}}),m.each({slideDown:la("show"),slideUp:la("hide"),slideToggle:la("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(l,p){m.fn[l]=function(_,M,E){return this.animate(p,_,M,E)}}),m.timers=[],m.fx.tick=function(){var l,p=0,_=m.timers;for(Mr=Date.now();p<_.length;p++)l=_[p],!l()&&_[p]===l&&_.splice(p--,1);_.length||m.fx.stop(),Mr=void 0},m.fx.timer=function(l){m.timers.push(l),m.fx.start()},m.fx.interval=13,m.fx.start=function(){oa||(oa=!0,Fo())},m.fx.stop=function(){oa=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(l,p){return l=m.fx&&m.fx.speeds[l]||l,p=p||"fx",this.queue(p,function(_,M){var E=e.setTimeout(_,l);M.stop=function(){e.clearTimeout(E)}})},function(){var l=y.createElement("input"),p=y.createElement("select"),_=p.appendChild(y.createElement("option"));l.type="checkbox",x.checkOn=l.value!=="",x.optSelected=_.selected,l=y.createElement("input"),l.value="t",l.type="radio",x.radioValue=l.value==="t"}();var Vc,Ms=m.expr.attrHandle;m.fn.extend({attr:function(l,p){return Ie(this,m.attr,l,p,arguments.length>1)},removeAttr:function(l){return this.each(function(){m.removeAttr(this,l)})}}),m.extend({attr:function(l,p,_){var M,E,A=l.nodeType;if(!(A===3||A===8||A===2)){if(typeof l.getAttribute=="undefined")return m.prop(l,p,_);if((A!==1||!m.isXMLDoc(l))&&(E=m.attrHooks[p.toLowerCase()]||(m.expr.match.bool.test(p)?Vc:void 0)),_!==void 0){if(_===null){m.removeAttr(l,p);return}return E&&"set"in E&&(M=E.set(l,_,p))!==void 0?M:(l.setAttribute(p,_+""),_)}return E&&"get"in E&&(M=E.get(l,p))!==null?M:(M=m.find.attr(l,p),M==null?void 0:M)}},attrHooks:{type:{set:function(l,p){if(!x.radioValue&&p==="radio"&&se(l,"input")){var _=l.value;return l.setAttribute("type",p),_&&(l.value=_),p}}}},removeAttr:function(l,p){var _,M=0,E=p&&p.match(Se);if(E&&l.nodeType===1)for(;_=E[M++];)l.removeAttribute(_)}}),Vc={set:function(l,p,_){return p===!1?m.removeAttr(l,_):l.setAttribute(_,_),_}},m.each(m.expr.match.bool.source.match(/\w+/g),function(l,p){var _=Ms[p]||m.find.attr;Ms[p]=function(M,E,A){var R,H,G=E.toLowerCase();return A||(H=Ms[G],Ms[G]=R,R=_(M,E,A)!=null?G:null,Ms[G]=H),R}});var Vd=/^(?:input|select|textarea|button)$/i,Gd=/^(?:a|area)$/i;m.fn.extend({prop:function(l,p){return Ie(this,m.prop,l,p,arguments.length>1)},removeProp:function(l){return this.each(function(){delete this[m.propFix[l]||l]})}}),m.extend({prop:function(l,p,_){var M,E,A=l.nodeType;if(!(A===3||A===8||A===2))return(A!==1||!m.isXMLDoc(l))&&(p=m.propFix[p]||p,E=m.propHooks[p]),_!==void 0?E&&"set"in E&&(M=E.set(l,_,p))!==void 0?M:l[p]=_:E&&"get"in E&&(M=E.get(l,p))!==null?M:l[p]},propHooks:{tabIndex:{get:function(l){var p=m.find.attr(l,"tabindex");return p?parseInt(p,10):Vd.test(l.nodeName)||Gd.test(l.nodeName)&&l.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),x.optSelected||(m.propHooks.selected={get:function(l){var p=l.parentNode;return p&&p.parentNode&&p.parentNode.selectedIndex,null},set:function(l){var p=l.parentNode;p&&(p.selectedIndex,p.parentNode&&p.parentNode.selectedIndex)}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this});function sr(l){var p=l.match(Se)||[];return p.join(" ")}function ar(l){return l.getAttribute&&l.getAttribute("class")||""}function Bo(l){return Array.isArray(l)?l:typeof l=="string"?l.match(Se)||[]:[]}m.fn.extend({addClass:function(l){var p,_,M,E,A,R,H,G=0;if(v(l))return this.each(function(ee){m(this).addClass(l.call(this,ee,ar(this)))});if(p=Bo(l),p.length){for(;_=this[G++];)if(E=ar(_),M=_.nodeType===1&&" "+sr(E)+" ",M){for(R=0;A=p[R++];)M.indexOf(" "+A+" ")<0&&(M+=A+" ");H=sr(M),E!==H&&_.setAttribute("class",H)}}return this},removeClass:function(l){var p,_,M,E,A,R,H,G=0;if(v(l))return this.each(function(ee){m(this).removeClass(l.call(this,ee,ar(this)))});if(!arguments.length)return this.attr("class","");if(p=Bo(l),p.length){for(;_=this[G++];)if(E=ar(_),M=_.nodeType===1&&" "+sr(E)+" ",M){for(R=0;A=p[R++];)for(;M.indexOf(" "+A+" ")>-1;)M=M.replace(" "+A+" "," ");H=sr(M),E!==H&&_.setAttribute("class",H)}}return this},toggleClass:function(l,p){var _=typeof l,M=_==="string"||Array.isArray(l);return typeof p=="boolean"&&M?p?this.addClass(l):this.removeClass(l):v(l)?this.each(function(E){m(this).toggleClass(l.call(this,E,ar(this),p),p)}):this.each(function(){var E,A,R,H;if(M)for(A=0,R=m(this),H=Bo(l);E=H[A++];)R.hasClass(E)?R.removeClass(E):R.addClass(E);else(l===void 0||_==="boolean")&&(E=ar(this),E&&pe.set(this,"__className__",E),this.setAttribute&&this.setAttribute("class",E||l===!1?"":pe.get(this,"__className__")||""))})},hasClass:function(l){var p,_,M=0;for(p=" "+l+" ";_=this[M++];)if(_.nodeType===1&&(" "+sr(ar(_))+" ").indexOf(p)>-1)return!0;return!1}});var Wd=/\r/g;m.fn.extend({val:function(l){var p,_,M,E=this[0];return arguments.length?(M=v(l),this.each(function(A){var R;this.nodeType===1&&(M?R=l.call(this,A,m(this).val()):R=l,R==null?R="":typeof R=="number"?R+="":Array.isArray(R)&&(R=m.map(R,function(H){return H==null?"":H+""})),p=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],(!p||!("set"in p)||p.set(this,R,"value")===void 0)&&(this.value=R))})):E?(p=m.valHooks[E.type]||m.valHooks[E.nodeName.toLowerCase()],p&&"get"in p&&(_=p.get(E,"value"))!==void 0?_:(_=E.value,typeof _=="string"?_.replace(Wd,""):_==null?"":_)):void 0}}),m.extend({valHooks:{option:{get:function(l){var p=m.find.attr(l,"value");return p!=null?p:sr(m.text(l))}},select:{get:function(l){var p,_,M,E=l.options,A=l.selectedIndex,R=l.type==="select-one",H=R?null:[],G=R?A+1:E.length;for(A<0?M=G:M=R?A:0;M<G;M++)if(_=E[M],(_.selected||M===A)&&!_.disabled&&(!_.parentNode.disabled||!se(_.parentNode,"optgroup"))){if(p=m(_).val(),R)return p;H.push(p)}return H},set:function(l,p){for(var _,M,E=l.options,A=m.makeArray(p),R=E.length;R--;)M=E[R],(M.selected=m.inArray(m.valHooks.option.get(M),A)>-1)&&(_=!0);return _||(l.selectedIndex=-1),A}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(l,p){if(Array.isArray(p))return l.checked=m.inArray(m(l).val(),p)>-1}},x.checkOn||(m.valHooks[this].get=function(l){return l.getAttribute("value")===null?"on":l.value})}),x.focusin="onfocusin"in e;var Gc=/^(?:focusinfocus|focusoutblur)$/,Wc=function(l){l.stopPropagation()};m.extend(m.event,{trigger:function(l,p,_,M){var E,A,R,H,G,ee,he,Le,ae=[_||y],xe=c.call(l,"type")?l.type:l,Ze=c.call(l,"namespace")?l.namespace.split("."):[];if(A=Le=R=_=_||y,!(_.nodeType===3||_.nodeType===8)&&!Gc.test(xe+m.event.triggered)&&(xe.indexOf(".")>-1&&(Ze=xe.split("."),xe=Ze.shift(),Ze.sort()),G=xe.indexOf(":")<0&&"on"+xe,l=l[m.expando]?l:new m.Event(xe,typeof l=="object"&&l),l.isTrigger=M?2:3,l.namespace=Ze.join("."),l.rnamespace=l.namespace?new RegExp("(^|\\.)"+Ze.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,l.result=void 0,l.target||(l.target=_),p=p==null?[l]:m.makeArray(p,[l]),he=m.event.special[xe]||{},!(!M&&he.trigger&&he.trigger.apply(_,p)===!1))){if(!M&&!he.noBubble&&!b(_)){for(H=he.delegateType||xe,Gc.test(H+xe)||(A=A.parentNode);A;A=A.parentNode)ae.push(A),R=A;R===(_.ownerDocument||y)&&ae.push(R.defaultView||R.parentWindow||e)}for(E=0;(A=ae[E++])&&!l.isPropagationStopped();)Le=A,l.type=E>1?H:he.bindType||xe,ee=(pe.get(A,"events")||Object.create(null))[l.type]&&pe.get(A,"handle"),ee&&ee.apply(A,p),ee=G&&A[G],ee&&ee.apply&&Ae(A)&&(l.result=ee.apply(A,p),l.result===!1&&l.preventDefault());return l.type=xe,!M&&!l.isDefaultPrevented()&&(!he._default||he._default.apply(ae.pop(),p)===!1)&&Ae(_)&&G&&v(_[xe])&&!b(_)&&(R=_[G],R&&(_[G]=null),m.event.triggered=xe,l.isPropagationStopped()&&Le.addEventListener(xe,Wc),_[xe](),l.isPropagationStopped()&&Le.removeEventListener(xe,Wc),m.event.triggered=void 0,R&&(_[G]=R)),l.result}},simulate:function(l,p,_){var M=m.extend(new m.Event,_,{type:l,isSimulated:!0});m.event.trigger(M,null,p)}}),m.fn.extend({trigger:function(l,p){return this.each(function(){m.event.trigger(l,p,this)})},triggerHandler:function(l,p){var _=this[0];if(_)return m.event.trigger(l,p,_,!0)}}),x.focusin||m.each({focus:"focusin",blur:"focusout"},function(l,p){var _=function(M){m.event.simulate(p,M.target,m.event.fix(M))};m.event.special[p]={setup:function(){var M=this.ownerDocument||this.document||this,E=pe.access(M,p);E||M.addEventListener(l,_,!0),pe.access(M,p,(E||0)+1)},teardown:function(){var M=this.ownerDocument||this.document||this,E=pe.access(M,p)-1;E?pe.access(M,p,E):(M.removeEventListener(l,_,!0),pe.remove(M,p))}}});var Ss=e.location,qc={guid:Date.now()},Oo=/\?/;m.parseXML=function(l){var p,_;if(!l||typeof l!="string")return null;try{p=new e.DOMParser().parseFromString(l,"text/xml")}catch{}return _=p&&p.getElementsByTagName("parsererror")[0],(!p||_)&&m.error("Invalid XML: "+(_?m.map(_.childNodes,function(M){return M.textContent}).join(`
`):l)),p};var qd=/\[\]$/,jc=/\r?\n/g,jd=/^(?:submit|button|image|reset|file)$/i,Xd=/^(?:input|select|textarea|keygen)/i;function zo(l,p,_,M){var E;if(Array.isArray(p))m.each(p,function(A,R){_||qd.test(l)?M(l,R):zo(l+"["+(typeof R=="object"&&R!=null?A:"")+"]",R,_,M)});else if(!_&&L(p)==="object")for(E in p)zo(l+"["+E+"]",p[E],_,M);else M(l,p)}m.param=function(l,p){var _,M=[],E=function(A,R){var H=v(R)?R():R;M[M.length]=encodeURIComponent(A)+"="+encodeURIComponent(H==null?"":H)};if(l==null)return"";if(Array.isArray(l)||l.jquery&&!m.isPlainObject(l))m.each(l,function(){E(this.name,this.value)});else for(_ in l)zo(_,l[_],p,E);return M.join("&")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var l=m.prop(this,"elements");return l?m.makeArray(l):this}).filter(function(){var l=this.type;return this.name&&!m(this).is(":disabled")&&Xd.test(this.nodeName)&&!jd.test(l)&&(this.checked||!ct.test(l))}).map(function(l,p){var _=m(this).val();return _==null?null:Array.isArray(_)?m.map(_,function(M){return{name:p.name,value:M.replace(jc,`\r
`)}}):{name:p.name,value:_.replace(jc,`\r
`)}}).get()}});var Yd=/%20/g,Zd=/#.*$/,$d=/([?&])_=[^&]*/,Jd=/^(.*?):[ \t]*([^\r\n]*)$/mg,Qd=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Kd=/^(?:GET|HEAD)$/,ep=/^\/\//,Xc={},Uo={},Yc="*/".concat("*"),ko=y.createElement("a");ko.href=Ss.href;function Zc(l){return function(p,_){typeof p!="string"&&(_=p,p="*");var M,E=0,A=p.toLowerCase().match(Se)||[];if(v(_))for(;M=A[E++];)M[0]==="+"?(M=M.slice(1)||"*",(l[M]=l[M]||[]).unshift(_)):(l[M]=l[M]||[]).push(_)}}function $c(l,p,_,M){var E={},A=l===Uo;function R(H){var G;return E[H]=!0,m.each(l[H]||[],function(ee,he){var Le=he(p,_,M);if(typeof Le=="string"&&!A&&!E[Le])return p.dataTypes.unshift(Le),R(Le),!1;if(A)return!(G=Le)}),G}return R(p.dataTypes[0])||!E["*"]&&R("*")}function Ho(l,p){var _,M,E=m.ajaxSettings.flatOptions||{};for(_ in p)p[_]!==void 0&&((E[_]?l:M||(M={}))[_]=p[_]);return M&&m.extend(!0,l,M),l}function tp(l,p,_){for(var M,E,A,R,H=l.contents,G=l.dataTypes;G[0]==="*";)G.shift(),M===void 0&&(M=l.mimeType||p.getResponseHeader("Content-Type"));if(M){for(E in H)if(H[E]&&H[E].test(M)){G.unshift(E);break}}if(G[0]in _)A=G[0];else{for(E in _){if(!G[0]||l.converters[E+" "+G[0]]){A=E;break}R||(R=E)}A=A||R}if(A)return A!==G[0]&&G.unshift(A),_[A]}function np(l,p,_,M){var E,A,R,H,G,ee={},he=l.dataTypes.slice();if(he[1])for(R in l.converters)ee[R.toLowerCase()]=l.converters[R];for(A=he.shift();A;)if(l.responseFields[A]&&(_[l.responseFields[A]]=p),!G&&M&&l.dataFilter&&(p=l.dataFilter(p,l.dataType)),G=A,A=he.shift(),A){if(A==="*")A=G;else if(G!=="*"&&G!==A){if(R=ee[G+" "+A]||ee["* "+A],!R){for(E in ee)if(H=E.split(" "),H[1]===A&&(R=ee[G+" "+H[0]]||ee["* "+H[0]],R)){R===!0?R=ee[E]:ee[E]!==!0&&(A=H[0],he.unshift(H[1]));break}}if(R!==!0)if(R&&l.throws)p=R(p);else try{p=R(p)}catch(Le){return{state:"parsererror",error:R?Le:"No conversion from "+G+" to "+A}}}}return{state:"success",data:p}}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ss.href,type:"GET",isLocal:Qd.test(Ss.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Yc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(l,p){return p?Ho(Ho(l,m.ajaxSettings),p):Ho(m.ajaxSettings,l)},ajaxPrefilter:Zc(Xc),ajaxTransport:Zc(Uo),ajax:function(l,p){typeof l=="object"&&(p=l,l=void 0),p=p||{};var _,M,E,A,R,H,G,ee,he,Le,ae=m.ajaxSetup({},p),xe=ae.context||ae,Ze=ae.context&&(xe.nodeType||xe.jquery)?m(xe):m.event,ht=m.Deferred(),$e=m.Callbacks("once memory"),Zt=ae.statusCode||{},Xt={},In={},St="canceled",ut={readyState:0,getResponseHeader:function(xt){var Bt;if(G){if(!A)for(A={};Bt=Jd.exec(E);)A[Bt[1].toLowerCase()+" "]=(A[Bt[1].toLowerCase()+" "]||[]).concat(Bt[2]);Bt=A[xt.toLowerCase()+" "]}return Bt==null?null:Bt.join(", ")},getAllResponseHeaders:function(){return G?E:null},setRequestHeader:function(xt,Bt){return G==null&&(xt=In[xt.toLowerCase()]=In[xt.toLowerCase()]||xt,Xt[xt]=Bt),this},overrideMimeType:function(xt){return G==null&&(ae.mimeType=xt),this},statusCode:function(xt){var Bt;if(xt)if(G)ut.always(xt[ut.status]);else for(Bt in xt)Zt[Bt]=[Zt[Bt],xt[Bt]];return this},abort:function(xt){var Bt=xt||St;return _&&_.abort(Bt),Tn(0,Bt),this}};if(ht.promise(ut),ae.url=((l||ae.url||Ss.href)+"").replace(ep,Ss.protocol+"//"),ae.type=p.method||p.type||ae.method||ae.type,ae.dataTypes=(ae.dataType||"*").toLowerCase().match(Se)||[""],ae.crossDomain==null){H=y.createElement("a");try{H.href=ae.url,H.href=H.href,ae.crossDomain=ko.protocol+"//"+ko.host!=H.protocol+"//"+H.host}catch{ae.crossDomain=!0}}if(ae.data&&ae.processData&&typeof ae.data!="string"&&(ae.data=m.param(ae.data,ae.traditional)),$c(Xc,ae,p,ut),G)return ut;ee=m.event&&ae.global,ee&&m.active++===0&&m.event.trigger("ajaxStart"),ae.type=ae.type.toUpperCase(),ae.hasContent=!Kd.test(ae.type),M=ae.url.replace(Zd,""),ae.hasContent?ae.data&&ae.processData&&(ae.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(ae.data=ae.data.replace(Yd,"+")):(Le=ae.url.slice(M.length),ae.data&&(ae.processData||typeof ae.data=="string")&&(M+=(Oo.test(M)?"&":"?")+ae.data,delete ae.data),ae.cache===!1&&(M=M.replace($d,"$1"),Le=(Oo.test(M)?"&":"?")+"_="+qc.guid+++Le),ae.url=M+Le),ae.ifModified&&(m.lastModified[M]&&ut.setRequestHeader("If-Modified-Since",m.lastModified[M]),m.etag[M]&&ut.setRequestHeader("If-None-Match",m.etag[M])),(ae.data&&ae.hasContent&&ae.contentType!==!1||p.contentType)&&ut.setRequestHeader("Content-Type",ae.contentType),ut.setRequestHeader("Accept",ae.dataTypes[0]&&ae.accepts[ae.dataTypes[0]]?ae.accepts[ae.dataTypes[0]]+(ae.dataTypes[0]!=="*"?", "+Yc+"; q=0.01":""):ae.accepts["*"]);for(he in ae.headers)ut.setRequestHeader(he,ae.headers[he]);if(ae.beforeSend&&(ae.beforeSend.call(xe,ut,ae)===!1||G))return ut.abort();if(St="abort",$e.add(ae.complete),ut.done(ae.success),ut.fail(ae.error),_=$c(Uo,ae,p,ut),!_)Tn(-1,"No Transport");else{if(ut.readyState=1,ee&&Ze.trigger("ajaxSend",[ut,ae]),G)return ut;ae.async&&ae.timeout>0&&(R=e.setTimeout(function(){ut.abort("timeout")},ae.timeout));try{G=!1,_.send(Xt,Tn)}catch(xt){if(G)throw xt;Tn(-1,xt)}}function Tn(xt,Bt,Ts,ca){var Fn,or,lr,An,Pi,qn=Bt;G||(G=!0,R&&e.clearTimeout(R),_=void 0,E=ca||"",ut.readyState=xt>0?4:0,Fn=xt>=200&&xt<300||xt===304,Ts&&(An=tp(ae,ut,Ts)),!Fn&&m.inArray("script",ae.dataTypes)>-1&&m.inArray("json",ae.dataTypes)<0&&(ae.converters["text script"]=function(){}),An=np(ae,An,ut,Fn),Fn?(ae.ifModified&&(Pi=ut.getResponseHeader("Last-Modified"),Pi&&(m.lastModified[M]=Pi),Pi=ut.getResponseHeader("etag"),Pi&&(m.etag[M]=Pi)),xt===204||ae.type==="HEAD"?qn="nocontent":xt===304?qn="notmodified":(qn=An.state,or=An.data,lr=An.error,Fn=!lr)):(lr=qn,(xt||!qn)&&(qn="error",xt<0&&(xt=0))),ut.status=xt,ut.statusText=(Bt||qn)+"",Fn?ht.resolveWith(xe,[or,qn,ut]):ht.rejectWith(xe,[ut,qn,lr]),ut.statusCode(Zt),Zt=void 0,ee&&Ze.trigger(Fn?"ajaxSuccess":"ajaxError",[ut,ae,Fn?or:lr]),$e.fireWith(xe,[ut,qn]),ee&&(Ze.trigger("ajaxComplete",[ut,ae]),--m.active||m.event.trigger("ajaxStop")))}return ut},getJSON:function(l,p,_){return m.get(l,p,_,"json")},getScript:function(l,p){return m.get(l,void 0,p,"script")}}),m.each(["get","post"],function(l,p){m[p]=function(_,M,E,A){return v(M)&&(A=A||E,E=M,M=void 0),m.ajax(m.extend({url:_,type:p,dataType:A,data:M,success:E},m.isPlainObject(_)&&_))}}),m.ajaxPrefilter(function(l){var p;for(p in l.headers)p.toLowerCase()==="content-type"&&(l.contentType=l.headers[p]||"")}),m._evalUrl=function(l,p,_){return m.ajax({url:l,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(M){m.globalEval(M,p,_)}})},m.fn.extend({wrapAll:function(l){var p;return this[0]&&(v(l)&&(l=l.call(this[0])),p=m(l,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&p.insertBefore(this[0]),p.map(function(){for(var _=this;_.firstElementChild;)_=_.firstElementChild;return _}).append(this)),this},wrapInner:function(l){return v(l)?this.each(function(p){m(this).wrapInner(l.call(this,p))}):this.each(function(){var p=m(this),_=p.contents();_.length?_.wrapAll(l):p.append(l)})},wrap:function(l){var p=v(l);return this.each(function(_){m(this).wrapAll(p?l.call(this,_):l)})},unwrap:function(l){return this.parent(l).not("body").each(function(){m(this).replaceWith(this.childNodes)}),this}}),m.expr.pseudos.hidden=function(l){return!m.expr.pseudos.visible(l)},m.expr.pseudos.visible=function(l){return!!(l.offsetWidth||l.offsetHeight||l.getClientRects().length)},m.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var ip={0:200,1223:204},Es=m.ajaxSettings.xhr();x.cors=!!Es&&"withCredentials"in Es,x.ajax=Es=!!Es,m.ajaxTransport(function(l){var p,_;if(x.cors||Es&&!l.crossDomain)return{send:function(M,E){var A,R=l.xhr();if(R.open(l.type,l.url,l.async,l.username,l.password),l.xhrFields)for(A in l.xhrFields)R[A]=l.xhrFields[A];l.mimeType&&R.overrideMimeType&&R.overrideMimeType(l.mimeType),!l.crossDomain&&!M["X-Requested-With"]&&(M["X-Requested-With"]="XMLHttpRequest");for(A in M)R.setRequestHeader(A,M[A]);p=function(H){return function(){p&&(p=_=R.onload=R.onerror=R.onabort=R.ontimeout=R.onreadystatechange=null,H==="abort"?R.abort():H==="error"?typeof R.status!="number"?E(0,"error"):E(R.status,R.statusText):E(ip[R.status]||R.status,R.statusText,(R.responseType||"text")!=="text"||typeof R.responseText!="string"?{binary:R.response}:{text:R.responseText},R.getAllResponseHeaders()))}},R.onload=p(),_=R.onerror=R.ontimeout=p("error"),R.onabort!==void 0?R.onabort=_:R.onreadystatechange=function(){R.readyState===4&&e.setTimeout(function(){p&&_()})},p=p("abort");try{R.send(l.hasContent&&l.data||null)}catch(H){if(p)throw H}},abort:function(){p&&p()}}}),m.ajaxPrefilter(function(l){l.crossDomain&&(l.contents.script=!1)}),m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(l){return m.globalEval(l),l}}}),m.ajaxPrefilter("script",function(l){l.cache===void 0&&(l.cache=!1),l.crossDomain&&(l.type="GET")}),m.ajaxTransport("script",function(l){if(l.crossDomain||l.scriptAttrs){var p,_;return{send:function(M,E){p=m("<script>").attr(l.scriptAttrs||{}).prop({charset:l.scriptCharset,src:l.url}).on("load error",_=function(A){p.remove(),_=null,A&&E(A.type==="error"?404:200,A.type)}),y.head.appendChild(p[0])},abort:function(){_&&_()}}}});var Jc=[],Vo=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var l=Jc.pop()||m.expando+"_"+qc.guid++;return this[l]=!0,l}}),m.ajaxPrefilter("json jsonp",function(l,p,_){var M,E,A,R=l.jsonp!==!1&&(Vo.test(l.url)?"url":typeof l.data=="string"&&(l.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Vo.test(l.data)&&"data");if(R||l.dataTypes[0]==="jsonp")return M=l.jsonpCallback=v(l.jsonpCallback)?l.jsonpCallback():l.jsonpCallback,R?l[R]=l[R].replace(Vo,"$1"+M):l.jsonp!==!1&&(l.url+=(Oo.test(l.url)?"&":"?")+l.jsonp+"="+M),l.converters["script json"]=function(){return A||m.error(M+" was not called"),A[0]},l.dataTypes[0]="json",E=e[M],e[M]=function(){A=arguments},_.always(function(){E===void 0?m(e).removeProp(M):e[M]=E,l[M]&&(l.jsonpCallback=p.jsonpCallback,Jc.push(M)),A&&v(E)&&E(A[0]),A=E=void 0}),"script"}),x.createHTMLDocument=function(){var l=y.implementation.createHTMLDocument("").body;return l.innerHTML="<form></form><form></form>",l.childNodes.length===2}(),m.parseHTML=function(l,p,_){if(typeof l!="string")return[];typeof p=="boolean"&&(_=p,p=!1);var M,E,A;return p||(x.createHTMLDocument?(p=y.implementation.createHTMLDocument(""),M=p.createElement("base"),M.href=y.location.href,p.head.appendChild(M)):p=y),E=$.exec(l),A=!_&&[],E?[p.createElement(E[1])]:(E=hn([l],p,A),A&&A.length&&m(A).remove(),m.merge([],E.childNodes))},m.fn.load=function(l,p,_){var M,E,A,R=this,H=l.indexOf(" ");return H>-1&&(M=sr(l.slice(H)),l=l.slice(0,H)),v(p)?(_=p,p=void 0):p&&typeof p=="object"&&(E="POST"),R.length>0&&m.ajax({url:l,type:E||"GET",dataType:"html",data:p}).done(function(G){A=arguments,R.html(M?m("<div>").append(m.parseHTML(G)).find(M):G)}).always(_&&function(G,ee){R.each(function(){_.apply(this,A||[G.responseText,ee,G])})}),this},m.expr.pseudos.animated=function(l){return m.grep(m.timers,function(p){return l===p.elem}).length},m.offset={setOffset:function(l,p,_){var M,E,A,R,H,G,ee,he=m.css(l,"position"),Le=m(l),ae={};he==="static"&&(l.style.position="relative"),H=Le.offset(),A=m.css(l,"top"),G=m.css(l,"left"),ee=(he==="absolute"||he==="fixed")&&(A+G).indexOf("auto")>-1,ee?(M=Le.position(),R=M.top,E=M.left):(R=parseFloat(A)||0,E=parseFloat(G)||0),v(p)&&(p=p.call(l,_,m.extend({},H))),p.top!=null&&(ae.top=p.top-H.top+R),p.left!=null&&(ae.left=p.left-H.left+E),"using"in p?p.using.call(l,ae):Le.css(ae)}},m.fn.extend({offset:function(l){if(arguments.length)return l===void 0?this:this.each(function(E){m.offset.setOffset(this,l,E)});var p,_,M=this[0];if(!!M)return M.getClientRects().length?(p=M.getBoundingClientRect(),_=M.ownerDocument.defaultView,{top:p.top+_.pageYOffset,left:p.left+_.pageXOffset}):{top:0,left:0}},position:function(){if(!!this[0]){var l,p,_,M=this[0],E={top:0,left:0};if(m.css(M,"position")==="fixed")p=M.getBoundingClientRect();else{for(p=this.offset(),_=M.ownerDocument,l=M.offsetParent||_.documentElement;l&&(l===_.body||l===_.documentElement)&&m.css(l,"position")==="static";)l=l.parentNode;l&&l!==M&&l.nodeType===1&&(E=m(l).offset(),E.top+=m.css(l,"borderTopWidth",!0),E.left+=m.css(l,"borderLeftWidth",!0))}return{top:p.top-E.top-m.css(M,"marginTop",!0),left:p.left-E.left-m.css(M,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var l=this.offsetParent;l&&m.css(l,"position")==="static";)l=l.offsetParent;return l||Te})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(l,p){var _=p==="pageYOffset";m.fn[l]=function(M){return Ie(this,function(E,A,R){var H;if(b(E)?H=E:E.nodeType===9&&(H=E.defaultView),R===void 0)return H?H[p]:E[A];H?H.scrollTo(_?H.pageXOffset:R,_?R:H.pageYOffset):E[A]=R},l,M,arguments.length)}}),m.each(["top","left"],function(l,p){m.cssHooks[p]=dt(x.pixelPosition,function(_,M){if(M)return M=Ye(_,p),De.test(M)?m(_).position()[p]+"px":M})}),m.each({Height:"height",Width:"width"},function(l,p){m.each({padding:"inner"+l,content:p,"":"outer"+l},function(_,M){m.fn[M]=function(E,A){var R=arguments.length&&(_||typeof E!="boolean"),H=_||(E===!0||A===!0?"margin":"border");return Ie(this,function(G,ee,he){var Le;return b(G)?M.indexOf("outer")===0?G["inner"+l]:G.document.documentElement["client"+l]:G.nodeType===9?(Le=G.documentElement,Math.max(G.body["scroll"+l],Le["scroll"+l],G.body["offset"+l],Le["offset"+l],Le["client"+l])):he===void 0?m.css(G,ee,H):m.style(G,ee,he,H)},p,R?E:void 0,R)}})}),m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(l,p){m.fn[p]=function(_){return this.on(p,_)}}),m.fn.extend({bind:function(l,p,_){return this.on(l,null,p,_)},unbind:function(l,p){return this.off(l,null,p)},delegate:function(l,p,_,M){return this.on(p,l,_,M)},undelegate:function(l,p,_){return arguments.length===1?this.off(l,"**"):this.off(p,l||"**",_)},hover:function(l,p){return this.mouseenter(l).mouseleave(p||l)}}),m.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(l,p){m.fn[p]=function(_,M){return arguments.length>0?this.on(p,null,_,M):this.trigger(p)}});var rp=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;m.proxy=function(l,p){var _,M,E;if(typeof p=="string"&&(_=l[p],p=l,l=_),!!v(l))return M=s.call(arguments,2),E=function(){return l.apply(p||this,M.concat(s.call(arguments)))},E.guid=l.guid=l.guid||m.guid++,E},m.holdReady=function(l){l?m.readyWait++:m.ready(!0)},m.isArray=Array.isArray,m.parseJSON=JSON.parse,m.nodeName=se,m.isFunction=v,m.isWindow=b,m.camelCase=ge,m.type=L,m.now=Date.now,m.isNumeric=function(l){var p=m.type(l);return(p==="number"||p==="string")&&!isNaN(l-parseFloat(l))},m.trim=function(l){return l==null?"":(l+"").replace(rp,"")};var sp=e.jQuery,ap=e.$;return m.noConflict=function(l){return e.$===m&&(e.$=ap),l&&e.jQuery===m&&(e.jQuery=sp),m},typeof t=="undefined"&&(e.jQuery=e.$=m),m})})(Zh);var $a=Zh.exports;function Gl(){return Gl=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Gl.apply(this,arguments)}var $h={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function Vt(r){return typeof r=="number"}function ai(r){return!r||typeof r!="object"||typeof r.constructor!="function"?!1:r.isBigNumber===!0&&typeof r.constructor.prototype=="object"&&r.constructor.prototype.isBigNumber===!0||typeof r.constructor.isDecimal=="function"&&r.constructor.isDecimal(r)===!0}function uc(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isComplex===!0||!1}function hc(r){return r&&typeof r=="object"&&Object.getPrototypeOf(r).isFraction===!0||!1}function fc(r){return r&&r.constructor.prototype.isUnit===!0||!1}function Ci(r){return typeof r=="string"}var Ot=Array.isArray;function _n(r){return r&&r.constructor.prototype.isMatrix===!0||!1}function Jh(r){return Array.isArray(r)||_n(r)}function bp(r){return r&&r.isDenseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function Mp(r){return r&&r.isSparseMatrix&&r.constructor.prototype.isMatrix===!0||!1}function Qh(r){return r&&r.constructor.prototype.isRange===!0||!1}function mo(r){return r&&r.constructor.prototype.isIndex===!0||!1}function Sp(r){return typeof r=="boolean"}function Kh(r){return r&&r.constructor.prototype.isResultSet===!0||!1}function ef(r){return r&&r.constructor.prototype.isHelp===!0||!1}function Ep(r){return typeof r=="function"}function Tp(r){return r instanceof Date}function Ap(r){return r instanceof RegExp}function Cp(r){return!!(r&&typeof r=="object"&&r.constructor===Object&&!uc(r)&&!hc(r))}function Lp(r){return r===null}function Rp(r){return r===void 0}function Pp(r){return r&&r.isAccessorNode===!0&&r.constructor.prototype.isNode===!0||!1}function Np(r){return r&&r.isArrayNode===!0&&r.constructor.prototype.isNode===!0||!1}function Dp(r){return r&&r.isAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function Ip(r){return r&&r.isBlockNode===!0&&r.constructor.prototype.isNode===!0||!1}function Fp(r){return r&&r.isConditionalNode===!0&&r.constructor.prototype.isNode===!0||!1}function Bp(r){return r&&r.isConstantNode===!0&&r.constructor.prototype.isNode===!0||!1}function Op(r){return r&&r.isFunctionAssignmentNode===!0&&r.constructor.prototype.isNode===!0||!1}function zp(r){return r&&r.isFunctionNode===!0&&r.constructor.prototype.isNode===!0||!1}function Up(r){return r&&r.isIndexNode===!0&&r.constructor.prototype.isNode===!0||!1}function tf(r){return r&&r.isNode===!0&&r.constructor.prototype.isNode===!0||!1}function kp(r){return r&&r.isObjectNode===!0&&r.constructor.prototype.isNode===!0||!1}function Hp(r){return r&&r.isOperatorNode===!0&&r.constructor.prototype.isNode===!0||!1}function Vp(r){return r&&r.isParenthesisNode===!0&&r.constructor.prototype.isNode===!0||!1}function Gp(r){return r&&r.isRangeNode===!0&&r.constructor.prototype.isNode===!0||!1}function Wp(r){return r&&r.isSymbolNode===!0&&r.constructor.prototype.isNode===!0||!1}function nf(r){return r&&r.constructor.prototype.isChain===!0||!1}function Vs(r){var e=typeof r;return e==="object"?r===null?"null":Array.isArray(r)?"Array":r instanceof Date?"Date":r instanceof RegExp?"RegExp":ai(r)?"BigNumber":uc(r)?"Complex":hc(r)?"Fraction":_n(r)?"Matrix":fc(r)?"Unit":mo(r)?"Index":Qh(r)?"Range":Kh(r)?"ResultSet":tf(r)?r.type:nf(r)?"Chain":ef(r)?"Help":"Object":e==="function"?"Function":e}function an(r){var e=typeof r;if(e==="number"||e==="string"||e==="boolean"||r===null||r===void 0)return r;if(typeof r.clone=="function")return r.clone();if(Array.isArray(r))return r.map(function(t){return an(t)});if(r instanceof Date)return new Date(r.valueOf());if(ai(r))return r;if(r instanceof RegExp)throw new TypeError("Cannot clone "+r);return qp(r,an)}function qp(r,e){var t={};for(var n in r)Ys(r,n)&&(t[n]=e(r[n]));return t}function jp(r,e){for(var t in e)Ys(e,t)&&(r[t]=e[t]);return r}function Ja(r,e){var t,n,i;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(n=0,i=r.length;n<i;n++)if(!Ja(r[n],e[n]))return!1;return!0}else{if(typeof r=="function")return r===e;if(r instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(t in r)if(!(t in e)||!Ja(r[t],e[t]))return!1;for(t in e)if(!(t in r))return!1;return!0}else return r===e}}function Ys(r,e){return r&&Object.hasOwnProperty.call(r,e)}function Xp(r,e){for(var t={},n=0;n<e.length;n++){var i=e[n],s=r[i];s!==void 0&&(t[i]=s)}return t}var Yp=["Matrix","Array"],Zp=["number","BigNumber","Fraction"],ia=function(e){if(e)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze($h)};Gl(ia,$h,{MATRIX_OPTIONS:Yp,NUMBER_OPTIONS:Zp});var rf={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(Xh,function(){function t(){return!0}function n(){return!1}function i(){}function s(){var a=[{name:"number",test:function(D){return typeof D=="number"}},{name:"string",test:function(D){return typeof D=="string"}},{name:"boolean",test:function(D){return typeof D=="boolean"}},{name:"Function",test:function(D){return typeof D=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(D){return D instanceof Date}},{name:"RegExp",test:function(D){return D instanceof RegExp}},{name:"Object",test:function(D){return typeof D=="object"&&D!==null&&D.constructor===Object}},{name:"null",test:function(D){return D===null}},{name:"undefined",test:function(D){return D===void 0}}],o={name:"any",test:t},u=[],f=[],h={types:a,conversions:f,ignore:u};function c(D){var X=ke(h.types,function(Y){return Y.name===D});if(X)return X;if(D==="any")return o;var J=ke(h.types,function(Y){return Y.name.toLowerCase()===D.toLowerCase()});throw new TypeError('Unknown type "'+D+'"'+(J?'. Did you mean "'+J.name+'"?':""))}function d(D){return D===o?999:h.types.indexOf(D)}function g(D){var X=ke(h.types,function(J){return J.test(D)});if(X)return X.name;throw new TypeError("Value has unknown type. Value: "+D)}function x(D,X){if(!D.signatures)throw new TypeError("Function is no typed-function");var J;if(typeof X=="string"){J=X.split(",");for(var Y=0;Y<J.length;Y++)J[Y]=J[Y].trim()}else if(Array.isArray(X))J=X;else throw new TypeError("String array or a comma separated string expected");var ve=J.join(","),Te=D.signatures[ve];if(Te)return Te;throw new TypeError("Signature not found (signature: "+(D.name||"unnamed")+"("+J.join(", ")+"))")}function v(D,X){var J=g(D);if(X===J)return D;for(var Y=0;Y<h.conversions.length;Y++){var ve=h.conversions[Y];if(ve.from===J&&ve.to===X)return ve.convert(D)}throw new Error("Cannot convert from "+J+" to "+X)}function b(D){return D.map(function(X){var J=X.types.map(z);return(X.restParam?"...":"")+J.join("|")}).join(",")}function y(D,X){var J=D.indexOf("...")===0,Y=J?D.length>3?D.slice(3):"any":D,ve=Y.split("|").map(re).filter(ze).filter(Oe),Te=ie(X,ve),Me=ve.map(function(ce){var oe=c(ce);return{name:ce,typeIndex:d(oe),test:oe.test,conversion:null,conversionIndex:-1}}),U=Te.map(function(ce){var oe=c(ce.from);return{name:ce.from,typeIndex:d(oe),test:oe.test,conversion:ce,conversionIndex:X.indexOf(ce)}});return{types:Me.concat(U),restParam:J}}function w(D,X,J){var Y=[];return D.trim()!==""&&(Y=D.split(",").map(re).map(function(ve,Te,Me){var U=y(ve,J);if(U.restParam&&Te!==Me.length-1)throw new SyntaxError('Unexpected rest parameter "'+ve+'": only allowed for the last parameter');return U})),Y.some(Ie)?null:{params:Y,fn:X}}function S(D){var X=Xe(D);return X?X.restParam:!1}function L(D){return D.types.some(function(X){return X.conversion!=null})}function T(D){if(!D||D.types.length===0)return t;if(D.types.length===1)return c(D.types[0].name).test;if(D.types.length===2){var X=c(D.types[0].name).test,J=c(D.types[1].name).test;return function(Te){return X(Te)||J(Te)}}else{var Y=D.types.map(function(ve){return c(ve.name).test});return function(Te){for(var Me=0;Me<Y.length;Me++)if(Y[Me](Te))return!0;return!1}}}function m(D){var X,J,Y;if(S(D)){X=Be(D).map(T);var ve=X.length,Te=T(Xe(D)),Me=function(U){for(var ce=ve;ce<U.length;ce++)if(!Te(U[ce]))return!1;return!0};return function(ce){for(var oe=0;oe<X.length;oe++)if(!X[oe](ce[oe]))return!1;return Me(ce)&&ce.length>=ve+1}}else return D.length===0?function(ce){return ce.length===0}:D.length===1?(J=T(D[0]),function(ce){return J(ce[0])&&ce.length===1}):D.length===2?(J=T(D[0]),Y=T(D[1]),function(ce){return J(ce[0])&&Y(ce[1])&&ce.length===2}):(X=D.map(T),function(ce){for(var oe=0;oe<X.length;oe++)if(!X[oe](ce[oe]))return!1;return ce.length===X.length})}function C(D,X){return X<D.params.length?D.params[X]:S(D.params)?Xe(D.params):null}function N(D,X,J){var Y=C(D,X),ve=Y?J?Y.types.filter(W):Y.types:[];return ve.map(z)}function z(D){return D.name}function W(D){return D.conversion===null||D.conversion===void 0}function B(D,X){var J=pe(O(D,function(Y){return N(Y,X,!1)}));return J.indexOf("any")!==-1?["any"]:J}function se(D,X,J){var Y,ve,Te=D||"unnamed",Me=J,U;for(U=0;U<X.length;U++){var ce=Me.filter(function(Pe){var ct=T(C(Pe,U));return(U<Pe.params.length||S(Pe.params))&&ct(X[U])});if(ce.length===0){if(ve=B(Me,U),ve.length>0){var oe=g(X[U]);return Y=new TypeError("Unexpected type of argument in function "+Te+" (expected: "+ve.join(" or ")+", actual: "+oe+", index: "+U+")"),Y.data={category:"wrongType",fn:Te,index:U,actual:oe,expected:ve},Y}}else Me=ce}var Ue=Me.map(function(Pe){return S(Pe.params)?1/0:Pe.params.length});if(X.length<Math.min.apply(null,Ue))return ve=B(Me,U),Y=new TypeError("Too few arguments in function "+Te+" (expected: "+ve.join(" or ")+", index: "+X.length+")"),Y.data={category:"tooFewArgs",fn:Te,index:X.length,expected:ve},Y;var q=Math.max.apply(null,Ue);return X.length>q?(Y=new TypeError("Too many arguments in function "+Te+" (expected: "+q+", actual: "+X.length+")"),Y.data={category:"tooManyArgs",fn:Te,index:X.length,expectedLength:q},Y):(Y=new TypeError('Arguments of type "'+X.join(", ")+'" do not match any of the defined signatures of function '+Te+"."),Y.data={category:"mismatch",actual:X.map(g)},Y)}function $(D){for(var X=999,J=0;J<D.types.length;J++)W(D.types[J])&&(X=Math.min(X,D.types[J].typeIndex));return X}function Q(D){for(var X=999,J=0;J<D.types.length;J++)W(D.types[J])||(X=Math.min(X,D.types[J].conversionIndex));return X}function K(D,X){var J;return J=D.restParam-X.restParam,J!==0||(J=L(D)-L(X),J!==0)||(J=$(D)-$(X),J!==0)?J:Q(D)-Q(X)}function j(D,X){var J=Math.min(D.params.length,X.params.length),Y,ve;if(ve=D.params.some(L)-X.params.some(L),ve!==0)return ve;for(Y=0;Y<J;Y++)if(ve=L(D.params[Y])-L(X.params[Y]),ve!==0)return ve;for(Y=0;Y<J;Y++)if(ve=K(D.params[Y],X.params[Y]),ve!==0)return ve;return D.params.length-X.params.length}function ie(D,X){var J={};return D.forEach(function(Y){X.indexOf(Y.from)===-1&&X.indexOf(Y.to)!==-1&&!J[Y.from]&&(J[Y.from]=Y)}),Object.keys(J).map(function(Y){return J[Y]})}function de(D,X){var J=X;if(D.some(L)){var Y=S(D),ve=D.map(we);J=function(){for(var ce=[],oe=Y?arguments.length-1:arguments.length,Ue=0;Ue<oe;Ue++)ce[Ue]=ve[Ue](arguments[Ue]);return Y&&(ce[oe]=arguments[oe].map(ve[oe])),X.apply(this,ce)}}var Te=J;if(S(D)){var Me=D.length-1;Te=function(){return J.apply(this,fe(arguments,0,Me).concat([fe(arguments,Me)]))}}return Te}function we(D){var X,J,Y,ve,Te=[],Me=[];switch(D.types.forEach(function(U){U.conversion&&(Te.push(c(U.conversion.from).test),Me.push(U.conversion.convert))}),Me.length){case 0:return function(ce){return ce};case 1:return X=Te[0],Y=Me[0],function(ce){return X(ce)?Y(ce):ce};case 2:return X=Te[0],J=Te[1],Y=Me[0],ve=Me[1],function(ce){return X(ce)?Y(ce):J(ce)?ve(ce):ce};default:return function(ce){for(var oe=0;oe<Me.length;oe++)if(Te[oe](ce))return Me[oe](ce);return ce}}}function Ne(D){var X={};return D.forEach(function(J){J.params.some(L)||Se(J.params,!0).forEach(function(Y){X[b(Y)]=J.fn})}),X}function Se(D,X){function J(Y,ve,Te){if(ve<Y.length){var Me=Y[ve],U=X?Me.types.filter(W):Me.types,ce;if(Me.restParam){var oe=U.filter(W);ce=oe.length<U.length?[oe,U]:[U]}else ce=U.map(function(q){return[q]});return O(ce,function(q){return J(Y,ve+1,Te.concat([q]))})}else{var Ue=Te.map(function(q,Pe){return{types:q,restParam:Pe===Y.length-1&&S(Y)}});return[Ue]}}return J(D,0,[])}function Ve(D,X){for(var J=Math.max(D.params.length,X.params.length),Y=0;Y<J;Y++){var ve=N(D,Y,!0),Te=N(X,Y,!0);if(!Ae(ve,Te))return!1}var Me=D.params.length,U=X.params.length,ce=S(D.params),oe=S(X.params);return ce?oe?Me===U:U>=Me:oe?Me>=U:Me===U}function ue(D,X){if(Object.keys(X).length===0)throw new SyntaxError("No signatures provided");var J=[];Object.keys(X).map(function(Ge){return w(Ge,X[Ge],h.conversions)}).filter(je).forEach(function(Ge){var Ye=ke(J,function(dt){return Ve(dt,Ge)});if(Ye)throw new TypeError('Conflicting signatures "'+b(Ye.params)+'" and "'+b(Ge.params)+'".');J.push(Ge)});var Y=O(J,function(Ge){var Ye=Ge?Se(Ge.params,!1):[];return Ye.map(function(dt){return{params:dt,fn:Ge.fn}})}).filter(je);Y.sort(j);var ve=Y[0]&&Y[0].params.length<=2&&!S(Y[0].params),Te=Y[1]&&Y[1].params.length<=2&&!S(Y[1].params),Me=Y[2]&&Y[2].params.length<=2&&!S(Y[2].params),U=Y[3]&&Y[3].params.length<=2&&!S(Y[3].params),ce=Y[4]&&Y[4].params.length<=2&&!S(Y[4].params),oe=Y[5]&&Y[5].params.length<=2&&!S(Y[5].params),Ue=ve&&Te&&Me&&U&&ce&&oe,q=Y.map(function(Ge){return m(Ge.params)}),Pe=ve?T(Y[0].params[0]):n,ct=Te?T(Y[1].params[0]):n,pt=Me?T(Y[2].params[0]):n,Nt=U?T(Y[3].params[0]):n,ft=ce?T(Y[4].params[0]):n,_t=oe?T(Y[5].params[0]):n,en=ve?T(Y[0].params[1]):n,rn=Te?T(Y[1].params[1]):n,hn=Me?T(Y[2].params[1]):n,tr=U?T(Y[3].params[1]):n,$n=ce?T(Y[4].params[1]):n,fn=oe?T(Y[5].params[1]):n,Wn=Y.map(function(Ge){return de(Ge.params,Ge.fn)}),wr=ve?Wn[0]:i,nr=Te?Wn[1]:i,Jn=Me?Wn[2]:i,_s=U?Wn[3]:i,ir=ce?Wn[4]:i,br=oe?Wn[5]:i,rr=ve?Y[0].params.length:-1,ws=Te?Y[1].params.length:-1,bs=Me?Y[2].params.length:-1,I=U?Y[3].params.length:-1,le=ce?Y[4].params.length:-1,ne=oe?Y[5].params.length:-1,me=Ue?6:0,De=Y.length,ot=function(){for(var Ye=me;Ye<De;Ye++)if(q[Ye](arguments))return Wn[Ye].apply(this,arguments);return h.onMismatch(D,arguments,Y)},Je=function Ge(Ye,dt){return arguments.length===rr&&Pe(Ye)&&en(dt)?wr.apply(Ge,arguments):arguments.length===ws&&ct(Ye)&&rn(dt)?nr.apply(Ge,arguments):arguments.length===bs&&pt(Ye)&&hn(dt)?Jn.apply(Ge,arguments):arguments.length===I&&Nt(Ye)&&tr(dt)?_s.apply(Ge,arguments):arguments.length===le&&ft(Ye)&&$n(dt)?ir.apply(Ge,arguments):arguments.length===ne&&_t(Ye)&&fn(dt)?br.apply(Ge,arguments):ot.apply(Ge,arguments)};try{Object.defineProperty(Je,"name",{value:D})}catch{}return Je.signatures=Ne(Y),Je}function Ee(D,X,J){throw se(D,X,J)}function Oe(D){return h.ignore.indexOf(D)===-1}function re(D){return D.trim()}function ze(D){return!!D}function je(D){return D!==null}function Ie(D){return D.types.length===0}function Be(D){return D.slice(0,D.length-1)}function Xe(D){return D[D.length-1]}function fe(D,X,J){return Array.prototype.slice.call(D,X,J)}function ge(D,X){return D.indexOf(X)!==-1}function Ae(D,X){for(var J=0;J<D.length;J++)if(ge(X,D[J]))return!0;return!1}function ke(D,X){for(var J=0;J<D.length;J++)if(X(D[J]))return D[J]}function pe(D){for(var X={},J=0;J<D.length;J++)X[D[J]]=!0;return Object.keys(X)}function O(D,X){return Array.prototype.concat.apply([],D.map(X))}function F(D){for(var X="",J=0;J<D.length;J++){var Y=D[J];if((typeof Y.signatures=="object"||typeof Y.signature=="string")&&Y.name!==""){if(X==="")X=Y.name;else if(X!==Y.name){var ve=new Error("Function names do not match (expected: "+X+", actual: "+Y.name+")");throw ve.data={actual:Y.name,expected:X},ve}}}return X}function ye(D){var X,J={};function Y(U,ce){if(J.hasOwnProperty(U)&&ce!==J[U])throw X=new Error('Signature "'+U+'" is defined twice'),X.data={signature:U},X}for(var ve=0;ve<D.length;ve++){var Te=D[ve];if(typeof Te.signatures=="object")for(var Me in Te.signatures)Te.signatures.hasOwnProperty(Me)&&(Y(Me,Te.signatures[Me]),J[Me]=Te.signatures[Me]);else if(typeof Te.signature=="string")Y(Te.signature,Te),J[Te.signature]=Te;else throw X=new TypeError("Function is no typed-function (index: "+ve+")"),X.data={index:ve},X}return J}return h=ue("typed",{"string, Object":ue,Object:function(D){var X=[];for(var J in D)D.hasOwnProperty(J)&&X.push(D[J]);var Y=F(X);return ue(Y,D)},"...Function":function(D){return ue(F(D),ye(D))},"string, ...Function":function(D,X){return ue(D,ye(X))}}),h.create=s,h.types=a,h.conversions=f,h.ignore=u,h.onMismatch=Ee,h.throwMismatchError=Ee,h.createError=se,h.convert=v,h.find=x,h.addType=function(D,X){if(!D||typeof D.name!="string"||typeof D.test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");if(X!==!1){for(var J=0;J<h.types.length;J++)if(h.types[J].name==="Object"){h.types.splice(J,0,D);return}}h.types.push(D)},h.addConversion=function(D){if(!D||typeof D.from!="string"||typeof D.to!="string"||typeof D.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");h.conversions.push(D)},h}return s()})})(rf);var ou=rf.exports;function on(r){return typeof r=="boolean"?!0:isFinite(r)?r===Math.round(r):!1}function Jo(r,e,t){var n={2:"0b",8:"0o",16:"0x"},i=n[e],s="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!on(t))throw new Error("size must be an integer");if(r>2**(t-1)-1||r<-(2**(t-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!on(r))throw new Error("Value must be an integer");r<0&&(r=r+2**t),s="i".concat(t)}var a="";return r<0&&(r=-r,a="-"),"".concat(a).concat(i).concat(r.toString(e)).concat(s)}function Wl(r,e){if(typeof e=="function")return e(r);if(r===1/0)return"Infinity";if(r===-1/0)return"-Infinity";if(isNaN(r))return"NaN";var t="auto",n,i;if(e&&(e.notation&&(t=e.notation),Vt(e)?n=e:Vt(e.precision)&&(n=e.precision),e.wordSize&&(i=e.wordSize,typeof i!="number")))throw new Error('Option "wordSize" must be a number');switch(t){case"fixed":return Jp(r,n);case"exponential":return sf(r,n);case"engineering":return $p(r,n);case"bin":return Jo(r,2,i);case"oct":return Jo(r,8,i);case"hex":return Jo(r,16,i);case"auto":return Qp(r,n,e&&e).replace(/((\.\d*?)(0+))($|e)/,function(){var s=arguments[2],a=arguments[4];return s!=="."?s+a:a});default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function go(r){var e=String(r).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+r);var t=e[1],n=e[2],i=parseFloat(e[4]||"0"),s=n.indexOf(".");i+=s!==-1?s-1:n.length-1;var a=n.replace(".","").replace(/^0*/,function(o){return i-=o.length,""}).replace(/0*$/,"").split("").map(function(o){return parseInt(o)});return a.length===0&&(a.push(0),i++),{sign:t,coefficients:a,exponent:i}}function $p(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=go(r),n=vo(t,e),i=n.exponent,s=n.coefficients,a=i%3===0?i:i<0?i-3-i%3:i-i%3;if(Vt(e))for(;e>s.length||i-a+1>s.length;)s.push(0);else for(var o=Math.abs(i-a)-(s.length-1),u=0;u<o;u++)s.push(0);for(var f=Math.abs(i-a),h=1;f>0;)h++,f--;var c=s.slice(h).join(""),d=Vt(e)&&c.length||c.match(/[1-9]/)?"."+c:"",g=s.slice(0,h).join("")+d+"e"+(i>=0?"+":"")+a.toString();return n.sign+g}function Jp(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=go(r),n=typeof e=="number"?vo(t,t.exponent+1+e):t,i=n.coefficients,s=n.exponent+1,a=s+(e||0);return i.length<a&&(i=i.concat(Kr(a-i.length))),s<0&&(i=Kr(-s+1).concat(i),s=1),s<i.length&&i.splice(s,0,s===0?"0.":"."),n.sign+i.join("")}function sf(r,e){if(isNaN(r)||!isFinite(r))return String(r);var t=go(r),n=e?vo(t,e):t,i=n.coefficients,s=n.exponent;i.length<e&&(i=i.concat(Kr(e-i.length)));var a=i.shift();return n.sign+a+(i.length>0?"."+i.join(""):"")+"e"+(s>=0?"+":"")+s}function Qp(r,e,t){if(isNaN(r)||!isFinite(r))return String(r);var n=t&&t.lowerExp!==void 0?t.lowerExp:-3,i=t&&t.upperExp!==void 0?t.upperExp:5,s=go(r),a=e?vo(s,e):s;if(a.exponent<n||a.exponent>=i)return sf(r,e);var o=a.coefficients,u=a.exponent;o.length<e&&(o=o.concat(Kr(e-o.length))),o=o.concat(Kr(u-o.length+1+(o.length<e?e-o.length:0))),o=Kr(-u).concat(o);var f=u>0?u:0;return f<o.length-1&&o.splice(f+1,0,"."),a.sign+o.join("")}function vo(r,e){for(var t={sign:r.sign,coefficients:r.coefficients,exponent:r.exponent},n=t.coefficients;e<=0;)n.unshift(0),t.exponent++,e++;if(n.length>e){var i=n.splice(e,n.length-e);if(i[0]>=5){var s=e-1;for(n[s]++;n[s]===10;)n.pop(),s===0&&(n.unshift(0),t.exponent++,s++),s--,n[s]++}}return t}function Kr(r){for(var e=[],t=0;t<r;t++)e.push(0);return e}function Kp(r){return r.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var em=Number.EPSILON||2220446049250313e-31;function Qa(r,e,t){if(t==null)return r===e;if(r===e)return!0;if(isNaN(r)||isNaN(e))return!1;if(isFinite(r)&&isFinite(e)){var n=Math.abs(r-e);return n<em?!0:n<=Math.max(Math.abs(r),Math.abs(e))*t}return!1}function Qo(r,e,t){var n=r.constructor,i=new n(2),s="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!on(t))throw new Error("size must be an integer");if(r.greaterThan(i.pow(t-1).sub(1))||r.lessThan(i.pow(t-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!r.isInteger())throw new Error("Value must be an integer");r.lessThan(0)&&(r=r.add(i.pow(t))),s="i".concat(t)}switch(e){case 2:return"".concat(r.toBinary()).concat(s);case 8:return"".concat(r.toOctal()).concat(s);case 16:return"".concat(r.toHexadecimal()).concat(s);default:throw new Error("Base ".concat(e," not supported "))}}function tm(r,e){if(typeof e=="function")return e(r);if(!r.isFinite())return r.isNaN()?"NaN":r.gt(0)?"Infinity":"-Infinity";var t="auto",n,i;if(e!==void 0&&(e.notation&&(t=e.notation),typeof e=="number"?n=e:e.precision&&(n=e.precision),e.wordSize&&(i=e.wordSize,typeof i!="number")))throw new Error('Option "wordSize" must be a number');switch(t){case"fixed":return im(r,n);case"exponential":return lu(r,n);case"engineering":return nm(r,n);case"bin":return Qo(r,2,i);case"oct":return Qo(r,8,i);case"hex":return Qo(r,16,i);case"auto":{var s=e&&e.lowerExp!==void 0?e.lowerExp:-3,a=e&&e.upperExp!==void 0?e.upperExp:5;if(r.isZero())return"0";var o,u=r.toSignificantDigits(n),f=u.e;return f>=s&&f<a?o=u.toFixed():o=lu(r,n),o.replace(/((\.\d*?)(0+))($|e)/,function(){var h=arguments[2],c=arguments[4];return h!=="."?h+c:c})}default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function nm(r,e){var t=r.e,n=t%3===0?t:t<0?t-3-t%3:t-t%3,i=r.mul(Math.pow(10,-n)),s=i.toPrecision(e);return s.indexOf("e")!==-1&&(s=i.toString()),s+"e"+(t>=0?"+":"")+n.toString()}function lu(r,e){return e!==void 0?r.toExponential(e-1):r.toExponential()}function im(r,e){return r.toFixed(e)}function Ln(r,e){var t=rm(r,e);return e&&typeof e=="object"&&"truncate"in e&&t.length>e.truncate?t.substring(0,e.truncate-3)+"...":t}function rm(r,e){if(typeof r=="number")return Wl(r,e);if(ai(r))return tm(r,e);if(sm(r))return!e||e.fraction!=="decimal"?r.s*r.n+"/"+r.d:r.toString();if(Array.isArray(r))return af(r,e);if(Ci(r))return'"'+r+'"';if(typeof r=="function")return r.syntax?String(r.syntax):"function";if(r&&typeof r=="object"){if(typeof r.format=="function")return r.format(e);if(r&&r.toString(e)!=={}.toString())return r.toString(e);var t=Object.keys(r).map(n=>'"'+n+'": '+Ln(r[n],e));return"{"+t.join(", ")+"}"}return String(r)}function af(r,e){if(Array.isArray(r)){for(var t="[",n=r.length,i=0;i<n;i++)i!==0&&(t+=", "),t+=af(r[i],e);return t+="]",t}else return Ln(r,e)}function sm(r){return r&&typeof r=="object"&&typeof r.s=="number"&&typeof r.n=="number"&&typeof r.d=="number"||!1}function Ut(r,e,t){if(!(this instanceof Ut))throw new SyntaxError("Constructor must be called with the new operator");this.actual=r,this.expected=e,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(r)?"["+r.join(", ")+"]":r)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=new Error().stack}Ut.prototype=new RangeError;Ut.prototype.constructor=RangeError;Ut.prototype.name="DimensionError";Ut.prototype.isDimensionError=!0;function cs(r,e,t){if(!(this instanceof cs))throw new SyntaxError("Constructor must be called with the new operator");this.index=r,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=t),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}cs.prototype=new RangeError;cs.prototype.constructor=RangeError;cs.prototype.name="IndexError";cs.prototype.isIndexError=!0;function yr(r){for(var e=[];Array.isArray(r);)e.push(r.length),r=r[0];return e}function of(r,e,t){var n,i=r.length;if(i!==e[t])throw new Ut(i,e[t]);if(t<e.length-1){var s=t+1;for(n=0;n<i;n++){var a=r[n];if(!Array.isArray(a))throw new Ut(e.length-1,e.length,"<");of(r[n],e,s)}}else for(n=0;n<i;n++)if(Array.isArray(r[n]))throw new Ut(e.length+1,e.length,">")}function cu(r,e){var t=e.length===0;if(t){if(Array.isArray(r))throw new Ut(r.length,0)}else of(r,e,0)}function zt(r,e){if(!Vt(r)||!on(r))throw new TypeError("Index must be an integer (value: "+r+")");if(r<0||typeof e=="number"&&r>=e)throw new cs(r,e)}function uu(r,e,t){if(!Array.isArray(r)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Error("Resizing to scalar is not supported");e.forEach(function(i){if(!Vt(i)||!on(i)||i<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ln(e)+")")});var n=t!==void 0?t:0;return ql(r,e,0,n),r}function ql(r,e,t,n){var i,s,a=r.length,o=e[t],u=Math.min(a,o);if(r.length=o,t<e.length-1){var f=t+1;for(i=0;i<u;i++)s=r[i],Array.isArray(s)||(s=[s],r[i]=s),ql(s,e,f,n);for(i=u;i<o;i++)s=[],r[i]=s,ql(s,e,f,n)}else{for(i=0;i<u;i++)for(;Array.isArray(r[i]);)r[i]=r[i][0];for(i=u;i<o;i++)r[i]=n}}function am(r,e){var t=lm(r),n=t.length;if(!Array.isArray(r)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Ut(0,n,"!=");e=dc(e,n);var i=lf(e);if(n!==i)throw new Ut(i,n,"!=");try{return om(t,e)}catch(s){throw s instanceof Ut?new Ut(i,n,"!="):s}}function dc(r,e){var t=lf(r),n=r.slice(),i=-1,s=r.indexOf(i),a=r.indexOf(i,s+1)>=0;if(a)throw new Error("More than one wildcard in sizes");var o=s>=0,u=e%t===0;if(o)if(u)n[s]=-e/t;else throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-t);return n}function lf(r){return r.reduce((e,t)=>e*t,1)}function om(r,e){for(var t=r,n,i=e.length-1;i>0;i--){var s=e[i];n=[];for(var a=t.length/s,o=0;o<a;o++)n.push(t.slice(o*s,(o+1)*s));t=n}return t}function cf(r,e,t,n){var i=n||yr(r);if(t)for(var s=0;s<t;s++)r=[r],i.unshift(1);for(r=uf(r,e,0);i.length<e;)i.push(1);return r}function uf(r,e,t){var n,i;if(Array.isArray(r)){var s=t+1;for(n=0,i=r.length;n<i;n++)r[n]=uf(r[n],e,s)}else for(var a=t;a<e;a++)r=[r];return r}function lm(r){if(!Array.isArray(r))return r;var e=[];return r.forEach(function t(n){Array.isArray(n)?n.forEach(t):e.push(n)}),e}function Ka(r,e){for(var t,n=0,i=0;i<r.length;i++){var s=r[i],a=Array.isArray(s);if(i===0&&a&&(n=s.length),a&&s.length!==n)return;var o=a?Ka(s,e):e(s);if(t===void 0)t=o;else if(t!==o)return"mixed"}return t}function Ht(r,e,t,n){function i(s){var a=Xp(s,e.map(hm));return cm(r,e,s),t(a)}return i.isFactory=!0,i.fn=r,i.dependencies=e.slice().sort(),n&&(i.meta=n),i}function cm(r,e,t){var n=e.filter(s=>!um(s)).every(s=>t[s]!==void 0);if(!n){var i=e.filter(s=>t[s]===void 0);throw new Error('Cannot create function "'.concat(r,'", ')+"some dependencies are missing: ".concat(i.map(s=>'"'.concat(s,'"')).join(", "),"."))}}function um(r){return r&&r[0]==="?"}function hm(r){return r&&r[0]==="?"?r.slice(1):r}function fm(r,e){if(ff(r)&&hf(r,e))return r[e];throw typeof r[e]=="function"&&mm(r,e)?new Error('Cannot access method "'+e+'" as a property'):new Error('No access to property "'+e+'"')}function dm(r,e,t){if(ff(r)&&hf(r,e))return r[e]=t,t;throw new Error('No access to property "'+e+'"')}function pm(r,e){return e in r}function hf(r,e){return!r||typeof r!="object"?!1:Ys(gm,e)?!0:!(e in Object.prototype||e in Function.prototype)}function mm(r,e){return r==null||typeof r[e]!="function"||Ys(r,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(r)?!1:Ys(vm,e)?!0:!(e in Object.prototype||e in Function.prototype)}function ff(r){return typeof r=="object"&&r&&r.constructor===Object}var gm={length:!0,name:!0},vm={toString:!0,valueOf:!0,toLocaleString:!0};class ym{constructor(e){this.wrappedObject=e}keys(){return Object.keys(this.wrappedObject)}get(e){return fm(this.wrappedObject,e)}set(e,t){return dm(this.wrappedObject,e,t),this}has(e){return pm(this.wrappedObject,e)}}function xm(r){return r?r instanceof Map||r instanceof ym||typeof r.set=="function"&&typeof r.get=="function"&&typeof r.keys=="function"&&typeof r.has=="function":!1}var df=function(){return df=ou.create,ou},_m=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],wm=Ht("typed",_m,function(e){var{BigNumber:t,Complex:n,DenseMatrix:i,Fraction:s}=e,a=df();return a.types=[{name:"number",test:Vt},{name:"Complex",test:uc},{name:"BigNumber",test:ai},{name:"Fraction",test:hc},{name:"Unit",test:fc},{name:"string",test:Ci},{name:"Chain",test:nf},{name:"Array",test:Ot},{name:"Matrix",test:_n},{name:"DenseMatrix",test:bp},{name:"SparseMatrix",test:Mp},{name:"Range",test:Qh},{name:"Index",test:mo},{name:"boolean",test:Sp},{name:"ResultSet",test:Kh},{name:"Help",test:ef},{name:"function",test:Ep},{name:"Date",test:Tp},{name:"RegExp",test:Ap},{name:"null",test:Lp},{name:"undefined",test:Rp},{name:"AccessorNode",test:Pp},{name:"ArrayNode",test:Np},{name:"AssignmentNode",test:Dp},{name:"BlockNode",test:Ip},{name:"ConditionalNode",test:Fp},{name:"ConstantNode",test:Bp},{name:"FunctionNode",test:zp},{name:"FunctionAssignmentNode",test:Op},{name:"IndexNode",test:Up},{name:"Node",test:tf},{name:"ObjectNode",test:kp},{name:"OperatorNode",test:Hp},{name:"ParenthesisNode",test:Vp},{name:"RangeNode",test:Gp},{name:"SymbolNode",test:Wp},{name:"Map",test:xm},{name:"Object",test:Cp}],a.conversions=[{from:"number",to:"BigNumber",convert:function(u){if(t||Ko(u),Kp(u)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+u+"). Use function bignumber(x) to convert to BigNumber.");return new t(u)}},{from:"number",to:"Complex",convert:function(u){return n||ga(u),new n(u,0)}},{from:"number",to:"string",convert:function(u){return u+""}},{from:"BigNumber",to:"Complex",convert:function(u){return n||ga(u),new n(u.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(u){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(u){return n||ga(u),new n(u.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(u){s||el(u);var f=new s(u);if(f.valueOf()!==u)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+u+"). Use function fraction(x) to convert to Fraction.");return f}},{from:"string",to:"number",convert:function(u){var f=Number(u);if(isNaN(f))throw new Error('Cannot convert "'+u+'" to a number');return f}},{from:"string",to:"BigNumber",convert:function(u){t||Ko(u);try{return new t(u)}catch{throw new Error('Cannot convert "'+u+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(u){s||el(u);try{return new s(u)}catch{throw new Error('Cannot convert "'+u+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(u){n||ga(u);try{return new n(u)}catch{throw new Error('Cannot convert "'+u+'" to Complex')}}},{from:"boolean",to:"number",convert:function(u){return+u}},{from:"boolean",to:"BigNumber",convert:function(u){return t||Ko(u),new t(+u)}},{from:"boolean",to:"Fraction",convert:function(u){return s||el(u),new s(+u)}},{from:"boolean",to:"string",convert:function(u){return String(u)}},{from:"Array",to:"Matrix",convert:function(u){return i||bm(),new i(u)}},{from:"Matrix",to:"Array",convert:function(u){return u.valueOf()}}],a});function Ko(r){throw new Error("Cannot convert value ".concat(r," into a BigNumber: no class 'BigNumber' provided"))}function ga(r){throw new Error("Cannot convert value ".concat(r," into a Complex number: no class 'Complex' provided"))}function bm(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function el(r){throw new Error("Cannot convert value ".concat(r," into a Fraction, no class 'Fraction' provided."))}var Yr=9e15,Qi=1e9,jl="0123456789abcdef",eo="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",to="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Xl={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Yr,maxE:Yr,crypto:!1},pf,Ri,lt=!0,yo="[DecimalError] ",Zi=yo+"Invalid argument: ",mf=yo+"Precision limit exceeded",gf=yo+"crypto unavailable",vf="[object Decimal]",gn=Math.floor,Qt=Math.pow,Mm=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Sm=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Em=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,yf=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,li=1e7,it=7,Tm=9007199254740991,Am=eo.length-1,Yl=to.length-1,Ce={toStringTag:vf};Ce.absoluteValue=Ce.abs=function(){var r=new this.constructor(this);return r.s<0&&(r.s=1),Qe(r)};Ce.ceil=function(){return Qe(new this.constructor(this),this.e+1,2)};Ce.clampedTo=Ce.clamp=function(r,e){var t,n=this,i=n.constructor;if(r=new i(r),e=new i(e),!r.s||!e.s)return new i(NaN);if(r.gt(e))throw Error(Zi+e);return t=n.cmp(r),t<0?r:n.cmp(e)>0?e:new i(n)};Ce.comparedTo=Ce.cmp=function(r){var e,t,n,i,s=this,a=s.d,o=(r=new s.constructor(r)).d,u=s.s,f=r.s;if(!a||!o)return!u||!f?NaN:u!==f?u:a===o?0:!a^u<0?1:-1;if(!a[0]||!o[0])return a[0]?u:o[0]?-f:0;if(u!==f)return u;if(s.e!==r.e)return s.e>r.e^u<0?1:-1;for(n=a.length,i=o.length,e=0,t=n<i?n:i;e<t;++e)if(a[e]!==o[e])return a[e]>o[e]^u<0?1:-1;return n===i?0:n>i^u<0?1:-1};Ce.cosine=Ce.cos=function(){var r,e,t=this,n=t.constructor;return t.d?t.d[0]?(r=n.precision,e=n.rounding,n.precision=r+Math.max(t.e,t.sd())+it,n.rounding=1,t=Cm(n,Mf(n,t)),n.precision=r,n.rounding=e,Qe(Ri==2||Ri==3?t.neg():t,r,e,!0)):new n(1):new n(NaN)};Ce.cubeRoot=Ce.cbrt=function(){var r,e,t,n,i,s,a,o,u,f,h=this,c=h.constructor;if(!h.isFinite()||h.isZero())return new c(h);for(lt=!1,s=h.s*Qt(h.s*h,1/3),!s||Math.abs(s)==1/0?(t=ln(h.d),r=h.e,(s=(r-t.length+1)%3)&&(t+=s==1||s==-2?"0":"00"),s=Qt(t,1/3),r=gn((r+1)/3)-(r%3==(r<0?-1:2)),s==1/0?t="5e"+r:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+r),n=new c(t),n.s=h.s):n=new c(s.toString()),a=(r=c.precision)+3;;)if(o=n,u=o.times(o).times(o),f=u.plus(h),n=Lt(f.plus(h).times(o),f.plus(u),a+2,1),ln(o.d).slice(0,a)===(t=ln(n.d)).slice(0,a))if(t=t.slice(a-3,a+1),t=="9999"||!i&&t=="4999"){if(!i&&(Qe(o,r+1,0),o.times(o).times(o).eq(h))){n=o;break}a+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(Qe(n,r+1,1),e=!n.times(n).times(n).eq(h));break}return lt=!0,Qe(n,r,c.rounding,e)};Ce.decimalPlaces=Ce.dp=function(){var r,e=this.d,t=NaN;if(e){if(r=e.length-1,t=(r-gn(this.e/it))*it,r=e[r],r)for(;r%10==0;r/=10)t--;t<0&&(t=0)}return t};Ce.dividedBy=Ce.div=function(r){return Lt(this,new this.constructor(r))};Ce.dividedToIntegerBy=Ce.divToInt=function(r){var e=this,t=e.constructor;return Qe(Lt(e,new t(r),0,1,1),t.precision,t.rounding)};Ce.equals=Ce.eq=function(r){return this.cmp(r)===0};Ce.floor=function(){return Qe(new this.constructor(this),this.e+1,3)};Ce.greaterThan=Ce.gt=function(r){return this.cmp(r)>0};Ce.greaterThanOrEqualTo=Ce.gte=function(r){var e=this.cmp(r);return e==1||e===0};Ce.hyperbolicCosine=Ce.cosh=function(){var r,e,t,n,i,s=this,a=s.constructor,o=new a(1);if(!s.isFinite())return new a(s.s?1/0:NaN);if(s.isZero())return o;t=a.precision,n=a.rounding,a.precision=t+Math.max(s.e,s.sd())+4,a.rounding=1,i=s.d.length,i<32?(r=Math.ceil(i/3),e=(1/_o(4,r)).toString()):(r=16,e="2.3283064365386962890625e-10"),s=is(a,1,s.times(e),new a(1),!0);for(var u,f=r,h=new a(8);f--;)u=s.times(s),s=o.minus(u.times(h.minus(u.times(h))));return Qe(s,a.precision=t,a.rounding=n,!0)};Ce.hyperbolicSine=Ce.sinh=function(){var r,e,t,n,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(e=s.precision,t=s.rounding,s.precision=e+Math.max(i.e,i.sd())+4,s.rounding=1,n=i.d.length,n<3)i=is(s,2,i,i,!0);else{r=1.4*Math.sqrt(n),r=r>16?16:r|0,i=i.times(1/_o(5,r)),i=is(s,2,i,i,!0);for(var a,o=new s(5),u=new s(16),f=new s(20);r--;)a=i.times(i),i=i.times(o.plus(a.times(u.times(a).plus(f))))}return s.precision=e,s.rounding=t,Qe(i,e,t,!0)};Ce.hyperbolicTangent=Ce.tanh=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+7,n.rounding=1,Lt(t.sinh(),t.cosh(),n.precision=r,n.rounding=e)):new n(t.s)};Ce.inverseCosine=Ce.acos=function(){var r,e=this,t=e.constructor,n=e.abs().cmp(1),i=t.precision,s=t.rounding;return n!==-1?n===0?e.isNeg()?oi(t,i,s):new t(0):new t(NaN):e.isZero()?oi(t,i+4,s).times(.5):(t.precision=i+6,t.rounding=1,e=e.asin(),r=oi(t,i+4,s).times(.5),t.precision=i,t.rounding=s,r.minus(e))};Ce.inverseHyperbolicCosine=Ce.acosh=function(){var r,e,t=this,n=t.constructor;return t.lte(1)?new n(t.eq(1)?0:NaN):t.isFinite()?(r=n.precision,e=n.rounding,n.precision=r+Math.max(Math.abs(t.e),t.sd())+4,n.rounding=1,lt=!1,t=t.times(t).minus(1).sqrt().plus(t),lt=!0,n.precision=r,n.rounding=e,t.ln()):new n(t)};Ce.inverseHyperbolicSine=Ce.asinh=function(){var r,e,t=this,n=t.constructor;return!t.isFinite()||t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+2*Math.max(Math.abs(t.e),t.sd())+6,n.rounding=1,lt=!1,t=t.times(t).plus(1).sqrt().plus(t),lt=!0,n.precision=r,n.rounding=e,t.ln())};Ce.inverseHyperbolicTangent=Ce.atanh=function(){var r,e,t,n,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(r=s.precision,e=s.rounding,n=i.sd(),Math.max(n,r)<2*-i.e-1?Qe(new s(i),r,e,!0):(s.precision=t=n-i.e,i=Lt(i.plus(1),new s(1).minus(i),t+r,1),s.precision=r+4,s.rounding=1,i=i.ln(),s.precision=r,s.rounding=e,i.times(.5))):new s(NaN)};Ce.inverseSine=Ce.asin=function(){var r,e,t,n,i=this,s=i.constructor;return i.isZero()?new s(i):(e=i.abs().cmp(1),t=s.precision,n=s.rounding,e!==-1?e===0?(r=oi(s,t+4,n).times(.5),r.s=i.s,r):new s(NaN):(s.precision=t+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=t,s.rounding=n,i.times(2)))};Ce.inverseTangent=Ce.atan=function(){var r,e,t,n,i,s,a,o,u,f=this,h=f.constructor,c=h.precision,d=h.rounding;if(f.isFinite()){if(f.isZero())return new h(f);if(f.abs().eq(1)&&c+4<=Yl)return a=oi(h,c+4,d).times(.25),a.s=f.s,a}else{if(!f.s)return new h(NaN);if(c+4<=Yl)return a=oi(h,c+4,d).times(.5),a.s=f.s,a}for(h.precision=o=c+10,h.rounding=1,t=Math.min(28,o/it+2|0),r=t;r;--r)f=f.div(f.times(f).plus(1).sqrt().plus(1));for(lt=!1,e=Math.ceil(o/it),n=1,u=f.times(f),a=new h(f),i=f;r!==-1;)if(i=i.times(u),s=a.minus(i.div(n+=2)),i=i.times(u),a=s.plus(i.div(n+=2)),a.d[e]!==void 0)for(r=e;a.d[r]===s.d[r]&&r--;);return t&&(a=a.times(2<<t-1)),lt=!0,Qe(a,h.precision=c,h.rounding=d,!0)};Ce.isFinite=function(){return!!this.d};Ce.isInteger=Ce.isInt=function(){return!!this.d&&gn(this.e/it)>this.d.length-2};Ce.isNaN=function(){return!this.s};Ce.isNegative=Ce.isNeg=function(){return this.s<0};Ce.isPositive=Ce.isPos=function(){return this.s>0};Ce.isZero=function(){return!!this.d&&this.d[0]===0};Ce.lessThan=Ce.lt=function(r){return this.cmp(r)<0};Ce.lessThanOrEqualTo=Ce.lte=function(r){return this.cmp(r)<1};Ce.logarithm=Ce.log=function(r){var e,t,n,i,s,a,o,u,f=this,h=f.constructor,c=h.precision,d=h.rounding,g=5;if(r==null)r=new h(10),e=!0;else{if(r=new h(r),t=r.d,r.s<0||!t||!t[0]||r.eq(1))return new h(NaN);e=r.eq(10)}if(t=f.d,f.s<0||!t||!t[0]||f.eq(1))return new h(t&&!t[0]?-1/0:f.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)s=!0;else{for(i=t[0];i%10===0;)i/=10;s=i!==1}if(lt=!1,o=c+g,a=Gi(f,o),n=e?no(h,o+10):Gi(r,o),u=Lt(a,n,o,1),Zs(u.d,i=c,d))do if(o+=10,a=Gi(f,o),n=e?no(h,o+10):Gi(r,o),u=Lt(a,n,o,1),!s){+ln(u.d).slice(i+1,i+15)+1==1e14&&(u=Qe(u,c+1,0));break}while(Zs(u.d,i+=10,d));return lt=!0,Qe(u,c,d)};Ce.minus=Ce.sub=function(r){var e,t,n,i,s,a,o,u,f,h,c,d,g=this,x=g.constructor;if(r=new x(r),!g.d||!r.d)return!g.s||!r.s?r=new x(NaN):g.d?r.s=-r.s:r=new x(r.d||g.s!==r.s?g:NaN),r;if(g.s!=r.s)return r.s=-r.s,g.plus(r);if(f=g.d,d=r.d,o=x.precision,u=x.rounding,!f[0]||!d[0]){if(d[0])r.s=-r.s;else if(f[0])r=new x(g);else return new x(u===3?-0:0);return lt?Qe(r,o,u):r}if(t=gn(r.e/it),h=gn(g.e/it),f=f.slice(),s=h-t,s){for(c=s<0,c?(e=f,s=-s,a=d.length):(e=d,t=h,a=f.length),n=Math.max(Math.ceil(o/it),a)+2,s>n&&(s=n,e.length=1),e.reverse(),n=s;n--;)e.push(0);e.reverse()}else{for(n=f.length,a=d.length,c=n<a,c&&(a=n),n=0;n<a;n++)if(f[n]!=d[n]){c=f[n]<d[n];break}s=0}for(c&&(e=f,f=d,d=e,r.s=-r.s),a=f.length,n=d.length-a;n>0;--n)f[a++]=0;for(n=d.length;n>s;){if(f[--n]<d[n]){for(i=n;i&&f[--i]===0;)f[i]=li-1;--f[i],f[n]+=li}f[n]-=d[n]}for(;f[--a]===0;)f.pop();for(;f[0]===0;f.shift())--t;return f[0]?(r.d=f,r.e=xo(f,t),lt?Qe(r,o,u):r):new x(u===3?-0:0)};Ce.modulo=Ce.mod=function(r){var e,t=this,n=t.constructor;return r=new n(r),!t.d||!r.s||r.d&&!r.d[0]?new n(NaN):!r.d||t.d&&!t.d[0]?Qe(new n(t),n.precision,n.rounding):(lt=!1,n.modulo==9?(e=Lt(t,r.abs(),0,3,1),e.s*=r.s):e=Lt(t,r,0,n.modulo,1),e=e.times(r),lt=!0,t.minus(e))};Ce.naturalExponential=Ce.exp=function(){return Zl(this)};Ce.naturalLogarithm=Ce.ln=function(){return Gi(this)};Ce.negated=Ce.neg=function(){var r=new this.constructor(this);return r.s=-r.s,Qe(r)};Ce.plus=Ce.add=function(r){var e,t,n,i,s,a,o,u,f,h,c=this,d=c.constructor;if(r=new d(r),!c.d||!r.d)return!c.s||!r.s?r=new d(NaN):c.d||(r=new d(r.d||c.s===r.s?c:NaN)),r;if(c.s!=r.s)return r.s=-r.s,c.minus(r);if(f=c.d,h=r.d,o=d.precision,u=d.rounding,!f[0]||!h[0])return h[0]||(r=new d(c)),lt?Qe(r,o,u):r;if(s=gn(c.e/it),n=gn(r.e/it),f=f.slice(),i=s-n,i){for(i<0?(t=f,i=-i,a=h.length):(t=h,n=s,a=f.length),s=Math.ceil(o/it),a=s>a?s+1:a+1,i>a&&(i=a,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(a=f.length,i=h.length,a-i<0&&(i=a,t=h,h=f,f=t),e=0;i;)e=(f[--i]=f[i]+h[i]+e)/li|0,f[i]%=li;for(e&&(f.unshift(e),++n),a=f.length;f[--a]==0;)f.pop();return r.d=f,r.e=xo(f,n),lt?Qe(r,o,u):r};Ce.precision=Ce.sd=function(r){var e,t=this;if(r!==void 0&&r!==!!r&&r!==1&&r!==0)throw Error(Zi+r);return t.d?(e=xf(t.d),r&&t.e+1>e&&(e=t.e+1)):e=NaN,e};Ce.round=function(){var r=this,e=r.constructor;return Qe(new e(r),r.e+1,e.rounding)};Ce.sine=Ce.sin=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+Math.max(t.e,t.sd())+it,n.rounding=1,t=Rm(n,Mf(n,t)),n.precision=r,n.rounding=e,Qe(Ri>2?t.neg():t,r,e,!0)):new n(NaN)};Ce.squareRoot=Ce.sqrt=function(){var r,e,t,n,i,s,a=this,o=a.d,u=a.e,f=a.s,h=a.constructor;if(f!==1||!o||!o[0])return new h(!f||f<0&&(!o||o[0])?NaN:o?a:1/0);for(lt=!1,f=Math.sqrt(+a),f==0||f==1/0?(e=ln(o),(e.length+u)%2==0&&(e+="0"),f=Math.sqrt(e),u=gn((u+1)/2)-(u<0||u%2),f==1/0?e="5e"+u:(e=f.toExponential(),e=e.slice(0,e.indexOf("e")+1)+u),n=new h(e)):n=new h(f.toString()),t=(u=h.precision)+3;;)if(s=n,n=s.plus(Lt(a,s,t+2,1)).times(.5),ln(s.d).slice(0,t)===(e=ln(n.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(Qe(s,u+1,0),s.times(s).eq(a))){n=s;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(Qe(n,u+1,1),r=!n.times(n).eq(a));break}return lt=!0,Qe(n,u,h.rounding,r)};Ce.tangent=Ce.tan=function(){var r,e,t=this,n=t.constructor;return t.isFinite()?t.isZero()?new n(t):(r=n.precision,e=n.rounding,n.precision=r+10,n.rounding=1,t=t.sin(),t.s=1,t=Lt(t,new n(1).minus(t.times(t)).sqrt(),r+10,0),n.precision=r,n.rounding=e,Qe(Ri==2||Ri==4?t.neg():t,r,e,!0)):new n(NaN)};Ce.times=Ce.mul=function(r){var e,t,n,i,s,a,o,u,f,h=this,c=h.constructor,d=h.d,g=(r=new c(r)).d;if(r.s*=h.s,!d||!d[0]||!g||!g[0])return new c(!r.s||d&&!d[0]&&!g||g&&!g[0]&&!d?NaN:!d||!g?r.s/0:r.s*0);for(t=gn(h.e/it)+gn(r.e/it),u=d.length,f=g.length,u<f&&(s=d,d=g,g=s,a=u,u=f,f=a),s=[],a=u+f,n=a;n--;)s.push(0);for(n=f;--n>=0;){for(e=0,i=u+n;i>n;)o=s[i]+g[n]*d[i-n-1]+e,s[i--]=o%li|0,e=o/li|0;s[i]=(s[i]+e)%li|0}for(;!s[--a];)s.pop();return e?++t:s.shift(),r.d=s,r.e=xo(s,t),lt?Qe(r,c.precision,c.rounding):r};Ce.toBinary=function(r,e){return pc(this,2,r,e)};Ce.toDecimalPlaces=Ce.toDP=function(r,e){var t=this,n=t.constructor;return t=new n(t),r===void 0?t:(Pn(r,0,Qi),e===void 0?e=n.rounding:Pn(e,0,8),Qe(t,r+t.e+1,e))};Ce.toExponential=function(r,e){var t,n=this,i=n.constructor;return r===void 0?t=gi(n,!0):(Pn(r,0,Qi),e===void 0?e=i.rounding:Pn(e,0,8),n=Qe(new i(n),r+1,e),t=gi(n,!0,r+1)),n.isNeg()&&!n.isZero()?"-"+t:t};Ce.toFixed=function(r,e){var t,n,i=this,s=i.constructor;return r===void 0?t=gi(i):(Pn(r,0,Qi),e===void 0?e=s.rounding:Pn(e,0,8),n=Qe(new s(i),r+i.e+1,e),t=gi(n,!1,r+n.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};Ce.toFraction=function(r){var e,t,n,i,s,a,o,u,f,h,c,d,g=this,x=g.d,v=g.constructor;if(!x)return new v(g);if(f=t=new v(1),n=u=new v(0),e=new v(n),s=e.e=xf(x)-g.e-1,a=s%it,e.d[0]=Qt(10,a<0?it+a:a),r==null)r=s>0?e:f;else{if(o=new v(r),!o.isInt()||o.lt(f))throw Error(Zi+o);r=o.gt(e)?s>0?e:f:o}for(lt=!1,o=new v(ln(x)),h=v.precision,v.precision=s=x.length*it*2;c=Lt(o,e,0,1,1),i=t.plus(c.times(n)),i.cmp(r)!=1;)t=n,n=i,i=f,f=u.plus(c.times(i)),u=i,i=e,e=o.minus(c.times(i)),o=i;return i=Lt(r.minus(t),n,0,1,1),u=u.plus(i.times(f)),t=t.plus(i.times(n)),u.s=f.s=g.s,d=Lt(f,n,s,1).minus(g).abs().cmp(Lt(u,t,s,1).minus(g).abs())<1?[f,n]:[u,t],v.precision=h,lt=!0,d};Ce.toHexadecimal=Ce.toHex=function(r,e){return pc(this,16,r,e)};Ce.toNearest=function(r,e){var t=this,n=t.constructor;if(t=new n(t),r==null){if(!t.d)return t;r=new n(1),e=n.rounding}else{if(r=new n(r),e===void 0?e=n.rounding:Pn(e,0,8),!t.d)return r.s?t:r;if(!r.d)return r.s&&(r.s=t.s),r}return r.d[0]?(lt=!1,t=Lt(t,r,0,e,1).times(r),lt=!0,Qe(t)):(r.s=t.s,t=r),t};Ce.toNumber=function(){return+this};Ce.toOctal=function(r,e){return pc(this,8,r,e)};Ce.toPower=Ce.pow=function(r){var e,t,n,i,s,a,o=this,u=o.constructor,f=+(r=new u(r));if(!o.d||!r.d||!o.d[0]||!r.d[0])return new u(Qt(+o,f));if(o=new u(o),o.eq(1))return o;if(n=u.precision,s=u.rounding,r.eq(1))return Qe(o,n,s);if(e=gn(r.e/it),e>=r.d.length-1&&(t=f<0?-f:f)<=Tm)return i=_f(u,o,t,n),r.s<0?new u(1).div(i):Qe(i,n,s);if(a=o.s,a<0){if(e<r.d.length-1)return new u(NaN);if((r.d[e]&1)==0&&(a=1),o.e==0&&o.d[0]==1&&o.d.length==1)return o.s=a,o}return t=Qt(+o,f),e=t==0||!isFinite(t)?gn(f*(Math.log("0."+ln(o.d))/Math.LN10+o.e+1)):new u(t+"").e,e>u.maxE+1||e<u.minE-1?new u(e>0?a/0:0):(lt=!1,u.rounding=o.s=1,t=Math.min(12,(e+"").length),i=Zl(r.times(Gi(o,n+t)),n),i.d&&(i=Qe(i,n+5,1),Zs(i.d,n,s)&&(e=n+10,i=Qe(Zl(r.times(Gi(o,e+t)),e),e+5,1),+ln(i.d).slice(n+1,n+15)+1==1e14&&(i=Qe(i,n+1,0)))),i.s=a,lt=!0,u.rounding=s,Qe(i,n,s))};Ce.toPrecision=function(r,e){var t,n=this,i=n.constructor;return r===void 0?t=gi(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(Pn(r,1,Qi),e===void 0?e=i.rounding:Pn(e,0,8),n=Qe(new i(n),r,e),t=gi(n,r<=n.e||n.e<=i.toExpNeg,r)),n.isNeg()&&!n.isZero()?"-"+t:t};Ce.toSignificantDigits=Ce.toSD=function(r,e){var t=this,n=t.constructor;return r===void 0?(r=n.precision,e=n.rounding):(Pn(r,1,Qi),e===void 0?e=n.rounding:Pn(e,0,8)),Qe(new n(t),r,e)};Ce.toString=function(){var r=this,e=r.constructor,t=gi(r,r.e<=e.toExpNeg||r.e>=e.toExpPos);return r.isNeg()&&!r.isZero()?"-"+t:t};Ce.truncated=Ce.trunc=function(){return Qe(new this.constructor(this),this.e+1,1)};Ce.valueOf=Ce.toJSON=function(){var r=this,e=r.constructor,t=gi(r,r.e<=e.toExpNeg||r.e>=e.toExpPos);return r.isNeg()?"-"+t:t};function ln(r){var e,t,n,i=r.length-1,s="",a=r[0];if(i>0){for(s+=a,e=1;e<i;e++)n=r[e]+"",t=it-n.length,t&&(s+=Hi(t)),s+=n;a=r[e],n=a+"",t=it-n.length,t&&(s+=Hi(t))}else if(a===0)return"0";for(;a%10===0;)a/=10;return s+a}function Pn(r,e,t){if(r!==~~r||r<e||r>t)throw Error(Zi+r)}function Zs(r,e,t,n){var i,s,a,o;for(s=r[0];s>=10;s/=10)--e;return--e<0?(e+=it,i=0):(i=Math.ceil((e+1)/it),e%=it),s=Qt(10,it-e),o=r[i]%s|0,n==null?e<3?(e==0?o=o/100|0:e==1&&(o=o/10|0),a=t<4&&o==99999||t>3&&o==49999||o==5e4||o==0):a=(t<4&&o+1==s||t>3&&o+1==s/2)&&(r[i+1]/s/100|0)==Qt(10,e-2)-1||(o==s/2||o==0)&&(r[i+1]/s/100|0)==0:e<4?(e==0?o=o/1e3|0:e==1?o=o/100|0:e==2&&(o=o/10|0),a=(n||t<4)&&o==9999||!n&&t>3&&o==4999):a=((n||t<4)&&o+1==s||!n&&t>3&&o+1==s/2)&&(r[i+1]/s/1e3|0)==Qt(10,e-3)-1,a}function Ya(r,e,t){for(var n,i=[0],s,a=0,o=r.length;a<o;){for(s=i.length;s--;)i[s]*=e;for(i[0]+=jl.indexOf(r.charAt(a++)),n=0;n<i.length;n++)i[n]>t-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/t|0,i[n]%=t)}return i.reverse()}function Cm(r,e){var t,n,i;if(e.isZero())return e;n=e.d.length,n<32?(t=Math.ceil(n/3),i=(1/_o(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),r.precision+=t,e=is(r,1,e.times(i),new r(1));for(var s=t;s--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return r.precision-=t,e}var Lt=function(){function r(n,i,s){var a,o=0,u=n.length;for(n=n.slice();u--;)a=n[u]*i+o,n[u]=a%s|0,o=a/s|0;return o&&n.unshift(o),n}function e(n,i,s,a){var o,u;if(s!=a)u=s>a?1:-1;else for(o=u=0;o<s;o++)if(n[o]!=i[o]){u=n[o]>i[o]?1:-1;break}return u}function t(n,i,s,a){for(var o=0;s--;)n[s]-=o,o=n[s]<i[s]?1:0,n[s]=o*a+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,a,o,u){var f,h,c,d,g,x,v,b,y,w,S,L,T,m,C,N,z,W,B,se,$=n.constructor,Q=n.s==i.s?1:-1,K=n.d,j=i.d;if(!K||!K[0]||!j||!j[0])return new $(!n.s||!i.s||(K?j&&K[0]==j[0]:!j)?NaN:K&&K[0]==0||!j?Q*0:Q/0);for(u?(g=1,h=n.e-i.e):(u=li,g=it,h=gn(n.e/g)-gn(i.e/g)),B=j.length,z=K.length,y=new $(Q),w=y.d=[],c=0;j[c]==(K[c]||0);c++);if(j[c]>(K[c]||0)&&h--,s==null?(m=s=$.precision,a=$.rounding):o?m=s+(n.e-i.e)+1:m=s,m<0)w.push(1),x=!0;else{if(m=m/g+2|0,c=0,B==1){for(d=0,j=j[0],m++;(c<z||d)&&m--;c++)C=d*u+(K[c]||0),w[c]=C/j|0,d=C%j|0;x=d||c<z}else{for(d=u/(j[0]+1)|0,d>1&&(j=r(j,d,u),K=r(K,d,u),B=j.length,z=K.length),N=B,S=K.slice(0,B),L=S.length;L<B;)S[L++]=0;se=j.slice(),se.unshift(0),W=j[0],j[1]>=u/2&&++W;do d=0,f=e(j,S,B,L),f<0?(T=S[0],B!=L&&(T=T*u+(S[1]||0)),d=T/W|0,d>1?(d>=u&&(d=u-1),v=r(j,d,u),b=v.length,L=S.length,f=e(v,S,b,L),f==1&&(d--,t(v,B<b?se:j,b,u))):(d==0&&(f=d=1),v=j.slice()),b=v.length,b<L&&v.unshift(0),t(S,v,L,u),f==-1&&(L=S.length,f=e(j,S,B,L),f<1&&(d++,t(S,B<L?se:j,L,u))),L=S.length):f===0&&(d++,S=[0]),w[c++]=d,f&&S[0]?S[L++]=K[N]||0:(S=[K[N]],L=1);while((N++<z||S[0]!==void 0)&&m--);x=S[0]!==void 0}w[0]||w.shift()}if(g==1)y.e=h,pf=x;else{for(c=1,d=w[0];d>=10;d/=10)c++;y.e=c+h*g-1,Qe(y,o?s+y.e+1:s,a,x)}return y}}();function Qe(r,e,t,n){var i,s,a,o,u,f,h,c,d,g=r.constructor;e:if(e!=null){if(c=r.d,!c)return r;for(i=1,o=c[0];o>=10;o/=10)i++;if(s=e-i,s<0)s+=it,a=e,h=c[d=0],u=h/Qt(10,i-a-1)%10|0;else if(d=Math.ceil((s+1)/it),o=c.length,d>=o)if(n){for(;o++<=d;)c.push(0);h=u=0,i=1,s%=it,a=s-it+1}else break e;else{for(h=o=c[d],i=1;o>=10;o/=10)i++;s%=it,a=s-it+i,u=a<0?0:h/Qt(10,i-a-1)%10|0}if(n=n||e<0||c[d+1]!==void 0||(a<0?h:h%Qt(10,i-a-1)),f=t<4?(u||n)&&(t==0||t==(r.s<0?3:2)):u>5||u==5&&(t==4||n||t==6&&(s>0?a>0?h/Qt(10,i-a):0:c[d-1])%10&1||t==(r.s<0?8:7)),e<1||!c[0])return c.length=0,f?(e-=r.e+1,c[0]=Qt(10,(it-e%it)%it),r.e=-e||0):c[0]=r.e=0,r;if(s==0?(c.length=d,o=1,d--):(c.length=d+1,o=Qt(10,it-s),c[d]=a>0?(h/Qt(10,i-a)%Qt(10,a)|0)*o:0),f)for(;;)if(d==0){for(s=1,a=c[0];a>=10;a/=10)s++;for(a=c[0]+=o,o=1;a>=10;a/=10)o++;s!=o&&(r.e++,c[0]==li&&(c[0]=1));break}else{if(c[d]+=o,c[d]!=li)break;c[d--]=0,o=1}for(s=c.length;c[--s]===0;)c.pop()}return lt&&(r.e>g.maxE?(r.d=null,r.e=NaN):r.e<g.minE&&(r.e=0,r.d=[0])),r}function gi(r,e,t){if(!r.isFinite())return bf(r);var n,i=r.e,s=ln(r.d),a=s.length;return e?(t&&(n=t-a)>0?s=s.charAt(0)+"."+s.slice(1)+Hi(n):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(r.e<0?"e":"e+")+r.e):i<0?(s="0."+Hi(-i-1)+s,t&&(n=t-a)>0&&(s+=Hi(n))):i>=a?(s+=Hi(i+1-a),t&&(n=t-i-1)>0&&(s=s+"."+Hi(n))):((n=i+1)<a&&(s=s.slice(0,n)+"."+s.slice(n)),t&&(n=t-a)>0&&(i+1===a&&(s+="."),s+=Hi(n))),s}function xo(r,e){var t=r[0];for(e*=it;t>=10;t/=10)e++;return e}function no(r,e,t){if(e>Am)throw lt=!0,t&&(r.precision=t),Error(mf);return Qe(new r(eo),e,1,!0)}function oi(r,e,t){if(e>Yl)throw Error(mf);return Qe(new r(to),e,t,!0)}function xf(r){var e=r.length-1,t=e*it+1;if(e=r[e],e){for(;e%10==0;e/=10)t--;for(e=r[0];e>=10;e/=10)t++}return t}function Hi(r){for(var e="";r--;)e+="0";return e}function _f(r,e,t,n){var i,s=new r(1),a=Math.ceil(n/it+4);for(lt=!1;;){if(t%2&&(s=s.times(e),fu(s.d,a)&&(i=!0)),t=gn(t/2),t===0){t=s.d.length-1,i&&s.d[t]===0&&++s.d[t];break}e=e.times(e),fu(e.d,a)}return lt=!0,s}function hu(r){return r.d[r.d.length-1]&1}function wf(r,e,t){for(var n,i=new r(e[0]),s=0;++s<e.length;)if(n=new r(e[s]),n.s)i[t](n)&&(i=n);else{i=n;break}return i}function Zl(r,e){var t,n,i,s,a,o,u,f=0,h=0,c=0,d=r.constructor,g=d.rounding,x=d.precision;if(!r.d||!r.d[0]||r.e>17)return new d(r.d?r.d[0]?r.s<0?0:1/0:1:r.s?r.s<0?0:r:0/0);for(e==null?(lt=!1,u=x):u=e,o=new d(.03125);r.e>-2;)r=r.times(o),c+=5;for(n=Math.log(Qt(2,c))/Math.LN10*2+5|0,u+=n,t=s=a=new d(1),d.precision=u;;){if(s=Qe(s.times(r),u,1),t=t.times(++h),o=a.plus(Lt(s,t,u,1)),ln(o.d).slice(0,u)===ln(a.d).slice(0,u)){for(i=c;i--;)a=Qe(a.times(a),u,1);if(e==null)if(f<3&&Zs(a.d,u-n,g,f))d.precision=u+=10,t=s=o=new d(1),h=0,f++;else return Qe(a,d.precision=x,g,lt=!0);else return d.precision=x,a}a=o}}function Gi(r,e){var t,n,i,s,a,o,u,f,h,c,d,g=1,x=10,v=r,b=v.d,y=v.constructor,w=y.rounding,S=y.precision;if(v.s<0||!b||!b[0]||!v.e&&b[0]==1&&b.length==1)return new y(b&&!b[0]?-1/0:v.s!=1?NaN:b?0:v);if(e==null?(lt=!1,h=S):h=e,y.precision=h+=x,t=ln(b),n=t.charAt(0),Math.abs(s=v.e)<15e14){for(;n<7&&n!=1||n==1&&t.charAt(1)>3;)v=v.times(r),t=ln(v.d),n=t.charAt(0),g++;s=v.e,n>1?(v=new y("0."+t),s++):v=new y(n+"."+t.slice(1))}else return f=no(y,h+2,S).times(s+""),v=Gi(new y(n+"."+t.slice(1)),h-x).plus(f),y.precision=S,e==null?Qe(v,S,w,lt=!0):v;for(c=v,u=a=v=Lt(v.minus(1),v.plus(1),h,1),d=Qe(v.times(v),h,1),i=3;;){if(a=Qe(a.times(d),h,1),f=u.plus(Lt(a,new y(i),h,1)),ln(f.d).slice(0,h)===ln(u.d).slice(0,h))if(u=u.times(2),s!==0&&(u=u.plus(no(y,h+2,S).times(s+""))),u=Lt(u,new y(g),h,1),e==null)if(Zs(u.d,h-x,w,o))y.precision=h+=x,f=a=v=Lt(c.minus(1),c.plus(1),h,1),d=Qe(v.times(v),h,1),i=o=1;else return Qe(u,y.precision=S,w,lt=!0);else return y.precision=S,u;u=f,i+=2}}function bf(r){return String(r.s*r.s/0)}function $l(r,e){var t,n,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(t<0&&(t=n),t+=+e.slice(n+1),e=e.substring(0,n)):t<0&&(t=e.length),n=0;e.charCodeAt(n)===48;n++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(n,i),e){if(i-=n,r.e=t=t-n-1,r.d=[],n=(t+1)%it,t<0&&(n+=it),n<i){for(n&&r.d.push(+e.slice(0,n)),i-=it;n<i;)r.d.push(+e.slice(n,n+=it));e=e.slice(n),n=it-e.length}else n-=i;for(;n--;)e+="0";r.d.push(+e),lt&&(r.e>r.constructor.maxE?(r.d=null,r.e=NaN):r.e<r.constructor.minE&&(r.e=0,r.d=[0]))}else r.e=0,r.d=[0];return r}function Lm(r,e){var t,n,i,s,a,o,u,f,h;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),yf.test(e))return $l(r,e)}else if(e==="Infinity"||e==="NaN")return+e||(r.s=NaN),r.e=NaN,r.d=null,r;if(Sm.test(e))t=16,e=e.toLowerCase();else if(Mm.test(e))t=2;else if(Em.test(e))t=8;else throw Error(Zi+e);for(s=e.search(/p/i),s>0?(u=+e.slice(s+1),e=e.substring(2,s)):e=e.slice(2),s=e.indexOf("."),a=s>=0,n=r.constructor,a&&(e=e.replace(".",""),o=e.length,s=o-s,i=_f(n,new n(t),s,s*2)),f=Ya(e,t,li),h=f.length-1,s=h;f[s]===0;--s)f.pop();return s<0?new n(r.s*0):(r.e=xo(f,h),r.d=f,lt=!1,a&&(r=Lt(r,i,o*4)),u&&(r=r.times(Math.abs(u)<54?Qt(2,u):rs.pow(2,u))),lt=!0,r)}function Rm(r,e){var t,n=e.d.length;if(n<3)return e.isZero()?e:is(r,2,e,e);t=1.4*Math.sqrt(n),t=t>16?16:t|0,e=e.times(1/_o(5,t)),e=is(r,2,e,e);for(var i,s=new r(5),a=new r(16),o=new r(20);t--;)i=e.times(e),e=e.times(s.plus(i.times(a.times(i).minus(o))));return e}function is(r,e,t,n,i){var s,a,o,u,f=r.precision,h=Math.ceil(f/it);for(lt=!1,u=t.times(t),o=new r(n);;){if(a=Lt(o.times(u),new r(e++*e++),f,1),o=i?n.plus(a):n.minus(a),n=Lt(a.times(u),new r(e++*e++),f,1),a=o.plus(n),a.d[h]!==void 0){for(s=h;a.d[s]===o.d[s]&&s--;);if(s==-1)break}s=o,o=n,n=a,a=s}return lt=!0,a.d.length=h+1,a}function _o(r,e){for(var t=r;--e;)t*=r;return t}function Mf(r,e){var t,n=e.s<0,i=oi(r,r.precision,1),s=i.times(.5);if(e=e.abs(),e.lte(s))return Ri=n?4:1,e;if(t=e.divToInt(i),t.isZero())Ri=n?3:2;else{if(e=e.minus(t.times(i)),e.lte(s))return Ri=hu(t)?n?2:3:n?4:1,e;Ri=hu(t)?n?1:4:n?3:2}return e.minus(i).abs()}function pc(r,e,t,n){var i,s,a,o,u,f,h,c,d,g=r.constructor,x=t!==void 0;if(x?(Pn(t,1,Qi),n===void 0?n=g.rounding:Pn(n,0,8)):(t=g.precision,n=g.rounding),!r.isFinite())h=bf(r);else{for(h=gi(r),a=h.indexOf("."),x?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,a>=0&&(h=h.replace(".",""),d=new g(1),d.e=h.length-a,d.d=Ya(gi(d),10,i),d.e=d.d.length),c=Ya(h,10,i),s=u=c.length;c[--u]==0;)c.pop();if(!c[0])h=x?"0p+0":"0";else{if(a<0?s--:(r=new g(r),r.d=c,r.e=s,r=Lt(r,d,t,n,0,i),c=r.d,s=r.e,f=pf),a=c[t],o=i/2,f=f||c[t+1]!==void 0,f=n<4?(a!==void 0||f)&&(n===0||n===(r.s<0?3:2)):a>o||a===o&&(n===4||f||n===6&&c[t-1]&1||n===(r.s<0?8:7)),c.length=t,f)for(;++c[--t]>i-1;)c[t]=0,t||(++s,c.unshift(1));for(u=c.length;!c[u-1];--u);for(a=0,h="";a<u;a++)h+=jl.charAt(c[a]);if(x){if(u>1)if(e==16||e==8){for(a=e==16?4:3,--u;u%a;u++)h+="0";for(c=Ya(h,i,e),u=c.length;!c[u-1];--u);for(a=1,h="1.";a<u;a++)h+=jl.charAt(c[a])}else h=h.charAt(0)+"."+h.slice(1);h=h+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)h="0"+h;h="0."+h}else if(++s>u)for(s-=u;s--;)h+="0";else s<u&&(h=h.slice(0,s)+"."+h.slice(s))}h=(e==16?"0x":e==2?"0b":e==8?"0o":"")+h}return r.s<0?"-"+h:h}function fu(r,e){if(r.length>e)return r.length=e,!0}function Pm(r){return new this(r).abs()}function Nm(r){return new this(r).acos()}function Dm(r){return new this(r).acosh()}function Im(r,e){return new this(r).plus(e)}function Fm(r){return new this(r).asin()}function Bm(r){return new this(r).asinh()}function Om(r){return new this(r).atan()}function zm(r){return new this(r).atanh()}function Um(r,e){r=new this(r),e=new this(e);var t,n=this.precision,i=this.rounding,s=n+4;return!r.s||!e.s?t=new this(NaN):!r.d&&!e.d?(t=oi(this,s,1).times(e.s>0?.25:.75),t.s=r.s):!e.d||r.isZero()?(t=e.s<0?oi(this,n,i):new this(0),t.s=r.s):!r.d||e.isZero()?(t=oi(this,s,1).times(.5),t.s=r.s):e.s<0?(this.precision=s,this.rounding=1,t=this.atan(Lt(r,e,s,1)),e=oi(this,s,1),this.precision=n,this.rounding=i,t=r.s<0?t.minus(e):t.plus(e)):t=this.atan(Lt(r,e,s,1)),t}function km(r){return new this(r).cbrt()}function Hm(r){return Qe(r=new this(r),r.e+1,2)}function Vm(r,e,t){return new this(r).clamp(e,t)}function Gm(r){if(!r||typeof r!="object")throw Error(yo+"Object expected");var e,t,n,i=r.defaults===!0,s=["precision",1,Qi,"rounding",0,8,"toExpNeg",-Yr,0,"toExpPos",0,Yr,"maxE",0,Yr,"minE",-Yr,0,"modulo",0,9];for(e=0;e<s.length;e+=3)if(t=s[e],i&&(this[t]=Xl[t]),(n=r[t])!==void 0)if(gn(n)===n&&n>=s[e+1]&&n<=s[e+2])this[t]=n;else throw Error(Zi+t+": "+n);if(t="crypto",i&&(this[t]=Xl[t]),(n=r[t])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(gf);else this[t]=!1;else throw Error(Zi+t+": "+n);return this}function Wm(r){return new this(r).cos()}function qm(r){return new this(r).cosh()}function Sf(r){var e,t,n;function i(s){var a,o,u,f=this;if(!(f instanceof i))return new i(s);if(f.constructor=i,du(s)){f.s=s.s,lt?!s.d||s.e>i.maxE?(f.e=NaN,f.d=null):s.e<i.minE?(f.e=0,f.d=[0]):(f.e=s.e,f.d=s.d.slice()):(f.e=s.e,f.d=s.d?s.d.slice():s.d);return}if(u=typeof s,u==="number"){if(s===0){f.s=1/s<0?-1:1,f.e=0,f.d=[0];return}if(s<0?(s=-s,f.s=-1):f.s=1,s===~~s&&s<1e7){for(a=0,o=s;o>=10;o/=10)a++;lt?a>i.maxE?(f.e=NaN,f.d=null):a<i.minE?(f.e=0,f.d=[0]):(f.e=a,f.d=[s]):(f.e=a,f.d=[s]);return}else if(s*0!==0){s||(f.s=NaN),f.e=NaN,f.d=null;return}return $l(f,s.toString())}else if(u!=="string")throw Error(Zi+s);return(o=s.charCodeAt(0))===45?(s=s.slice(1),f.s=-1):(o===43&&(s=s.slice(1)),f.s=1),yf.test(s)?$l(f,s):Lm(f,s)}if(i.prototype=Ce,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Gm,i.clone=Sf,i.isDecimal=du,i.abs=Pm,i.acos=Nm,i.acosh=Dm,i.add=Im,i.asin=Fm,i.asinh=Bm,i.atan=Om,i.atanh=zm,i.atan2=Um,i.cbrt=km,i.ceil=Hm,i.clamp=Vm,i.cos=Wm,i.cosh=qm,i.div=jm,i.exp=Xm,i.floor=Ym,i.hypot=Zm,i.ln=$m,i.log=Jm,i.log10=Km,i.log2=Qm,i.max=eg,i.min=tg,i.mod=ng,i.mul=ig,i.pow=rg,i.random=sg,i.round=ag,i.sign=og,i.sin=lg,i.sinh=cg,i.sqrt=ug,i.sub=hg,i.sum=fg,i.tan=dg,i.tanh=pg,i.trunc=mg,r===void 0&&(r={}),r&&r.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<n.length;)r.hasOwnProperty(t=n[e++])||(r[t]=this[t]);return i.config(r),i}function jm(r,e){return new this(r).div(e)}function Xm(r){return new this(r).exp()}function Ym(r){return Qe(r=new this(r),r.e+1,3)}function Zm(){var r,e,t=new this(0);for(lt=!1,r=0;r<arguments.length;)if(e=new this(arguments[r++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return lt=!0,new this(1/0);t=e}return lt=!0,t.sqrt()}function du(r){return r instanceof rs||r&&r.toStringTag===vf||!1}function $m(r){return new this(r).ln()}function Jm(r,e){return new this(r).log(e)}function Qm(r){return new this(r).log(2)}function Km(r){return new this(r).log(10)}function eg(){return wf(this,arguments,"lt")}function tg(){return wf(this,arguments,"gt")}function ng(r,e){return new this(r).mod(e)}function ig(r,e){return new this(r).mul(e)}function rg(r,e){return new this(r).pow(e)}function sg(r){var e,t,n,i,s=0,a=new this(1),o=[];if(r===void 0?r=this.precision:Pn(r,1,Qi),n=Math.ceil(r/it),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(n));s<n;)i=e[s],i>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:o[s++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(n*=4);s<n;)i=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((e[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,s):(o.push(i%1e7),s+=4);s=n/4}else throw Error(gf);else for(;s<n;)o[s++]=Math.random()*1e7|0;for(n=o[--s],r%=it,n&&r&&(i=Qt(10,it-r),o[s]=(n/i|0)*i);o[s]===0;s--)o.pop();if(s<0)t=0,o=[0];else{for(t=-1;o[0]===0;t-=it)o.shift();for(n=1,i=o[0];i>=10;i/=10)n++;n<it&&(t-=it-n)}return a.e=t,a.d=o,a}function ag(r){return Qe(r=new this(r),r.e+1,this.rounding)}function og(r){return r=new this(r),r.d?r.d[0]?r.s:0*r.s:r.s||NaN}function lg(r){return new this(r).sin()}function cg(r){return new this(r).sinh()}function ug(r){return new this(r).sqrt()}function hg(r,e){return new this(r).sub(e)}function fg(){var r=0,e=arguments,t=new this(e[r]);for(lt=!1;t.s&&++r<e.length;)t=t.plus(e[r]);return lt=!0,Qe(t,this.precision,this.rounding)}function dg(r){return new this(r).tan()}function pg(r){return new this(r).tanh()}function mg(r){return Qe(r=new this(r),r.e+1,1)}Ce[Symbol.for("nodejs.util.inspect.custom")]=Ce.toString;Ce[Symbol.toStringTag]="Decimal";var rs=Ce.constructor=Sf(Xl);eo=new rs(eo);to=new rs(to);var gg="BigNumber",vg=["?on","config"],yg=Ht(gg,vg,r=>{var{on:e,config:t}=r,n=rs.clone({precision:t.precision,modulo:rs.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(i){return new n(i.value)},e&&e("config",function(i,s){i.precision!==s.precision&&n.config({precision:i.precision})}),n},{isClass:!0}),Ef={exports:{}};/**
 * @license Complex.js v2.1.1 12/05/2020
 *
 * Copyright (c) 2020, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,e){(function(t){var n=Math.cosh||function(c){return Math.abs(c)<1e-9?1-c:(Math.exp(c)+Math.exp(-c))*.5},i=Math.sinh||function(c){return Math.abs(c)<1e-9?c:(Math.exp(c)-Math.exp(-c))*.5},s=function(c){var d=Math.PI/4;if(-d>c||c>d)return Math.cos(c)-1;var g=c*c;return g*(g*(g*(g*(g*(g*(g*(g/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-1/2)},a=function(c,d){var g=Math.abs(c),x=Math.abs(d);return g<3e3&&x<3e3?Math.sqrt(g*g+x*x):(g<x?(g=x,x=c/d):x=d/c,g*Math.sqrt(1+x*x))},o=function(){throw SyntaxError("Invalid Param")};function u(c,d){var g=Math.abs(c),x=Math.abs(d);return c===0?Math.log(x):d===0?Math.log(g):g<3e3&&x<3e3?Math.log(c*c+d*d)*.5:(c=c/2,d=d/2,.5*Math.log(c*c+d*d)+Math.LN2)}var f=function(c,d){var g={re:0,im:0};if(c==null)g.re=g.im=0;else if(d!==void 0)g.re=c,g.im=d;else switch(typeof c){case"object":if("im"in c&&"re"in c)g.re=c.re,g.im=c.im;else if("abs"in c&&"arg"in c){if(!Number.isFinite(c.abs)&&Number.isFinite(c.arg))return h.INFINITY;g.re=c.abs*Math.cos(c.arg),g.im=c.abs*Math.sin(c.arg)}else if("r"in c&&"phi"in c){if(!Number.isFinite(c.r)&&Number.isFinite(c.phi))return h.INFINITY;g.re=c.r*Math.cos(c.phi),g.im=c.r*Math.sin(c.phi)}else c.length===2?(g.re=c[0],g.im=c[1]):o();break;case"string":g.im=g.re=0;var x=c.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),v=1,b=0;x===null&&o();for(var y=0;y<x.length;y++){var w=x[y];w===" "||w==="	"||w===`
`||(w==="+"?v++:w==="-"?b++:w==="i"||w==="I"?(v+b===0&&o(),x[y+1]!==" "&&!isNaN(x[y+1])?(g.im+=parseFloat((b%2?"-":"")+x[y+1]),y++):g.im+=parseFloat((b%2?"-":"")+"1"),v=b=0):((v+b===0||isNaN(w))&&o(),x[y+1]==="i"||x[y+1]==="I"?(g.im+=parseFloat((b%2?"-":"")+w),y++):g.re+=parseFloat((b%2?"-":"")+w),v=b=0))}v+b>0&&o();break;case"number":g.im=0,g.re=c;break;default:o()}return isNaN(g.re)||isNaN(g.im),g};function h(c,d){if(!(this instanceof h))return new h(c,d);var g=f(c,d);this.re=g.re,this.im=g.im}h.prototype={re:0,im:0,sign:function(){var c=this.abs();return new h(this.re/c,this.im/c)},add:function(c,d){var g=new h(c,d);return this.isInfinite()&&g.isInfinite()?h.NAN:this.isInfinite()||g.isInfinite()?h.INFINITY:new h(this.re+g.re,this.im+g.im)},sub:function(c,d){var g=new h(c,d);return this.isInfinite()&&g.isInfinite()?h.NAN:this.isInfinite()||g.isInfinite()?h.INFINITY:new h(this.re-g.re,this.im-g.im)},mul:function(c,d){var g=new h(c,d);return this.isInfinite()&&g.isZero()||this.isZero()&&g.isInfinite()?h.NAN:this.isInfinite()||g.isInfinite()?h.INFINITY:g.im===0&&this.im===0?new h(this.re*g.re,0):new h(this.re*g.re-this.im*g.im,this.re*g.im+this.im*g.re)},div:function(c,d){var g=new h(c,d);if(this.isZero()&&g.isZero()||this.isInfinite()&&g.isInfinite())return h.NAN;if(this.isInfinite()||g.isZero())return h.INFINITY;if(this.isZero()||g.isInfinite())return h.ZERO;c=this.re,d=this.im;var x=g.re,v=g.im,b,y;return v===0?new h(c/x,d/x):Math.abs(x)<Math.abs(v)?(y=x/v,b=x*y+v,new h((c*y+d)/b,(d*y-c)/b)):(y=v/x,b=v*y+x,new h((c+d*y)/b,(d-c*y)/b))},pow:function(c,d){var g=new h(c,d);if(c=this.re,d=this.im,g.isZero())return h.ONE;if(g.im===0){if(d===0&&c>0)return new h(Math.pow(c,g.re),0);if(c===0)switch((g.re%4+4)%4){case 0:return new h(Math.pow(d,g.re),0);case 1:return new h(0,Math.pow(d,g.re));case 2:return new h(-Math.pow(d,g.re),0);case 3:return new h(0,-Math.pow(d,g.re))}}if(c===0&&d===0&&g.re>0&&g.im>=0)return h.ZERO;var x=Math.atan2(d,c),v=u(c,d);return c=Math.exp(g.re*v-g.im*x),d=g.im*v+g.re*x,new h(c*Math.cos(d),c*Math.sin(d))},sqrt:function(){var c=this.re,d=this.im,g=this.abs(),x,v;if(c>=0){if(d===0)return new h(Math.sqrt(c),0);x=.5*Math.sqrt(2*(g+c))}else x=Math.abs(d)/Math.sqrt(2*(g-c));return c<=0?v=.5*Math.sqrt(2*(g-c)):v=Math.abs(d)/Math.sqrt(2*(g+c)),new h(x,d<0?-v:v)},exp:function(){var c=Math.exp(this.re);return this.im,new h(c*Math.cos(this.im),c*Math.sin(this.im))},expm1:function(){var c=this.re,d=this.im;return new h(Math.expm1(c)*Math.cos(d)+s(d),Math.exp(c)*Math.sin(d))},log:function(){var c=this.re,d=this.im;return new h(u(c,d),Math.atan2(d,c))},abs:function(){return a(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var c=this.re,d=this.im;return new h(Math.sin(c)*n(d),Math.cos(c)*i(d))},cos:function(){var c=this.re,d=this.im;return new h(Math.cos(c)*n(d),-Math.sin(c)*i(d))},tan:function(){var c=2*this.re,d=2*this.im,g=Math.cos(c)+n(d);return new h(Math.sin(c)/g,i(d)/g)},cot:function(){var c=2*this.re,d=2*this.im,g=Math.cos(c)-n(d);return new h(-Math.sin(c)/g,i(d)/g)},sec:function(){var c=this.re,d=this.im,g=.5*n(2*d)+.5*Math.cos(2*c);return new h(Math.cos(c)*n(d)/g,Math.sin(c)*i(d)/g)},csc:function(){var c=this.re,d=this.im,g=.5*n(2*d)-.5*Math.cos(2*c);return new h(Math.sin(c)*n(d)/g,-Math.cos(c)*i(d)/g)},asin:function(){var c=this.re,d=this.im,g=new h(d*d-c*c+1,-2*c*d).sqrt(),x=new h(g.re-d,g.im+c).log();return new h(x.im,-x.re)},acos:function(){var c=this.re,d=this.im,g=new h(d*d-c*c+1,-2*c*d).sqrt(),x=new h(g.re-d,g.im+c).log();return new h(Math.PI/2-x.im,x.re)},atan:function(){var c=this.re,d=this.im;if(c===0){if(d===1)return new h(0,1/0);if(d===-1)return new h(0,-1/0)}var g=c*c+(1-d)*(1-d),x=new h((1-d*d-c*c)/g,-2*c/g).log();return new h(-.5*x.im,.5*x.re)},acot:function(){var c=this.re,d=this.im;if(d===0)return new h(Math.atan2(1,c),0);var g=c*c+d*d;return g!==0?new h(c/g,-d/g).atan():new h(c!==0?c/0:0,d!==0?-d/0:0).atan()},asec:function(){var c=this.re,d=this.im;if(c===0&&d===0)return new h(0,1/0);var g=c*c+d*d;return g!==0?new h(c/g,-d/g).acos():new h(c!==0?c/0:0,d!==0?-d/0:0).acos()},acsc:function(){var c=this.re,d=this.im;if(c===0&&d===0)return new h(Math.PI/2,1/0);var g=c*c+d*d;return g!==0?new h(c/g,-d/g).asin():new h(c!==0?c/0:0,d!==0?-d/0:0).asin()},sinh:function(){var c=this.re,d=this.im;return new h(i(c)*Math.cos(d),n(c)*Math.sin(d))},cosh:function(){var c=this.re,d=this.im;return new h(n(c)*Math.cos(d),i(c)*Math.sin(d))},tanh:function(){var c=2*this.re,d=2*this.im,g=n(c)+Math.cos(d);return new h(i(c)/g,Math.sin(d)/g)},coth:function(){var c=2*this.re,d=2*this.im,g=n(c)-Math.cos(d);return new h(i(c)/g,-Math.sin(d)/g)},csch:function(){var c=this.re,d=this.im,g=Math.cos(2*d)-n(2*c);return new h(-2*i(c)*Math.cos(d)/g,2*n(c)*Math.sin(d)/g)},sech:function(){var c=this.re,d=this.im,g=Math.cos(2*d)+n(2*c);return new h(2*n(c)*Math.cos(d)/g,-2*i(c)*Math.sin(d)/g)},asinh:function(){var c=this.im;this.im=-this.re,this.re=c;var d=this.asin();return this.re=-this.im,this.im=c,c=d.re,d.re=-d.im,d.im=c,d},acosh:function(){var c=this.acos();if(c.im<=0){var d=c.re;c.re=-c.im,c.im=d}else{var d=c.im;c.im=-c.re,c.re=d}return c},atanh:function(){var c=this.re,d=this.im,g=c>1&&d===0,x=1-c,v=1+c,b=x*x+d*d,y=b!==0?new h((v*x-d*d)/b,(d*x+v*d)/b):new h(c!==-1?c/0:0,d!==0?d/0:0),w=y.re;return y.re=u(y.re,y.im)/2,y.im=Math.atan2(y.im,w)/2,g&&(y.im=-y.im),y},acoth:function(){var c=this.re,d=this.im;if(c===0&&d===0)return new h(0,Math.PI/2);var g=c*c+d*d;return g!==0?new h(c/g,-d/g).atanh():new h(c!==0?c/0:0,d!==0?-d/0:0).atanh()},acsch:function(){var c=this.re,d=this.im;if(d===0)return new h(c!==0?Math.log(c+Math.sqrt(c*c+1)):1/0,0);var g=c*c+d*d;return g!==0?new h(c/g,-d/g).asinh():new h(c!==0?c/0:0,d!==0?-d/0:0).asinh()},asech:function(){var c=this.re,d=this.im;if(this.isZero())return h.INFINITY;var g=c*c+d*d;return g!==0?new h(c/g,-d/g).acosh():new h(c!==0?c/0:0,d!==0?-d/0:0).acosh()},inverse:function(){if(this.isZero())return h.INFINITY;if(this.isInfinite())return h.ZERO;var c=this.re,d=this.im,g=c*c+d*d;return new h(c/g,-d/g)},conjugate:function(){return new h(this.re,-this.im)},neg:function(){return new h(-this.re,-this.im)},ceil:function(c){return c=Math.pow(10,c||0),new h(Math.ceil(this.re*c)/c,Math.ceil(this.im*c)/c)},floor:function(c){return c=Math.pow(10,c||0),new h(Math.floor(this.re*c)/c,Math.floor(this.im*c)/c)},round:function(c){return c=Math.pow(10,c||0),new h(Math.round(this.re*c)/c,Math.round(this.im*c)/c)},equals:function(c,d){var g=new h(c,d);return Math.abs(g.re-this.re)<=h.EPSILON&&Math.abs(g.im-this.im)<=h.EPSILON},clone:function(){return new h(this.re,this.im)},toString:function(){var c=this.re,d=this.im,g="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(c)<h.EPSILON&&(c=0),Math.abs(d)<h.EPSILON&&(d=0),d===0?g+c:(c!==0?(g+=c,g+=" ",d<0?(d=-d,g+="-"):g+="+",g+=" "):d<0&&(d=-d,g+="-"),d!==1&&(g+=d),g+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},h.ZERO=new h(0,0),h.ONE=new h(1,0),h.I=new h(0,1),h.PI=new h(Math.PI,0),h.E=new h(Math.E,0),h.INFINITY=new h(1/0,1/0),h.NAN=new h(NaN,NaN),h.EPSILON=1e-15,Object.defineProperty(h,"__esModule",{value:!0}),h.default=h,h.Complex=h,r.exports=h})()})(Ef);var Cn=Yh(Ef.exports),xg="Complex",_g=[],wg=Ht(xg,_g,()=>(Cn.prototype.type="Complex",Cn.prototype.isComplex=!0,Cn.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Cn.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Cn.prototype.format=function(r){var e="",t=this.im,n=this.re,i=Wl(this.re,r),s=Wl(this.im,r),a=Vt(r)?r:r?r.precision:null;if(a!==null){var o=Math.pow(10,-a);Math.abs(n/t)<o&&(n=0),Math.abs(t/n)<o&&(t=0)}return t===0?e=i:n===0?t===1?e="i":t===-1?e="-i":e=s+"i":t<0?t===-1?e=i+" - i":e=i+" - "+s.substring(1)+"i":t===1?e=i+" + i":e=i+" + "+s+"i",e},Cn.fromPolar=function(r){switch(arguments.length){case 1:{var e=arguments[0];if(typeof e=="object")return Cn(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var t=arguments[0],n=arguments[1];if(Vt(t)){if(fc(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),Vt(n))return new Cn({r:t,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Cn.prototype.valueOf=Cn.prototype.toString,Cn.fromJSON=function(r){return new Cn(r)},Cn.compare=function(r,e){return r.re>e.re?1:r.re<e.re?-1:r.im>e.im?1:r.im<e.im?-1:0},Cn),{isClass:!0}),Tf={exports:{}};/**
 * @license Fraction.js v4.2.0 05/03/2022
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/(function(r,e){(function(t){var n=2e3,i={s:1,n:0,d:1};function s(x,v){if(isNaN(x=parseInt(x,10)))throw g.InvalidParameter;return x*v}function a(x,v){if(v===0)throw g.DivisionByZero;var b=Object.create(g.prototype);b.s=x<0?-1:1,x=x<0?-x:x;var y=d(x,v);return b.n=x/y,b.d=v/y,b}function o(x){for(var v={},b=x,y=2,w=4;w<=b;){for(;b%y===0;)b/=y,v[y]=(v[y]||0)+1;w+=1+2*y++}return b!==x?b>1&&(v[b]=(v[b]||0)+1):v[x]=(v[x]||0)+1,v}var u=function(x,v){var b=0,y=1,w=1,S=0,L=0,T=0,m=1,C=1,N=0,z=1,W=1,B=1,se=1e7,$;if(x!=null)if(v!==void 0){if(b=x,y=v,w=b*y,b%1!==0||y%1!==0)throw g.NonIntegerParameter}else switch(typeof x){case"object":{if("d"in x&&"n"in x)b=x.n,y=x.d,"s"in x&&(b*=x.s);else if(0 in x)b=x[0],1 in x&&(y=x[1]);else throw g.InvalidParameter;w=b*y;break}case"number":{if(x<0&&(w=x,x=-x),x%1===0)b=x;else if(x>0){for(x>=1&&(C=Math.pow(10,Math.floor(1+Math.log(x)/Math.LN10)),x/=C);z<=se&&B<=se;)if($=(N+W)/(z+B),x===$){z+B<=se?(b=N+W,y=z+B):B>z?(b=W,y=B):(b=N,y=z);break}else x>$?(N+=W,z+=B):(W+=N,B+=z),z>se?(b=W,y=B):(b=N,y=z);b*=C}else(isNaN(x)||isNaN(v))&&(y=b=NaN);break}case"string":{if(z=x.match(/\d+|./g),z===null)throw g.InvalidParameter;if(z[N]==="-"?(w=-1,N++):z[N]==="+"&&N++,z.length===N+1?L=s(z[N++],w):z[N+1]==="."||z[N]==="."?(z[N]!=="."&&(S=s(z[N++],w)),N++,(N+1===z.length||z[N+1]==="("&&z[N+3]===")"||z[N+1]==="'"&&z[N+3]==="'")&&(L=s(z[N],w),m=Math.pow(10,z[N].length),N++),(z[N]==="("&&z[N+2]===")"||z[N]==="'"&&z[N+2]==="'")&&(T=s(z[N+1],w),C=Math.pow(10,z[N+1].length)-1,N+=3)):z[N+1]==="/"||z[N+1]===":"?(L=s(z[N],w),m=s(z[N+2],1),N+=3):z[N+3]==="/"&&z[N+1]===" "&&(S=s(z[N],w),L=s(z[N+2],w),m=s(z[N+4],1),N+=5),z.length<=N){y=m*C,w=b=T+y*S+C*L;break}}default:throw g.InvalidParameter}if(y===0)throw g.DivisionByZero;i.s=w<0?-1:1,i.n=Math.abs(b),i.d=Math.abs(y)};function f(x,v,b){for(var y=1;v>0;x=x*x%b,v>>=1)v&1&&(y=y*x%b);return y}function h(x,v){for(;v%2===0;v/=2);for(;v%5===0;v/=5);if(v===1)return 0;for(var b=10%v,y=1;b!==1;y++)if(b=b*10%v,y>n)return 0;return y}function c(x,v,b){for(var y=1,w=f(10,b,v),S=0;S<300;S++){if(y===w)return S;y=y*10%v,w=w*10%v}return 0}function d(x,v){if(!x)return v;if(!v)return x;for(;;){if(x%=v,!x)return v;if(v%=x,!v)return x}}function g(x,v){if(u(x,v),this instanceof g)x=d(i.d,i.n),this.s=i.s,this.n=i.n/x,this.d=i.d/x;else return a(i.s*i.n,i.d)}g.DivisionByZero=new Error("Division by Zero"),g.InvalidParameter=new Error("Invalid argument"),g.NonIntegerParameter=new Error("Parameters must be integer"),g.prototype={s:1,n:0,d:1,abs:function(){return a(this.n,this.d)},neg:function(){return a(-this.s*this.n,this.d)},add:function(x,v){return u(x,v),a(this.s*this.n*i.d+i.s*this.d*i.n,this.d*i.d)},sub:function(x,v){return u(x,v),a(this.s*this.n*i.d-i.s*this.d*i.n,this.d*i.d)},mul:function(x,v){return u(x,v),a(this.s*i.s*this.n*i.n,this.d*i.d)},div:function(x,v){return u(x,v),a(this.s*i.s*this.n*i.d,this.d*i.n)},clone:function(){return a(this.s*this.n,this.d)},mod:function(x,v){if(isNaN(this.n)||isNaN(this.d))return new g(NaN);if(x===void 0)return a(this.s*this.n%this.d,1);if(u(x,v),i.n===0&&this.d===0)throw g.DivisionByZero;return a(this.s*(i.d*this.n)%(i.n*this.d),i.d*this.d)},gcd:function(x,v){return u(x,v),a(d(i.n,this.n)*d(i.d,this.d),i.d*this.d)},lcm:function(x,v){return u(x,v),i.n===0&&this.n===0?a(0,1):a(i.n*this.n,d(i.n,this.n)*d(i.d,this.d))},ceil:function(x){return x=Math.pow(10,x||0),isNaN(this.n)||isNaN(this.d)?new g(NaN):a(Math.ceil(x*this.s*this.n/this.d),x)},floor:function(x){return x=Math.pow(10,x||0),isNaN(this.n)||isNaN(this.d)?new g(NaN):a(Math.floor(x*this.s*this.n/this.d),x)},round:function(x){return x=Math.pow(10,x||0),isNaN(this.n)||isNaN(this.d)?new g(NaN):a(Math.round(x*this.s*this.n/this.d),x)},inverse:function(){return a(this.s*this.d,this.n)},pow:function(x,v){if(u(x,v),i.d===1)return i.s<0?a(Math.pow(this.s*this.d,i.n),Math.pow(this.n,i.n)):a(Math.pow(this.s*this.n,i.n),Math.pow(this.d,i.n));if(this.s<0)return null;var b=o(this.n),y=o(this.d),w=1,S=1;for(var L in b)if(L!=="1"){if(L==="0"){w=0;break}if(b[L]*=i.n,b[L]%i.d===0)b[L]/=i.d;else return null;w*=Math.pow(L,b[L])}for(var L in y)if(L!=="1"){if(y[L]*=i.n,y[L]%i.d===0)y[L]/=i.d;else return null;S*=Math.pow(L,y[L])}return i.s<0?a(S,w):a(w,S)},equals:function(x,v){return u(x,v),this.s*this.n*i.d===i.s*i.n*this.d},compare:function(x,v){u(x,v);var b=this.s*this.n*i.d-i.s*i.n*this.d;return(0<b)-(b<0)},simplify:function(x){if(isNaN(this.n)||isNaN(this.d))return this;x=x||.001;for(var v=this.abs(),b=v.toContinued(),y=1;y<b.length;y++){for(var w=a(b[y-1],1),S=y-2;S>=0;S--)w=w.inverse().add(b[S]);if(w.sub(v).abs().valueOf()<x)return w.mul(this.s)}return this},divisible:function(x,v){return u(x,v),!(!(i.n*this.d)||this.n*i.d%(i.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(x){var v,b="",y=this.n,w=this.d;return this.s<0&&(b+="-"),w===1?b+=y:(x&&(v=Math.floor(y/w))>0&&(b+=v,b+=" ",y%=w),b+=y,b+="/",b+=w),b},toLatex:function(x){var v,b="",y=this.n,w=this.d;return this.s<0&&(b+="-"),w===1?b+=y:(x&&(v=Math.floor(y/w))>0&&(b+=v,y%=w),b+="\\frac{",b+=y,b+="}{",b+=w,b+="}"),b},toContinued:function(){var x,v=this.n,b=this.d,y=[];if(isNaN(v)||isNaN(b))return y;do y.push(Math.floor(v/b)),x=v%b,v=b,b=x;while(v!==1);return y},toString:function(x){var v=this.n,b=this.d;if(isNaN(v)||isNaN(b))return"NaN";x=x||15;var y=h(v,b),w=c(v,b,y),S=this.s<0?"-":"";if(S+=v/b|0,v%=b,v*=10,v&&(S+="."),y){for(var L=w;L--;)S+=v/b|0,v%=b,v*=10;S+="(";for(var L=y;L--;)S+=v/b|0,v%=b,v*=10;S+=")"}else for(var L=x;v&&L--;)S+=v/b|0,v%=b,v*=10;return S}},Object.defineProperty(g,"__esModule",{value:!0}),g.default=g,g.Fraction=g,r.exports=g})()})(Tf);var Sr=Yh(Tf.exports),bg="Fraction",Mg=[],Sg=Ht(bg,Mg,()=>(Sr.prototype.type="Fraction",Sr.prototype.isFraction=!0,Sr.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Sr.fromJSON=function(r){return new Sr(r)},Sr),{isClass:!0}),Eg="Matrix",Tg=[],Ag=Ht(Eg,Tg,()=>{function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator")}return r.prototype.type="Matrix",r.prototype.isMatrix=!0,r.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},r.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},r.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},r.prototype.subset=function(e,t,n){throw new Error("Cannot invoke subset on a Matrix interface")},r.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},r.prototype.set=function(e,t,n){throw new Error("Cannot invoke set on a Matrix interface")},r.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},r.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},r.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},r.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},r.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},r.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},r.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},r.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},r.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},r.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},r.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},r},{isClass:!0}),Cg="DenseMatrix",Lg=["Matrix"],Rg=Ht(Cg,Lg,r=>{var{Matrix:e}=r;function t(h,c){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(c&&!Ci(c))throw new Error("Invalid datatype: "+c);if(_n(h))h.type==="DenseMatrix"?(this._data=an(h._data),this._size=an(h._size),this._datatype=c||h._datatype):(this._data=h.toArray(),this._size=h.size(),this._datatype=c||h._datatype);else if(h&&Ot(h.data)&&Ot(h.size))this._data=h.data,this._size=h.size,cu(this._data,this._size),this._datatype=c||h.datatype;else if(Ot(h))this._data=f(h),this._size=yr(this._data),cu(this._data,this._size),this._datatype=c;else{if(h)throw new TypeError("Unsupported type of data ("+Vs(h)+")");this._data=[],this._size=[0],this._datatype=c}}t.prototype=new e,t.prototype.createDenseMatrix=function(h,c){return new t(h,c)},t.prototype.type="DenseMatrix",t.prototype.isDenseMatrix=!0,t.prototype.getDataType=function(){return Ka(this._data,Vs)},t.prototype.storage=function(){return"dense"},t.prototype.datatype=function(){return this._datatype},t.prototype.create=function(h,c){return new t(h,c)},t.prototype.subset=function(h,c,d){switch(arguments.length){case 1:return n(this,h);case 2:case 3:return s(this,h,c,d);default:throw new SyntaxError("Wrong number of arguments")}},t.prototype.get=function(h){if(!Ot(h))throw new TypeError("Array expected");if(h.length!==this._size.length)throw new Ut(h.length,this._size.length);for(var c=0;c<h.length;c++)zt(h[c],this._size[c]);for(var d=this._data,g=0,x=h.length;g<x;g++){var v=h[g];zt(v,d.length),d=d[v]}return d},t.prototype.set=function(h,c,d){if(!Ot(h))throw new TypeError("Array expected");if(h.length<this._size.length)throw new Ut(h.length,this._size.length,"<");var g,x,v,b=h.map(function(w){return w+1});u(this,b,d);var y=this._data;for(g=0,x=h.length-1;g<x;g++)v=h[g],zt(v,y.length),y=y[v];return v=h[h.length-1],zt(v,y.length),y[v]=c,this};function n(h,c){if(!mo(c))throw new TypeError("Invalid index");var d=c.isScalar();if(d)return h.get(c.min());var g=c.size();if(g.length!==h._size.length)throw new Ut(g.length,h._size.length);for(var x=c.min(),v=c.max(),b=0,y=h._size.length;b<y;b++)zt(x[b],h._size[b]),zt(v[b],h._size[b]);return new t(i(h._data,c,g.length,0),h._datatype)}function i(h,c,d,g){var x=g===d-1,v=c.dimension(g);return x?v.map(function(b){return zt(b,h.length),h[b]}).valueOf():v.map(function(b){zt(b,h.length);var y=h[b];return i(y,c,d,g+1)}).valueOf()}function s(h,c,d,g){if(!c||c.isIndex!==!0)throw new TypeError("Invalid index");var x=c.size(),v=c.isScalar(),b;if(_n(d)?(b=d.size(),d=d.valueOf()):b=yr(d),v){if(b.length!==0)throw new TypeError("Scalar expected");h.set(c.min(),d,g)}else{if(x.length<h._size.length)throw new Ut(x.length,h._size.length,"<");if(b.length<x.length){for(var y=0,w=0;x[y]===1&&b[y]===1;)y++;for(;x[y]===1;)w++,y++;d=cf(d,x.length,w,b)}if(!Ja(x,b))throw new Ut(x,b,">");var S=c.max().map(function(m){return m+1});u(h,S,g);var L=x.length,T=0;a(h._data,c,d,L,T)}return h}function a(h,c,d,g,x){var v=x===g-1,b=c.dimension(x);v?b.forEach(function(y,w){zt(y),h[y]=d[w[0]]}):b.forEach(function(y,w){zt(y),a(h[y],c,d[w[0]],g,x+1)})}t.prototype.resize=function(h,c,d){if(!Jh(h))throw new TypeError("Array or Matrix expected");var g=h.valueOf().map(v=>Array.isArray(v)&&v.length===1?v[0]:v),x=d?this.clone():this;return o(x,g,c)};function o(h,c,d){if(c.length===0){for(var g=h._data;Ot(g);)g=g[0];return g}return h._size=c.slice(0),h._data=uu(h._data,h._size,d),h}t.prototype.reshape=function(h,c){var d=c?this.clone():this;d._data=am(d._data,h);var g=d._size.reduce((x,v)=>x*v);return d._size=dc(h,g),d};function u(h,c,d){for(var g=h._size.slice(0),x=!1;g.length<c.length;)g.push(0),x=!0;for(var v=0,b=c.length;v<b;v++)c[v]>g[v]&&(g[v]=c[v],x=!0);x&&o(h,g,d)}t.prototype.clone=function(){var h=new t({data:an(this._data),size:an(this._size),datatype:this._datatype});return h},t.prototype.size=function(){return this._size.slice(0)},t.prototype.map=function(h){var c=this,d=function v(b,y){return Ot(b)?b.map(function(w,S){return v(w,y.concat(S))}):h(b,y,c)},g=d(this._data,[]),x=this._datatype!==void 0?Ka(g,Vs):void 0;return new t(g,x)},t.prototype.forEach=function(h){var c=this,d=function g(x,v){Ot(x)?x.forEach(function(b,y){g(b,v.concat(y))}):h(x,v,c)};d(this._data,[])},t.prototype[Symbol.iterator]=function*(){var h=function*c(d,g){if(Ot(d))for(var x=0;x<d.length;x++)yield*c(d[x],g.concat(x));else yield{value:d,index:g}};yield*h(this._data,[])},t.prototype.rows=function(){var h=[],c=this.size();if(c.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var d=this._data;for(var g of d)h.push(new t([g],this._datatype));return h},t.prototype.columns=function(){var h=this,c=[],d=this.size();if(d.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var g=this._data,x=function(y){var w=g.map(S=>[S[y]]);c.push(new t(w,h._datatype))},v=0;v<d[1];v++)x(v);return c},t.prototype.toArray=function(){return an(this._data)},t.prototype.valueOf=function(){return this._data},t.prototype.format=function(h){return Ln(this._data,h)},t.prototype.toString=function(){return Ln(this._data)},t.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},t.prototype.diagonal=function(h){if(h){if(ai(h)&&(h=h.toNumber()),!Vt(h)||!on(h))throw new TypeError("The parameter k must be an integer number")}else h=0;for(var c=h>0?h:0,d=h<0?-h:0,g=this._size[0],x=this._size[1],v=Math.min(g-d,x-c),b=[],y=0;y<v;y++)b[y]=this._data[y+d][y+c];return new t({data:b,size:[v],datatype:this._datatype})},t.diagonal=function(h,c,d,g){if(!Ot(h))throw new TypeError("Array expected, size parameter");if(h.length!==2)throw new Error("Only two dimensions matrix are supported");if(h=h.map(function(C){if(ai(C)&&(C=C.toNumber()),!Vt(C)||!on(C)||C<1)throw new Error("Size values must be positive integers");return C}),d){if(ai(d)&&(d=d.toNumber()),!Vt(d)||!on(d))throw new TypeError("The parameter k must be an integer number")}else d=0;var x=d>0?d:0,v=d<0?-d:0,b=h[0],y=h[1],w=Math.min(b-v,y-x),S;if(Ot(c)){if(c.length!==w)throw new Error("Invalid value array length");S=function(N){return c[N]}}else if(_n(c)){var L=c.size();if(L.length!==1||L[0]!==w)throw new Error("Invalid matrix length");S=function(N){return c.get([N])}}else S=function(){return c};g||(g=ai(S(0))?S(0).mul(0):0);var T=[];if(h.length>0){T=uu(T,h,g);for(var m=0;m<w;m++)T[m+v][m+x]=S(m)}return new t({data:T,size:[b,y]})},t.fromJSON=function(h){return new t(h)},t.prototype.swapRows=function(h,c){if(!Vt(h)||!on(h)||!Vt(c)||!on(c))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return zt(h,this._size[0]),zt(c,this._size[0]),t._swapRows(h,c,this._data),this},t._swapRows=function(h,c,d){var g=d[h];d[h]=d[c],d[c]=g};function f(h){for(var c=0,d=h.length;c<d;c++){var g=h[c];Ot(g)?h[c]=f(g):g&&g.isMatrix===!0&&(h[c]=f(g.valueOf()))}return h}return t},{isClass:!0});function _r(r,e,t){return r&&typeof r.map=="function"?r.map(function(n){return _r(n,e)}):e(r)}var Af="number, number";function Cf(r,e){return r+e}Cf.signature=Af;function Lf(r,e){return r*e}Lf.signature=Af;function Pg(r,e,t){if(t==null)return r.eq(e);if(r.eq(e))return!0;if(r.isNaN()||e.isNaN())return!1;if(r.isFinite()&&e.isFinite()){var n=r.minus(e).abs();if(n.isZero())return!0;var i=r.constructor.max(r.abs(),e.abs());return n.lte(i.times(t))}return!1}function Ng(r,e,t){return Qa(r.re,e.re,t)&&Qa(r.im,e.im,t)}var io="equalScalar",Dg=["typed","config"],Ig=Ht(io,Dg,r=>{var{typed:e,config:t}=r;return e(io,{"boolean, boolean":function(i,s){return i===s},"number, number":function(i,s){return Qa(i,s,t.epsilon)},"BigNumber, BigNumber":function(i,s){return i.eq(s)||Pg(i,s,t.epsilon)},"Fraction, Fraction":function(i,s){return i.equals(s)},"Complex, Complex":function(i,s){return Ng(i,s,t.epsilon)},"Unit, Unit":function(i,s){if(!i.equalBase(s))throw new Error("Cannot compare units with different base");return this(i.value,s.value)}})});Ht(io,["typed","config"],r=>{var{typed:e,config:t}=r;return e(io,{"number, number":function(i,s){return Qa(i,s,t.epsilon)}})});var Fg="SparseMatrix",Bg=["typed","equalScalar","Matrix"],Og=Ht(Fg,Bg,r=>{var{typed:e,equalScalar:t,Matrix:n}=r;function i(v,b){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(b&&!Ci(b))throw new Error("Invalid datatype: "+b);if(_n(v))s(this,v,b);else if(v&&Ot(v.index)&&Ot(v.ptr)&&Ot(v.size))this._values=v.values,this._index=v.index,this._ptr=v.ptr,this._size=v.size,this._datatype=b||v.datatype;else if(Ot(v))a(this,v,b);else{if(v)throw new TypeError("Unsupported type of data ("+Vs(v)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=b}}function s(v,b,y){b.type==="SparseMatrix"?(v._values=b._values?an(b._values):void 0,v._index=an(b._index),v._ptr=an(b._ptr),v._size=an(b._size),v._datatype=y||b._datatype):a(v,b.valueOf(),y||b._datatype)}function a(v,b,y){v._values=[],v._index=[],v._ptr=[],v._datatype=y;var w=b.length,S=0,L=t,T=0;if(Ci(y)&&(L=e.find(t,[y,y])||t,T=e.convert(0,y)),w>0){var m=0;do{v._ptr.push(v._index.length);for(var C=0;C<w;C++){var N=b[C];if(Ot(N)){if(m===0&&S<N.length&&(S=N.length),m<N.length){var z=N[m];L(z,T)||(v._values.push(z),v._index.push(C))}}else m===0&&S<1&&(S=1),L(N,T)||(v._values.push(N),v._index.push(C))}m++}while(m<S)}v._ptr.push(v._index.length),v._size=[w,S]}i.prototype=new n,i.prototype.createSparseMatrix=function(v,b){return new i(v,b)},i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Ka(this._values,Vs)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(v,b){return new i(v,b)},i.prototype.density=function(){var v=this._size[0],b=this._size[1];return v!==0&&b!==0?this._index.length/(v*b):0},i.prototype.subset=function(v,b,y){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return o(this,v);case 2:case 3:return u(this,v,b,y);default:throw new SyntaxError("Wrong number of arguments")}};function o(v,b){if(!mo(b))throw new TypeError("Invalid index");var y=b.isScalar();if(y)return v.get(b.min());var w=b.size();if(w.length!==v._size.length)throw new Ut(w.length,v._size.length);var S,L,T,m,C=b.min(),N=b.max();for(S=0,L=v._size.length;S<L;S++)zt(C[S],v._size[S]),zt(N[S],v._size[S]);var z=v._values,W=v._index,B=v._ptr,se=b.dimension(0),$=b.dimension(1),Q=[],K=[];se.forEach(function(we,Ne){K[we]=Ne[0],Q[we]=!0});var j=z?[]:void 0,ie=[],de=[];return $.forEach(function(we){for(de.push(ie.length),T=B[we],m=B[we+1];T<m;T++)S=W[T],Q[S]===!0&&(ie.push(K[S]),j&&j.push(z[T]))}),de.push(ie.length),new i({values:j,index:ie,ptr:de,size:w,datatype:v._datatype})}function u(v,b,y,w){if(!b||b.isIndex!==!0)throw new TypeError("Invalid index");var S=b.size(),L=b.isScalar(),T;if(_n(y)?(T=y.size(),y=y.toArray()):T=yr(y),L){if(T.length!==0)throw new TypeError("Scalar expected");v.set(b.min(),y,w)}else{if(S.length!==1&&S.length!==2)throw new Ut(S.length,v._size.length,"<");if(T.length<S.length){for(var m=0,C=0;S[m]===1&&T[m]===1;)m++;for(;S[m]===1;)C++,m++;y=cf(y,S.length,C,T)}if(!Ja(S,T))throw new Ut(S,T,">");if(S.length===1){var N=b.dimension(0);N.forEach(function(B,se){zt(B),v.set([B,0],y[se[0]],w)})}else{var z=b.dimension(0),W=b.dimension(1);z.forEach(function(B,se){zt(B),W.forEach(function($,Q){zt($),v.set([B,$],y[se[0]][Q[0]],w)})})}}return v}i.prototype.get=function(v){if(!Ot(v))throw new TypeError("Array expected");if(v.length!==this._size.length)throw new Ut(v.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var b=v[0],y=v[1];zt(b,this._size[0]),zt(y,this._size[1]);var w=f(b,this._ptr[y],this._ptr[y+1],this._index);return w<this._ptr[y+1]&&this._index[w]===b?this._values[w]:0},i.prototype.set=function(v,b,y){if(!Ot(v))throw new TypeError("Array expected");if(v.length!==this._size.length)throw new Ut(v.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var w=v[0],S=v[1],L=this._size[0],T=this._size[1],m=t,C=0;Ci(this._datatype)&&(m=e.find(t,[this._datatype,this._datatype])||t,C=e.convert(0,this._datatype)),(w>L-1||S>T-1)&&(d(this,Math.max(w+1,L),Math.max(S+1,T),y),L=this._size[0],T=this._size[1]),zt(w,L),zt(S,T);var N=f(w,this._ptr[S],this._ptr[S+1],this._index);return N<this._ptr[S+1]&&this._index[N]===w?m(b,C)?h(N,S,this._values,this._index,this._ptr):this._values[N]=b:c(N,w,S,b,this._values,this._index,this._ptr),this};function f(v,b,y,w){if(y-b===0)return y;for(var S=b;S<y;S++)if(w[S]===v)return S;return b}function h(v,b,y,w,S){y.splice(v,1),w.splice(v,1);for(var L=b+1;L<S.length;L++)S[L]--}function c(v,b,y,w,S,L,T){S.splice(v,0,w),L.splice(v,0,b);for(var m=y+1;m<T.length;m++)T[m]++}i.prototype.resize=function(v,b,y){if(!Jh(v))throw new TypeError("Array or Matrix expected");var w=v.valueOf().map(L=>Array.isArray(L)&&L.length===1?L[0]:L);if(w.length!==2)throw new Error("Only two dimensions matrix are supported");w.forEach(function(L){if(!Vt(L)||!on(L)||L<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Ln(w)+")")});var S=y?this.clone():this;return d(S,w[0],w[1],b)};function d(v,b,y,w){var S=w||0,L=t,T=0;Ci(v._datatype)&&(L=e.find(t,[v._datatype,v._datatype])||t,T=e.convert(0,v._datatype),S=e.convert(S,v._datatype));var m=!L(S,T),C=v._size[0],N=v._size[1],z,W,B;if(y>N){for(W=N;W<y;W++)if(v._ptr[W]=v._values.length,m)for(z=0;z<C;z++)v._values.push(S),v._index.push(z);v._ptr[y]=v._values.length}else y<N&&(v._ptr.splice(y+1,N-y),v._values.splice(v._ptr[y],v._values.length),v._index.splice(v._ptr[y],v._index.length));if(N=y,b>C){if(m){var se=0;for(W=0;W<N;W++){v._ptr[W]=v._ptr[W]+se,B=v._ptr[W+1]+se;var $=0;for(z=C;z<b;z++,$++)v._values.splice(B+$,0,S),v._index.splice(B+$,0,z),se++}v._ptr[N]=v._values.length}}else if(b<C){var Q=0;for(W=0;W<N;W++){v._ptr[W]=v._ptr[W]-Q;var K=v._ptr[W],j=v._ptr[W+1]-Q;for(B=K;B<j;B++)z=v._index[B],z>b-1&&(v._values.splice(B,1),v._index.splice(B,1),Q++)}v._ptr[W]=v._values.length}return v._size[0]=b,v._size[1]=y,v}i.prototype.reshape=function(v,b){if(!Ot(v))throw new TypeError("Array expected");if(v.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");v.forEach(function(we){if(!Vt(we)||!on(we)||we<=-2||we===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Ln(v)+")")});var y=this._size[0]*this._size[1];v=dc(v,y);var w=v[0]*v[1];if(y!==w)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var S=b?this.clone():this;if(this._size[0]===v[0]&&this._size[1]===v[1])return S;for(var L=[],T=0;T<S._ptr.length;T++)for(var m=0;m<S._ptr[T+1]-S._ptr[T];m++)L.push(T);for(var C=S._values.slice(),N=S._index.slice(),z=0;z<S._index.length;z++){var W=N[z],B=L[z],se=W*S._size[1]+B;L[z]=se%v[1],N[z]=Math.floor(se/v[1])}S._values.length=0,S._index.length=0,S._ptr.length=v[1]+1,S._size=v.slice();for(var $=0;$<S._ptr.length;$++)S._ptr[$]=0;for(var Q=0;Q<C.length;Q++){var K=N[Q],j=L[Q],ie=C[Q],de=f(K,S._ptr[j],S._ptr[j+1],S._index);c(de,K,j,ie,S._values,S._index,S._ptr)}return S},i.prototype.clone=function(){var v=new i({values:this._values?an(this._values):void 0,index:an(this._index),ptr:an(this._ptr),size:an(this._size),datatype:this._datatype});return v},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(v,b){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var y=this,w=this._size[0],S=this._size[1],L=function(m,C,N){return v(m,[C,N],y)};return g(this,0,w-1,0,S-1,L,b)};function g(v,b,y,w,S,L,T){var m=[],C=[],N=[],z=t,W=0;Ci(v._datatype)&&(z=e.find(t,[v._datatype,v._datatype])||t,W=e.convert(0,v._datatype));for(var B=function(ue,Ee,Oe){ue=L(ue,Ee,Oe),z(ue,W)||(m.push(ue),C.push(Ee))},se=w;se<=S;se++){N.push(m.length);var $=v._ptr[se],Q=v._ptr[se+1];if(T)for(var K=$;K<Q;K++){var j=v._index[K];j>=b&&j<=y&&B(v._values[K],j-b,se-w)}else{for(var ie={},de=$;de<Q;de++){var we=v._index[de];ie[we]=v._values[de]}for(var Ne=b;Ne<=y;Ne++){var Se=Ne in ie?ie[Ne]:0;B(Se,Ne-b,se-w)}}}return N.push(m.length),new i({values:m,index:C,ptr:N,size:[y-b+1,S-w+1]})}i.prototype.forEach=function(v,b){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var y=this,w=this._size[0],S=this._size[1],L=0;L<S;L++){var T=this._ptr[L],m=this._ptr[L+1];if(b)for(var C=T;C<m;C++){var N=this._index[C];v(this._values[C],[N,L],y)}else{for(var z={},W=T;W<m;W++){var B=this._index[W];z[B]=this._values[W]}for(var se=0;se<w;se++){var $=se in z?z[se]:0;v($,[se,L],y)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var v=this._size[1],b=0;b<v;b++)for(var y=this._ptr[b],w=this._ptr[b+1],S=y;S<w;S++){var L=this._index[S];yield{value:this._values[S],index:[L,b]}}},i.prototype.toArray=function(){return x(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return x(this._values,this._index,this._ptr,this._size,!1)};function x(v,b,y,w,S){var L=w[0],T=w[1],m=[],C,N;for(C=0;C<L;C++)for(m[C]=[],N=0;N<T;N++)m[C][N]=0;for(N=0;N<T;N++)for(var z=y[N],W=y[N+1],B=z;B<W;B++)C=b[B],m[C][N]=v?S?an(v[B]):v[B]:1;return m}return i.prototype.format=function(v){for(var b=this._size[0],y=this._size[1],w=this.density(),S="Sparse Matrix ["+Ln(b,v)+" x "+Ln(y,v)+"] density: "+Ln(w,v)+`
`,L=0;L<y;L++)for(var T=this._ptr[L],m=this._ptr[L+1],C=T;C<m;C++){var N=this._index[C];S+=`
    (`+Ln(N,v)+", "+Ln(L,v)+") ==> "+(this._values?Ln(this._values[C],v):"X")}return S},i.prototype.toString=function(){return Ln(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(v){if(v){if(ai(v)&&(v=v.toNumber()),!Vt(v)||!on(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var b=v>0?v:0,y=v<0?-v:0,w=this._size[0],S=this._size[1],L=Math.min(w-y,S-b),T=[],m=[],C=[];C[0]=0;for(var N=b;N<S&&T.length<L;N++)for(var z=this._ptr[N],W=this._ptr[N+1],B=z;B<W;B++){var se=this._index[B];if(se===N-b+y){T.push(this._values[B]),m[T.length-1]=se-y;break}}return C.push(T.length),new i({values:T,index:m,ptr:C,size:[L,1]})},i.fromJSON=function(v){return new i(v)},i.diagonal=function(v,b,y,w,S){if(!Ot(v))throw new TypeError("Array expected, size parameter");if(v.length!==2)throw new Error("Only two dimensions matrix are supported");if(v=v.map(function(we){if(ai(we)&&(we=we.toNumber()),!Vt(we)||!on(we)||we<1)throw new Error("Size values must be positive integers");return we}),y){if(ai(y)&&(y=y.toNumber()),!Vt(y)||!on(y))throw new TypeError("The parameter k must be an integer number")}else y=0;var L=t,T=0;Ci(S)&&(L=e.find(t,[S,S])||t,T=e.convert(0,S));var m=y>0?y:0,C=y<0?-y:0,N=v[0],z=v[1],W=Math.min(N-C,z-m),B;if(Ot(b)){if(b.length!==W)throw new Error("Invalid value array length");B=function(Ne){return b[Ne]}}else if(_n(b)){var se=b.size();if(se.length!==1||se[0]!==W)throw new Error("Invalid matrix length");B=function(Ne){return b.get([Ne])}}else B=function(){return b};for(var $=[],Q=[],K=[],j=0;j<z;j++){K.push($.length);var ie=j-m;if(ie>=0&&ie<W){var de=B(ie);L(de,T)||(Q.push(ie+C),$.push(de))}}return K.push($.length),new i({values:$,index:Q,ptr:K,size:[N,z]})},i.prototype.swapRows=function(v,b){if(!Vt(v)||!on(v)||!Vt(b)||!on(b))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return zt(v,this._size[0]),zt(b,this._size[0]),i._swapRows(v,b,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(v,b,y,w,S){for(var L=w[v],T=w[v+1],m=L;m<T;m++)S(y[m],b[m])},i._swapRows=function(v,b,y,w,S,L){for(var T=0;T<y;T++){var m=L[T],C=L[T+1],N=f(v,m,C,S),z=f(b,m,C,S);if(N<C&&z<C&&S[N]===v&&S[z]===b){if(w){var W=w[N];w[N]=w[z],w[z]=W}continue}if(N<C&&S[N]===v&&(z>=C||S[z]!==b)){var B=w?w[N]:void 0;S.splice(z,0,b),w&&w.splice(z,0,B),S.splice(z<=N?N+1:N,1),w&&w.splice(z<=N?N+1:N,1);continue}if(z<C&&S[z]===b&&(N>=C||S[N]!==v)){var se=w?w[z]:void 0;S.splice(N,0,v),w&&w.splice(N,0,se),S.splice(N<=z?z+1:z,1),w&&w.splice(N<=z?z+1:z,1)}}},i},{isClass:!0}),pu="matrix",zg=["typed","Matrix","DenseMatrix","SparseMatrix"],Ug=Ht(pu,zg,r=>{var{typed:e,Matrix:t,DenseMatrix:n,SparseMatrix:i}=r;return e(pu,{"":function(){return s([])},string:function(o){return s([],o)},"string, string":function(o,u){return s([],o,u)},Array:function(o){return s(o)},Matrix:function(o){return s(o,o.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(a,o,u){if(o==="dense"||o==="default"||o===void 0)return new n(a,u);if(o==="sparse")return new i(a,u);throw new TypeError("Unknown matrix type "+JSON.stringify(o)+".")}}),mu="addScalar",kg=["typed"],Hg=Ht(mu,kg,r=>{var{typed:e}=r;return e(mu,{"number, number":Cf,"Complex, Complex":function(n,i){return n.add(i)},"BigNumber, BigNumber":function(n,i){return n.plus(i)},"Fraction, Fraction":function(n,i){return n.add(i)},"Unit, Unit":function(n,i){if(n.value===null||n.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(i))throw new Error("Units do not match");var s=n.clone();return s.value=this(s.value,i.value),s.fixPrefix=!1,s}})}),Vg="algorithm11",Gg=["typed","equalScalar"],Wg=Ht(Vg,Gg,r=>{var{typed:e,equalScalar:t}=r;return function(i,s,a,o){var u=i._values,f=i._index,h=i._ptr,c=i._size,d=i._datatype;if(!u)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var g=c[0],x=c[1],v,b=t,y=0,w=a;typeof d=="string"&&(v=d,b=e.find(t,[v,v]),y=e.convert(0,v),s=e.convert(s,v),w=e.find(a,[v,v]));for(var S=[],L=[],T=[],m=0;m<x;m++){T[m]=L.length;for(var C=h[m],N=h[m+1],z=C;z<N;z++){var W=f[z],B=o?w(s,u[z]):w(u[z],s);b(B,y)||(L.push(W),S.push(B))}}return T[x]=L.length,i.createSparseMatrix({values:S,index:L,ptr:T,size:[g,x],datatype:v})}}),qg="algorithm14",jg=["typed"],Xg=Ht(qg,jg,r=>{var{typed:e}=r;return function(i,s,a,o){var u=i._data,f=i._size,h=i._datatype,c,d=a;typeof h=="string"&&(c=h,s=e.convert(s,c),d=e.find(a,[c,c]));var g=f.length>0?t(d,0,f,f[0],u,s,o):[];return i.createDenseMatrix({data:g,size:an(f),datatype:c})};function t(n,i,s,a,o,u,f){var h=[];if(i===s.length-1)for(var c=0;c<a;c++)h[c]=f?n(u,o[c]):n(o[c],u);else for(var d=0;d<a;d++)h[d]=t(n,i+1,s,s[i+1],o[d],u,f);return h}}),Yg="multiplyScalar",Zg=["typed"],$g=Ht(Yg,Zg,r=>{var{typed:e}=r;return e("multiplyScalar",{"number, number":Lf,"Complex, Complex":function(n,i){return n.mul(i)},"BigNumber, BigNumber":function(n,i){return n.times(i)},"Fraction, Fraction":function(n,i){return n.mul(i)},"number | Fraction | BigNumber | Complex, Unit":function(n,i){var s=i.clone();return s.value=s.value===null?s._normalize(n):this(s.value,n),s},"Unit, number | Fraction | BigNumber | Complex":function(n,i){var s=n.clone();return s.value=s.value===null?s._normalize(i):this(s.value,i),s},"Unit, Unit":function(n,i){return n.multiply(i)}})}),gu="multiply",Jg=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],Qg=Ht(gu,Jg,r=>{var{typed:e,matrix:t,addScalar:n,multiplyScalar:i,equalScalar:s,dot:a}=r,o=Wg({typed:e,equalScalar:s}),u=Xg({typed:e});function f(T,m){switch(T.length){case 1:switch(m.length){case 1:if(T[0]!==m[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(T[0]!==m[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+T[0]+") must match Matrix rows ("+m[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+m.length+" dimensions)")}break;case 2:switch(m.length){case 1:if(T[1]!==m[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+T[1]+") must match Vector length ("+m[0]+")");break;case 2:if(T[1]!==m[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+T[1]+") must match Matrix B rows ("+m[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+m.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+T.length+" dimensions)")}}function h(T,m,C){if(C===0)throw new Error("Cannot multiply two empty vectors");return a(T,m)}function c(T,m){if(m.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return d(T,m)}function d(T,m){var C=T._data,N=T._size,z=T._datatype,W=m._data,B=m._size,se=m._datatype,$=N[0],Q=B[1],K,j=n,ie=i;z&&se&&z===se&&typeof z=="string"&&(K=z,j=e.find(n,[K,K]),ie=e.find(i,[K,K]));for(var de=[],we=0;we<Q;we++){for(var Ne=ie(C[0],W[0][we]),Se=1;Se<$;Se++)Ne=j(Ne,ie(C[Se],W[Se][we]));de[we]=Ne}return T.createDenseMatrix({data:de,size:[Q],datatype:K})}var g=e("_multiplyMatrixVector",{"DenseMatrix, any":v,"SparseMatrix, any":w}),x=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":b,"DenseMatrix, SparseMatrix":y,"SparseMatrix, DenseMatrix":S,"SparseMatrix, SparseMatrix":L});function v(T,m){var C=T._data,N=T._size,z=T._datatype,W=m._data,B=m._datatype,se=N[0],$=N[1],Q,K=n,j=i;z&&B&&z===B&&typeof z=="string"&&(Q=z,K=e.find(n,[Q,Q]),j=e.find(i,[Q,Q]));for(var ie=[],de=0;de<se;de++){for(var we=C[de],Ne=j(we[0],W[0]),Se=1;Se<$;Se++)Ne=K(Ne,j(we[Se],W[Se]));ie[de]=Ne}return T.createDenseMatrix({data:ie,size:[se],datatype:Q})}function b(T,m){var C=T._data,N=T._size,z=T._datatype,W=m._data,B=m._size,se=m._datatype,$=N[0],Q=N[1],K=B[1],j,ie=n,de=i;z&&se&&z===se&&typeof z=="string"&&(j=z,ie=e.find(n,[j,j]),de=e.find(i,[j,j]));for(var we=[],Ne=0;Ne<$;Ne++){var Se=C[Ne];we[Ne]=[];for(var Ve=0;Ve<K;Ve++){for(var ue=de(Se[0],W[0][Ve]),Ee=1;Ee<Q;Ee++)ue=ie(ue,de(Se[Ee],W[Ee][Ve]));we[Ne][Ve]=ue}}return T.createDenseMatrix({data:we,size:[$,K],datatype:j})}function y(T,m){var C=T._data,N=T._size,z=T._datatype,W=m._values,B=m._index,se=m._ptr,$=m._size,Q=m._datatype;if(!W)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var K=N[0],j=$[1],ie,de=n,we=i,Ne=s,Se=0;z&&Q&&z===Q&&typeof z=="string"&&(ie=z,de=e.find(n,[ie,ie]),we=e.find(i,[ie,ie]),Ne=e.find(s,[ie,ie]),Se=e.convert(0,ie));for(var Ve=[],ue=[],Ee=[],Oe=m.createSparseMatrix({values:Ve,index:ue,ptr:Ee,size:[K,j],datatype:ie}),re=0;re<j;re++){Ee[re]=ue.length;var ze=se[re],je=se[re+1];if(je>ze)for(var Ie=0,Be=0;Be<K;Be++){for(var Xe=Be+1,fe=void 0,ge=ze;ge<je;ge++){var Ae=B[ge];Ie!==Xe?(fe=we(C[Be][Ae],W[ge]),Ie=Xe):fe=de(fe,we(C[Be][Ae],W[ge]))}Ie===Xe&&!Ne(fe,Se)&&(ue.push(Be),Ve.push(fe))}}return Ee[j]=ue.length,Oe}function w(T,m){var C=T._values,N=T._index,z=T._ptr,W=T._datatype;if(!C)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var B=m._data,se=m._datatype,$=T._size[0],Q=m._size[0],K=[],j=[],ie=[],de,we=n,Ne=i,Se=s,Ve=0;W&&se&&W===se&&typeof W=="string"&&(de=W,we=e.find(n,[de,de]),Ne=e.find(i,[de,de]),Se=e.find(s,[de,de]),Ve=e.convert(0,de));var ue=[],Ee=[];ie[0]=0;for(var Oe=0;Oe<Q;Oe++){var re=B[Oe];if(!Se(re,Ve))for(var ze=z[Oe],je=z[Oe+1],Ie=ze;Ie<je;Ie++){var Be=N[Ie];Ee[Be]?ue[Be]=we(ue[Be],Ne(re,C[Ie])):(Ee[Be]=!0,j.push(Be),ue[Be]=Ne(re,C[Ie]))}}for(var Xe=j.length,fe=0;fe<Xe;fe++){var ge=j[fe];K[fe]=ue[ge]}return ie[1]=j.length,T.createSparseMatrix({values:K,index:j,ptr:ie,size:[$,1],datatype:de})}function S(T,m){var C=T._values,N=T._index,z=T._ptr,W=T._datatype;if(!C)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var B=m._data,se=m._datatype,$=T._size[0],Q=m._size[0],K=m._size[1],j,ie=n,de=i,we=s,Ne=0;W&&se&&W===se&&typeof W=="string"&&(j=W,ie=e.find(n,[j,j]),de=e.find(i,[j,j]),we=e.find(s,[j,j]),Ne=e.convert(0,j));for(var Se=[],Ve=[],ue=[],Ee=T.createSparseMatrix({values:Se,index:Ve,ptr:ue,size:[$,K],datatype:j}),Oe=[],re=[],ze=0;ze<K;ze++){ue[ze]=Ve.length;for(var je=ze+1,Ie=0;Ie<Q;Ie++){var Be=B[Ie][ze];if(!we(Be,Ne))for(var Xe=z[Ie],fe=z[Ie+1],ge=Xe;ge<fe;ge++){var Ae=N[ge];re[Ae]!==je?(re[Ae]=je,Ve.push(Ae),Oe[Ae]=de(Be,C[ge])):Oe[Ae]=ie(Oe[Ae],de(Be,C[ge]))}}for(var ke=ue[ze],pe=Ve.length,O=ke;O<pe;O++){var F=Ve[O];Se[O]=Oe[F]}}return ue[K]=Ve.length,Ee}function L(T,m){var C=T._values,N=T._index,z=T._ptr,W=T._datatype,B=m._values,se=m._index,$=m._ptr,Q=m._datatype,K=T._size[0],j=m._size[1],ie=C&&B,de,we=n,Ne=i;W&&Q&&W===Q&&typeof W=="string"&&(de=W,we=e.find(n,[de,de]),Ne=e.find(i,[de,de]));for(var Se=ie?[]:void 0,Ve=[],ue=[],Ee=T.createSparseMatrix({values:Se,index:Ve,ptr:ue,size:[K,j],datatype:de}),Oe=ie?[]:void 0,re=[],ze,je,Ie,Be,Xe,fe,ge,Ae,ke=0;ke<j;ke++){ue[ke]=Ve.length;var pe=ke+1;for(Xe=$[ke],fe=$[ke+1],Be=Xe;Be<fe;Be++)if(Ae=se[Be],ie)for(je=z[Ae],Ie=z[Ae+1],ze=je;ze<Ie;ze++)ge=N[ze],re[ge]!==pe?(re[ge]=pe,Ve.push(ge),Oe[ge]=Ne(B[Be],C[ze])):Oe[ge]=we(Oe[ge],Ne(B[Be],C[ze]));else for(je=z[Ae],Ie=z[Ae+1],ze=je;ze<Ie;ze++)ge=N[ze],re[ge]!==pe&&(re[ge]=pe,Ve.push(ge));if(ie)for(var O=ue[ke],F=Ve.length,ye=O;ye<F;ye++){var D=Ve[ye];Se[ye]=Oe[D]}}return ue[j]=Ve.length,Ee}return e(gu,jp({"Array, Array":function(m,C){f(yr(m),yr(C));var N=this(t(m),t(C));return _n(N)?N.valueOf():N},"Matrix, Matrix":function(m,C){var N=m.size(),z=C.size();return f(N,z),N.length===1?z.length===1?h(m,C,N[0]):c(m,C):z.length===1?g(m,C):x(m,C)},"Matrix, Array":function(m,C){return this(m,t(C))},"Array, Matrix":function(m,C){return this(t(m,C.storage()),C)},"SparseMatrix, any":function(m,C){return o(m,C,i,!1)},"DenseMatrix, any":function(m,C){return u(m,C,i,!1)},"any, SparseMatrix":function(m,C){return o(C,m,i,!0)},"any, DenseMatrix":function(m,C){return u(C,m,i,!0)},"Array, any":function(m,C){return u(t(m),C,i,!1).valueOf()},"any, Array":function(m,C){return u(t(C),m,i,!0).valueOf()},"any, any":i,"any, any, ...any":function(m,C,N){for(var z=this(m,C),W=0;W<N.length;W++)z=this(z,N[W]);return z}},i.signatures))}),Kg="sqrt",e0=["config","typed","Complex"],t0=Ht(Kg,e0,r=>{var{config:e,typed:t,Complex:n}=r;return t("sqrt",{number:i,Complex:function(a){return a.sqrt()},BigNumber:function(a){return!a.isNegative()||e.predictable?a.sqrt():i(a.toNumber())},"Array | Matrix":function(a){return _r(a,this)},Unit:function(a){return a.pow(.5)}});function i(s){return isNaN(s)?NaN:s>=0||e.predictable?Math.sqrt(s):new n(s,0).sqrt()}}),vu="conj",n0=["typed"],i0=Ht(vu,n0,r=>{var{typed:e}=r;return e(vu,{number:function(n){return n},BigNumber:function(n){return n},Complex:function(n){return n.conjugate()},"Array | Matrix":function(n){return _r(n,this)}})});function r0(){throw new Error('No "matrix" implementation available')}var yu="size",s0=["typed","config","?matrix"],a0=Ht(yu,s0,r=>{var{typed:e,config:t,matrix:n}=r;return e(yu,{Matrix:function(s){return s.create(s.size())},Array:yr,string:function(s){return t.matrix==="Array"?[s.length]:n([s.length])},"number | Complex | BigNumber | Unit | boolean | null":function(s){return t.matrix==="Array"?[]:n?n([]):r0()}})}),o0="atan",l0=["typed"],c0=Ht(o0,l0,r=>{var{typed:e}=r;return e("atan",{number:function(n){return Math.atan(n)},Complex:function(n){return n.atan()},BigNumber:function(n){return n.atan()},"Array | Matrix":function(n){return _r(n,this)}})}),xu="cos",u0=["typed"],h0=Ht(xu,u0,r=>{var{typed:e}=r;return e(xu,{number:Math.cos,Complex:function(n){return n.cos()},BigNumber:function(n){return n.cos()},Unit:function(n){if(!n.hasBase(n.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return this(n.value)},"Array | Matrix":function(n){return _r(n,this)}})}),_u="sin",f0=["typed"],d0=Ht(_u,f0,r=>{var{typed:e}=r;return e(_u,{number:Math.sin,Complex:function(n){return n.sin()},BigNumber:function(n){return n.sin()},Unit:function(n){if(!n.hasBase(n.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return this(n.value)},"Array | Matrix":function(n){return _r(n,this)}})}),wu="tan",p0=["typed"],m0=Ht(wu,p0,r=>{var{typed:e}=r;return e(wu,{number:Math.tan,Complex:function(n){return n.tan()},BigNumber:function(n){return n.tan()},Unit:function(n){if(!n.hasBase(n.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return this(n.value)},"Array | Matrix":function(n){return _r(n,this)}})}),bu="dot",g0=["typed","addScalar","multiplyScalar","conj","size"],v0=Ht(bu,g0,r=>{var{typed:e,addScalar:t,multiplyScalar:n,conj:i,size:s}=r;return e(bu,{"Array | DenseMatrix, Array | DenseMatrix":o,"SparseMatrix, SparseMatrix":u});function a(h,c){var d=f(h),g=f(c),x,v;if(d.length===1)x=d[0];else if(d.length===2&&d[1]===1)x=d[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+d.join(", ")+")");if(g.length===1)v=g[0];else if(g.length===2&&g[1]===1)v=g[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+g.join(", ")+")");if(x!==v)throw new RangeError("Vectors must have equal length ("+x+" != "+v+")");if(x===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return x}function o(h,c){var d=a(h,c),g=_n(h)?h._data:h,x=_n(h)?h._datatype:void 0,v=_n(c)?c._data:c,b=_n(c)?c._datatype:void 0,y=f(h).length===2,w=f(c).length===2,S=t,L=n;if(x&&b&&x===b&&typeof x=="string"){var T=x;S=e.find(t,[T,T]),L=e.find(n,[T,T])}if(!y&&!w){for(var m=L(i(g[0]),v[0]),C=1;C<d;C++)m=S(m,L(i(g[C]),v[C]));return m}if(!y&&w){for(var N=L(i(g[0]),v[0][0]),z=1;z<d;z++)N=S(N,L(i(g[z]),v[z][0]));return N}if(y&&!w){for(var W=L(i(g[0][0]),v[0]),B=1;B<d;B++)W=S(W,L(i(g[B][0]),v[B]));return W}if(y&&w){for(var se=L(i(g[0][0]),v[0][0]),$=1;$<d;$++)se=S(se,L(i(g[$][0]),v[$][0]));return se}}function u(h,c){a(h,c);for(var d=h._index,g=h._values,x=c._index,v=c._values,b=0,y=t,w=n,S=0,L=0;S<d.length&&L<x.length;){var T=d[S],m=x[L];if(T<m){S++;continue}if(T>m){L++;continue}T===m&&(b=y(b,w(g[S],v[L])),S++,L++)}return b}function f(h){return _n(h)?h.size():s(h)}}),y0=yg({config:ia}),Rf=wg({}),x0=Sg({}),mc=Ag({}),Pf=Rg({Matrix:mc}),Dn=wm({BigNumber:y0,Complex:Rf,DenseMatrix:Pf,Fraction:x0}),Nf=Hg({typed:Dn}),_0=c0({typed:Dn}),w0=i0({typed:Dn}),Df=Ig({config:ia,typed:Dn}),If=$g({typed:Dn}),Vi=d0({typed:Dn}),b0=Og({Matrix:mc,equalScalar:Df,typed:Dn}),M0=m0({typed:Dn}),Xn=h0({typed:Dn}),gc=t0({Complex:Rf,config:ia,typed:Dn}),Ff=Ug({DenseMatrix:Pf,Matrix:mc,SparseMatrix:b0,typed:Dn}),S0=a0({matrix:Ff,config:ia,typed:Dn}),E0=v0({addScalar:Nf,conj:w0,multiplyScalar:If,size:S0,typed:Dn}),tl=Qg({addScalar:Nf,dot:E0,equalScalar:Df,matrix:Ff,multiplyScalar:If,typed:Dn});/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Bf="132",Er={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Tr={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},T0=0,Mu=1,A0=2,Of=1,C0=2,ks=3,$s=0,Jt=1,ss=2,zf=1,Wi=0,Gs=1,Su=2,Eu=3,Tu=4,L0=5,Xr=100,R0=101,P0=102,Au=103,Cu=104,N0=200,D0=201,I0=202,F0=203,Uf=204,kf=205,B0=206,O0=207,z0=208,U0=209,k0=210,H0=0,V0=1,G0=2,Jl=3,W0=4,q0=5,j0=6,X0=7,wo=0,Y0=1,Z0=2,vr=0,$0=1,J0=2,Q0=3,K0=4,ev=5,Hf=300,bo=301,Mo=302,Ql=303,Kl=304,So=306,vc=307,ec=1e3,Vn=1001,tc=1002,nn=1003,Lu=1004,Ru=1005,Yn=1006,tv=1007,Eo=1008,as=1009,nv=1010,iv=1011,ro=1012,rv=1013,Za=1014,mr=1015,es=1016,sv=1017,av=1018,ov=1019,Ws=1020,lv=1021,qi=1022,Gn=1023,cv=1024,uv=1025,hv=Gn,ts=1026,Js=1027,fv=1028,dv=1029,pv=1030,mv=1031,gv=1032,vv=1033,Pu=33776,Nu=33777,Du=33778,Iu=33779,Fu=35840,Bu=35841,Ou=35842,zu=35843,yv=36196,Uu=37492,ku=37496,xv=37808,_v=37809,wv=37810,bv=37811,Mv=37812,Sv=37813,Ev=37814,Tv=37815,Av=37816,Cv=37817,Lv=37818,Rv=37819,Pv=37820,Nv=37821,Dv=36492,Iv=37840,Fv=37841,Bv=37842,Ov=37843,zv=37844,Uv=37845,kv=37846,Hv=37847,Vv=37848,Gv=37849,Wv=37850,qv=37851,jv=37852,Xv=37853,Yv=2200,Zv=2201,$v=2202,so=2300,ao=2301,nl=2302,Zr=2400,$r=2401,oo=2402,yc=2500,Vf=2501,Jv=0,Nn=3e3,To=3001,xc=3007,_c=3002,Qv=3003,Gf=3004,Wf=3005,qf=3006,Kv=3200,ey=3201,us=0,ty=1,il=7680,ny=519,Qs=35044,lo=35048,Hu="300 es";class Ki{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const sn=[];for(let r=0;r<256;r++)sn[r]=(r<16?"0":"")+r.toString(16);const rl=Math.PI/180,nc=180/Math.PI;function pi(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(sn[r&255]+sn[r>>8&255]+sn[r>>16&255]+sn[r>>24&255]+"-"+sn[e&255]+sn[e>>8&255]+"-"+sn[e>>16&15|64]+sn[e>>24&255]+"-"+sn[t&63|128]+sn[t>>8&255]+"-"+sn[t>>16&255]+sn[t>>24&255]+sn[n&255]+sn[n>>8&255]+sn[n>>16&255]+sn[n>>24&255]).toUpperCase()}function Rn(r,e,t){return Math.max(e,Math.min(t,r))}function iy(r,e){return(r%e+e)%e}function sl(r,e,t){return(1-t)*r+t*e}function Vu(r){return(r&r-1)===0&&r!==0}function ry(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}class Fe{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*i+e.x,this.y=s*i+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Fe.prototype.isVector2=!0;class cn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,a,o,u,f){const h=this.elements;return h[0]=e,h[1]=i,h[2]=o,h[3]=t,h[4]=s,h[5]=u,h[6]=n,h[7]=a,h[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],o=n[3],u=n[6],f=n[1],h=n[4],c=n[7],d=n[2],g=n[5],x=n[8],v=i[0],b=i[3],y=i[6],w=i[1],S=i[4],L=i[7],T=i[2],m=i[5],C=i[8];return s[0]=a*v+o*w+u*T,s[3]=a*b+o*S+u*m,s[6]=a*y+o*L+u*C,s[1]=f*v+h*w+c*T,s[4]=f*b+h*S+c*m,s[7]=f*y+h*L+c*C,s[2]=d*v+g*w+x*T,s[5]=d*b+g*S+x*m,s[8]=d*y+g*L+x*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],f=e[7],h=e[8];return t*a*h-t*o*f-n*s*h+n*o*u+i*s*f-i*a*u}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],f=e[7],h=e[8],c=h*a-o*f,d=o*u-h*s,g=f*s-a*u,x=t*c+n*d+i*g;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/x;return e[0]=c*v,e[1]=(i*f-h*n)*v,e[2]=(o*n-i*a)*v,e[3]=d*v,e[4]=(h*t-i*u)*v,e[5]=(i*s-o*t)*v,e[6]=g*v,e[7]=(n*u-f*t)*v,e[8]=(a*t-n*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,a,o){const u=Math.cos(s),f=Math.sin(s);return this.set(n*u,n*f,-n*(u*a+f*o)+a+e,-i*f,i*u,-i*(-f*a+u*o)+o+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,s=i[0],a=i[3],o=i[6],u=i[1],f=i[4],h=i[7];return i[0]=t*s+n*u,i[3]=t*a+n*f,i[6]=t*o+n*h,i[1]=-n*s+t*u,i[4]=-n*a+t*f,i[7]=-n*o+t*h,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}cn.prototype.isMatrix3=!0;let Ar;class hs{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Ar===void 0&&(Ar=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ar.width=e.width,Ar.height=e.height;const n=Ar.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ar}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}let sy=0;class un extends Ki{constructor(e=un.DEFAULT_IMAGE,t=un.DEFAULT_MAPPING,n=Vn,i=Vn,s=Yn,a=Eo,o=Gn,u=as,f=1,h=Nn){super(),Object.defineProperty(this,"id",{value:sy++}),this.uuid=pi(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=f,this.format=o,this.internalFormat=null,this.type=u,this.offset=new Fe(0,0),this.repeat=new Fe(1,1),this.center=new Fe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const i=this.image;if(i.uuid===void 0&&(i.uuid=pi()),!t&&e.images[i.uuid]===void 0){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(al(i[a].image)):s.push(al(i[a]))}else s=al(i);e.images[i.uuid]={uuid:i.uuid,url:s}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Hf)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ec:e.x=e.x-Math.floor(e.x);break;case Vn:e.x=e.x<0?0:1;break;case tc:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case ec:e.y=e.y-Math.floor(e.y);break;case Vn:e.y=e.y<0?0:1;break;case tc:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&this.version++}}un.DEFAULT_IMAGE=void 0;un.DEFAULT_MAPPING=Hf;un.prototype.isTexture=!0;function al(r){return typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&r instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap?hs.getDataURL(r):r.data?{data:Array.prototype.slice.call(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class Ct{constructor(e=0,t=0,n=0,i=1){this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*i+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const u=e.elements,f=u[0],h=u[4],c=u[8],d=u[1],g=u[5],x=u[9],v=u[2],b=u[6],y=u[10];if(Math.abs(h-d)<.01&&Math.abs(c-v)<.01&&Math.abs(x-b)<.01){if(Math.abs(h+d)<.1&&Math.abs(c+v)<.1&&Math.abs(x+b)<.1&&Math.abs(f+g+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(f+1)/2,L=(g+1)/2,T=(y+1)/2,m=(h+d)/4,C=(c+v)/4,N=(x+b)/4;return S>L&&S>T?S<.01?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(S),i=m/n,s=C/n):L>T?L<.01?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(L),n=m/i,s=N/i):T<.01?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(T),n=C/s,i=N/s),this.set(n,i,s,t),this}let w=Math.sqrt((b-x)*(b-x)+(c-v)*(c-v)+(d-h)*(d-h));return Math.abs(w)<.001&&(w=1),this.x=(b-x)/w,this.y=(c-v)/w,this.z=(d-h)/w,this.w=Math.acos((f+g+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Ct.prototype.isVector4=!0;class mi extends Ki{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Ct(0,0,e,t),this.scissorTest=!1,this.viewport=new Ct(0,0,e,t),this.texture=new un(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Yn,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}mi.prototype.isWebGLRenderTarget=!0;class ay extends mi{constructor(e,t,n){super(e,t);const i=this.texture;this.texture=[];for(let s=0;s<n;s++)this.texture[s]=i.clone()}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}ay.prototype.isWebGLMultipleRenderTargets=!0;class jf extends mi{constructor(e,t,n){super(e,t,n),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}jf.prototype.isWebGLMultisampleRenderTarget=!0;class mn{constructor(e=0,t=0,n=0,i=1){this._x=e,this._y=t,this._z=n,this._w=i}static slerp(e,t,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,i)}static slerpFlat(e,t,n,i,s,a,o){let u=n[i+0],f=n[i+1],h=n[i+2],c=n[i+3];const d=s[a+0],g=s[a+1],x=s[a+2],v=s[a+3];if(o===0){e[t+0]=u,e[t+1]=f,e[t+2]=h,e[t+3]=c;return}if(o===1){e[t+0]=d,e[t+1]=g,e[t+2]=x,e[t+3]=v;return}if(c!==v||u!==d||f!==g||h!==x){let b=1-o;const y=u*d+f*g+h*x+c*v,w=y>=0?1:-1,S=1-y*y;if(S>Number.EPSILON){const T=Math.sqrt(S),m=Math.atan2(T,y*w);b=Math.sin(b*m)/T,o=Math.sin(o*m)/T}const L=o*w;if(u=u*b+d*L,f=f*b+g*L,h=h*b+x*L,c=c*b+v*L,b===1-o){const T=1/Math.sqrt(u*u+f*f+h*h+c*c);u*=T,f*=T,h*=T,c*=T}}e[t]=u,e[t+1]=f,e[t+2]=h,e[t+3]=c}static multiplyQuaternionsFlat(e,t,n,i,s,a){const o=n[i],u=n[i+1],f=n[i+2],h=n[i+3],c=s[a],d=s[a+1],g=s[a+2],x=s[a+3];return e[t]=o*x+h*c+u*g-f*d,e[t+1]=u*x+h*d+f*c-o*g,e[t+2]=f*x+h*g+o*d-u*c,e[t+3]=h*x-o*c-u*d-f*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,u=Math.sin,f=o(n/2),h=o(i/2),c=o(s/2),d=u(n/2),g=u(i/2),x=u(s/2);switch(a){case"XYZ":this._x=d*h*c+f*g*x,this._y=f*g*c-d*h*x,this._z=f*h*x+d*g*c,this._w=f*h*c-d*g*x;break;case"YXZ":this._x=d*h*c+f*g*x,this._y=f*g*c-d*h*x,this._z=f*h*x-d*g*c,this._w=f*h*c+d*g*x;break;case"ZXY":this._x=d*h*c-f*g*x,this._y=f*g*c+d*h*x,this._z=f*h*x+d*g*c,this._w=f*h*c-d*g*x;break;case"ZYX":this._x=d*h*c-f*g*x,this._y=f*g*c+d*h*x,this._z=f*h*x-d*g*c,this._w=f*h*c+d*g*x;break;case"YZX":this._x=d*h*c+f*g*x,this._y=f*g*c+d*h*x,this._z=f*h*x-d*g*c,this._w=f*h*c-d*g*x;break;case"XZY":this._x=d*h*c-f*g*x,this._y=f*g*c-d*h*x,this._z=f*h*x+d*g*c,this._w=f*h*c+d*g*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],a=t[1],o=t[5],u=t[9],f=t[2],h=t[6],c=t[10],d=n+o+c;if(d>0){const g=.5/Math.sqrt(d+1);this._w=.25/g,this._x=(h-u)*g,this._y=(s-f)*g,this._z=(a-i)*g}else if(n>o&&n>c){const g=2*Math.sqrt(1+n-o-c);this._w=(h-u)/g,this._x=.25*g,this._y=(i+a)/g,this._z=(s+f)/g}else if(o>c){const g=2*Math.sqrt(1+o-n-c);this._w=(s-f)/g,this._x=(i+a)/g,this._y=.25*g,this._z=(u+h)/g}else{const g=2*Math.sqrt(1+c-n-o);this._w=(a-i)/g,this._x=(s+f)/g,this._y=(u+h)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Rn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,a=e._w,o=t._x,u=t._y,f=t._z,h=t._w;return this._x=n*h+a*o+i*f-s*u,this._y=i*h+a*u+s*o-n*f,this._z=s*h+a*f+n*u-i*o,this._w=a*h-n*o-i*u-s*f,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,s=this._z,a=this._w;let o=a*e._w+n*e._x+i*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=i,this._z=s,this;const u=1-o*o;if(u<=Number.EPSILON){const g=1-t;return this._w=g*a+t*this._w,this._x=g*n+t*this._x,this._y=g*i+t*this._y,this._z=g*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const f=Math.sqrt(u),h=Math.atan2(f,o),c=Math.sin((1-t)*h)/f,d=Math.sin(t*h)/f;return this._w=a*c+this._w*d,this._x=n*c+this._x*d,this._y=i*c+this._y*d,this._z=s*c+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){this.copy(e).slerp(t,n)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}mn.prototype.isQuaternion=!0;class V{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Gu.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Gu.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,a=e.y,o=e.z,u=e.w,f=u*t+a*i-o*n,h=u*n+o*t-s*i,c=u*i+s*n-a*t,d=-s*t-a*n-o*i;return this.x=f*u+d*-s+h*-o-c*-a,this.y=h*u+d*-a+c*-s-f*-o,this.z=c*u+d*-o+f*-a-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,a=t.x,o=t.y,u=t.z;return this.x=i*u-s*o,this.y=s*a-n*u,this.z=n*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ol.copy(this).projectOnVector(e),this.sub(ol)}reflect(e){return this.sub(ol.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Rn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}V.prototype.isVector3=!0;const ol=new V,Gu=new mn;class ci{constructor(e=new V(1/0,1/0,1/0),t=new V(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,s=-1/0,a=-1/0,o=-1/0;for(let u=0,f=e.length;u<f;u+=3){const h=e[u],c=e[u+1],d=e[u+2];h<t&&(t=h),c<n&&(n=c),d<i&&(i=d),h>s&&(s=h),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,n,i),this.max.set(s,a,o),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,s=-1/0,a=-1/0,o=-1/0;for(let u=0,f=e.count;u<f;u++){const h=e.getX(u),c=e.getY(u),d=e.getZ(u);h<t&&(t=h),c<n&&(n=c),d<i&&(i=d),h>s&&(s=h),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,n,i),this.max.set(s,a,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Rs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),ll.copy(t.boundingBox),ll.applyMatrix4(e.matrixWorld),this.union(ll));const n=e.children;for(let i=0,s=n.length;i<s;i++)this.expandByObject(n[i]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Rs),Rs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ps),va.subVectors(this.max,Ps),Cr.subVectors(e.a,Ps),Lr.subVectors(e.b,Ps),Rr.subVectors(e.c,Ps),Di.subVectors(Lr,Cr),Ii.subVectors(Rr,Lr),fr.subVectors(Cr,Rr);let t=[0,-Di.z,Di.y,0,-Ii.z,Ii.y,0,-fr.z,fr.y,Di.z,0,-Di.x,Ii.z,0,-Ii.x,fr.z,0,-fr.x,-Di.y,Di.x,0,-Ii.y,Ii.x,0,-fr.y,fr.x,0];return!cl(t,Cr,Lr,Rr,va)||(t=[1,0,0,0,1,0,0,0,1],!cl(t,Cr,Lr,Rr,va))?!1:(ya.crossVectors(Di,Ii),t=[ya.x,ya.y,ya.z],cl(t,Cr,Lr,Rr,va))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Rs.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Rs).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Mi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Mi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Mi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Mi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Mi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Mi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Mi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Mi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Mi),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}ci.prototype.isBox3=!0;const Mi=[new V,new V,new V,new V,new V,new V,new V,new V],Rs=new V,ll=new ci,Cr=new V,Lr=new V,Rr=new V,Di=new V,Ii=new V,fr=new V,Ps=new V,va=new V,ya=new V,dr=new V;function cl(r,e,t,n,i){for(let s=0,a=r.length-3;s<=a;s+=3){dr.fromArray(r,s);const o=i.x*Math.abs(dr.x)+i.y*Math.abs(dr.y)+i.z*Math.abs(dr.z),u=e.dot(dr),f=t.dot(dr),h=n.dot(dr);if(Math.max(-Math.max(u,f,h),Math.min(u,f,h))>o)return!1}return!0}const oy=new ci,Wu=new V,ul=new V,hl=new V;class fs{constructor(e=new V,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):oy.setFromPoints(e).getCenter(n);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){hl.subVectors(e,this.center);const t=hl.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.add(hl.multiplyScalar(i/n)),this.radius+=i}return this}union(e){return ul.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Wu.copy(e.center).add(ul)),this.expandByPoint(Wu.copy(e.center).sub(ul)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Si=new V,fl=new V,xa=new V,Fi=new V,dl=new V,_a=new V,pl=new V;class ds{constructor(e=new V,t=new V(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Si)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Si.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Si.copy(this.direction).multiplyScalar(t).add(this.origin),Si.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){fl.copy(e).add(t).multiplyScalar(.5),xa.copy(t).sub(e).normalize(),Fi.copy(this.origin).sub(fl);const s=e.distanceTo(t)*.5,a=-this.direction.dot(xa),o=Fi.dot(this.direction),u=-Fi.dot(xa),f=Fi.lengthSq(),h=Math.abs(1-a*a);let c,d,g,x;if(h>0)if(c=a*u-o,d=a*o-u,x=s*h,c>=0)if(d>=-x)if(d<=x){const v=1/h;c*=v,d*=v,g=c*(c+a*d+2*o)+d*(a*c+d+2*u)+f}else d=s,c=Math.max(0,-(a*d+o)),g=-c*c+d*(d+2*u)+f;else d=-s,c=Math.max(0,-(a*d+o)),g=-c*c+d*(d+2*u)+f;else d<=-x?(c=Math.max(0,-(-a*s+o)),d=c>0?-s:Math.min(Math.max(-s,-u),s),g=-c*c+d*(d+2*u)+f):d<=x?(c=0,d=Math.min(Math.max(-s,-u),s),g=d*(d+2*u)+f):(c=Math.max(0,-(a*s+o)),d=c>0?s:Math.min(Math.max(-s,-u),s),g=-c*c+d*(d+2*u)+f);else d=a>0?-s:s,c=Math.max(0,-(a*d+o)),g=-c*c+d*(d+2*u)+f;return n&&n.copy(this.direction).multiplyScalar(c).add(this.origin),i&&i.copy(xa).multiplyScalar(d).add(fl),g}intersectSphere(e,t){Si.subVectors(e.center,this.origin);const n=Si.dot(this.direction),i=Si.dot(Si)-n*n,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=n-a,u=n+a;return o<0&&u<0?null:o<0?this.at(u,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,a,o,u;const f=1/this.direction.x,h=1/this.direction.y,c=1/this.direction.z,d=this.origin;return f>=0?(n=(e.min.x-d.x)*f,i=(e.max.x-d.x)*f):(n=(e.max.x-d.x)*f,i=(e.min.x-d.x)*f),h>=0?(s=(e.min.y-d.y)*h,a=(e.max.y-d.y)*h):(s=(e.max.y-d.y)*h,a=(e.min.y-d.y)*h),n>a||s>i||((s>n||n!==n)&&(n=s),(a<i||i!==i)&&(i=a),c>=0?(o=(e.min.z-d.z)*c,u=(e.max.z-d.z)*c):(o=(e.max.z-d.z)*c,u=(e.min.z-d.z)*c),n>u||o>i)||((o>n||n!==n)&&(n=o),(u<i||i!==i)&&(i=u),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,Si)!==null}intersectTriangle(e,t,n,i,s){dl.subVectors(t,e),_a.subVectors(n,e),pl.crossVectors(dl,_a);let a=this.direction.dot(pl),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Fi.subVectors(this.origin,e);const u=o*this.direction.dot(_a.crossVectors(Fi,_a));if(u<0)return null;const f=o*this.direction.dot(dl.cross(Fi));if(f<0||u+f>a)return null;const h=-o*Fi.dot(pl);return h<0?null:this.at(h/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class st{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,a,o,u,f,h,c,d,g,x,v,b){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=i,y[1]=s,y[5]=a,y[9]=o,y[13]=u,y[2]=f,y[6]=h,y[10]=c,y[14]=d,y[3]=g,y[7]=x,y[11]=v,y[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new st().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/Pr.setFromMatrixColumn(e,0).length(),s=1/Pr.setFromMatrixColumn(e,1).length(),a=1/Pr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,i=e.y,s=e.z,a=Math.cos(n),o=Math.sin(n),u=Math.cos(i),f=Math.sin(i),h=Math.cos(s),c=Math.sin(s);if(e.order==="XYZ"){const d=a*h,g=a*c,x=o*h,v=o*c;t[0]=u*h,t[4]=-u*c,t[8]=f,t[1]=g+x*f,t[5]=d-v*f,t[9]=-o*u,t[2]=v-d*f,t[6]=x+g*f,t[10]=a*u}else if(e.order==="YXZ"){const d=u*h,g=u*c,x=f*h,v=f*c;t[0]=d+v*o,t[4]=x*o-g,t[8]=a*f,t[1]=a*c,t[5]=a*h,t[9]=-o,t[2]=g*o-x,t[6]=v+d*o,t[10]=a*u}else if(e.order==="ZXY"){const d=u*h,g=u*c,x=f*h,v=f*c;t[0]=d-v*o,t[4]=-a*c,t[8]=x+g*o,t[1]=g+x*o,t[5]=a*h,t[9]=v-d*o,t[2]=-a*f,t[6]=o,t[10]=a*u}else if(e.order==="ZYX"){const d=a*h,g=a*c,x=o*h,v=o*c;t[0]=u*h,t[4]=x*f-g,t[8]=d*f+v,t[1]=u*c,t[5]=v*f+d,t[9]=g*f-x,t[2]=-f,t[6]=o*u,t[10]=a*u}else if(e.order==="YZX"){const d=a*u,g=a*f,x=o*u,v=o*f;t[0]=u*h,t[4]=v-d*c,t[8]=x*c+g,t[1]=c,t[5]=a*h,t[9]=-o*h,t[2]=-f*h,t[6]=g*c+x,t[10]=d-v*c}else if(e.order==="XZY"){const d=a*u,g=a*f,x=o*u,v=o*f;t[0]=u*h,t[4]=-c,t[8]=f*h,t[1]=d*c+v,t[5]=a*h,t[9]=g*c-x,t[2]=x*c-g,t[6]=o*h,t[10]=v*c+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ly,e,cy)}lookAt(e,t,n){const i=this.elements;return zn.subVectors(e,t),zn.lengthSq()===0&&(zn.z=1),zn.normalize(),Bi.crossVectors(n,zn),Bi.lengthSq()===0&&(Math.abs(n.z)===1?zn.x+=1e-4:zn.z+=1e-4,zn.normalize(),Bi.crossVectors(n,zn)),Bi.normalize(),wa.crossVectors(zn,Bi),i[0]=Bi.x,i[4]=wa.x,i[8]=zn.x,i[1]=Bi.y,i[5]=wa.y,i[9]=zn.y,i[2]=Bi.z,i[6]=wa.z,i[10]=zn.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],o=n[4],u=n[8],f=n[12],h=n[1],c=n[5],d=n[9],g=n[13],x=n[2],v=n[6],b=n[10],y=n[14],w=n[3],S=n[7],L=n[11],T=n[15],m=i[0],C=i[4],N=i[8],z=i[12],W=i[1],B=i[5],se=i[9],$=i[13],Q=i[2],K=i[6],j=i[10],ie=i[14],de=i[3],we=i[7],Ne=i[11],Se=i[15];return s[0]=a*m+o*W+u*Q+f*de,s[4]=a*C+o*B+u*K+f*we,s[8]=a*N+o*se+u*j+f*Ne,s[12]=a*z+o*$+u*ie+f*Se,s[1]=h*m+c*W+d*Q+g*de,s[5]=h*C+c*B+d*K+g*we,s[9]=h*N+c*se+d*j+g*Ne,s[13]=h*z+c*$+d*ie+g*Se,s[2]=x*m+v*W+b*Q+y*de,s[6]=x*C+v*B+b*K+y*we,s[10]=x*N+v*se+b*j+y*Ne,s[14]=x*z+v*$+b*ie+y*Se,s[3]=w*m+S*W+L*Q+T*de,s[7]=w*C+S*B+L*K+T*we,s[11]=w*N+S*se+L*j+T*Ne,s[15]=w*z+S*$+L*ie+T*Se,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],a=e[1],o=e[5],u=e[9],f=e[13],h=e[2],c=e[6],d=e[10],g=e[14],x=e[3],v=e[7],b=e[11],y=e[15];return x*(+s*u*c-i*f*c-s*o*d+n*f*d+i*o*g-n*u*g)+v*(+t*u*g-t*f*d+s*a*d-i*a*g+i*f*h-s*u*h)+b*(+t*f*c-t*o*g-s*a*c+n*a*g+s*o*h-n*f*h)+y*(-i*o*h-t*u*c+t*o*d+i*a*c-n*a*d+n*u*h)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],f=e[7],h=e[8],c=e[9],d=e[10],g=e[11],x=e[12],v=e[13],b=e[14],y=e[15],w=c*b*f-v*d*f+v*u*g-o*b*g-c*u*y+o*d*y,S=x*d*f-h*b*f-x*u*g+a*b*g+h*u*y-a*d*y,L=h*v*f-x*c*f+x*o*g-a*v*g-h*o*y+a*c*y,T=x*c*u-h*v*u-x*o*d+a*v*d+h*o*b-a*c*b,m=t*w+n*S+i*L+s*T;if(m===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/m;return e[0]=w*C,e[1]=(v*d*s-c*b*s-v*i*g+n*b*g+c*i*y-n*d*y)*C,e[2]=(o*b*s-v*u*s+v*i*f-n*b*f-o*i*y+n*u*y)*C,e[3]=(c*u*s-o*d*s-c*i*f+n*d*f+o*i*g-n*u*g)*C,e[4]=S*C,e[5]=(h*b*s-x*d*s+x*i*g-t*b*g-h*i*y+t*d*y)*C,e[6]=(x*u*s-a*b*s-x*i*f+t*b*f+a*i*y-t*u*y)*C,e[7]=(a*d*s-h*u*s+h*i*f-t*d*f-a*i*g+t*u*g)*C,e[8]=L*C,e[9]=(x*c*s-h*v*s-x*n*g+t*v*g+h*n*y-t*c*y)*C,e[10]=(a*v*s-x*o*s+x*n*f-t*v*f-a*n*y+t*o*y)*C,e[11]=(h*o*s-a*c*s-h*n*f+t*c*f+a*n*g-t*o*g)*C,e[12]=T*C,e[13]=(h*v*i-x*c*i+x*n*d-t*v*d-h*n*b+t*c*b)*C,e[14]=(x*o*i-a*v*i-x*n*u+t*v*u+a*n*b-t*o*b)*C,e[15]=(a*c*i-h*o*i+h*n*u-t*c*u-a*n*d+t*o*d)*C,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,a=e.x,o=e.y,u=e.z,f=s*a,h=s*o;return this.set(f*a+n,f*o-i*u,f*u+i*o,0,f*o+i*u,h*o+n,h*u-i*a,0,f*u-i*o,h*u+i*a,s*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,a){return this.set(1,n,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,a=t._y,o=t._z,u=t._w,f=s+s,h=a+a,c=o+o,d=s*f,g=s*h,x=s*c,v=a*h,b=a*c,y=o*c,w=u*f,S=u*h,L=u*c,T=n.x,m=n.y,C=n.z;return i[0]=(1-(v+y))*T,i[1]=(g+L)*T,i[2]=(x-S)*T,i[3]=0,i[4]=(g-L)*m,i[5]=(1-(d+y))*m,i[6]=(b+w)*m,i[7]=0,i[8]=(x+S)*C,i[9]=(b-w)*C,i[10]=(1-(d+v))*C,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let s=Pr.set(i[0],i[1],i[2]).length();const a=Pr.set(i[4],i[5],i[6]).length(),o=Pr.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],ni.copy(this);const f=1/s,h=1/a,c=1/o;return ni.elements[0]*=f,ni.elements[1]*=f,ni.elements[2]*=f,ni.elements[4]*=h,ni.elements[5]*=h,ni.elements[6]*=h,ni.elements[8]*=c,ni.elements[9]*=c,ni.elements[10]*=c,t.setFromRotationMatrix(ni),n.x=s,n.y=a,n.z=o,this}makePerspective(e,t,n,i,s,a){a===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,u=2*s/(t-e),f=2*s/(n-i),h=(t+e)/(t-e),c=(n+i)/(n-i),d=-(a+s)/(a-s),g=-2*a*s/(a-s);return o[0]=u,o[4]=0,o[8]=h,o[12]=0,o[1]=0,o[5]=f,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=g,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,i,s,a){const o=this.elements,u=1/(t-e),f=1/(n-i),h=1/(a-s),c=(t+e)*u,d=(n+i)*f,g=(a+s)*h;return o[0]=2*u,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*f,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-g,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}st.prototype.isMatrix4=!0;const Pr=new V,ni=new st,ly=new V(0,0,0),cy=new V(1,1,1),Bi=new V,wa=new V,zn=new V,qu=new st,ju=new mn;class ps{constructor(e=0,t=0,n=0,i=ps.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],u=i[1],f=i[5],h=i[9],c=i[2],d=i[6],g=i[10];switch(t){case"XYZ":this._y=Math.asin(Rn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,g),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Rn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(o,g),this._z=Math.atan2(u,f)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(Rn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-c,g),this._z=Math.atan2(-a,f)):(this._y=0,this._z=Math.atan2(u,s));break;case"ZYX":this._y=Math.asin(-Rn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(d,g),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-a,f));break;case"YZX":this._z=Math.asin(Rn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-h,f),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(o,g));break;case"XZY":this._z=Math.asin(-Rn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,f),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-h,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return qu.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qu,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return ju.setFromEuler(this),this.setFromQuaternion(ju,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new V(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}ps.prototype.isEuler=!0;ps.DefaultOrder="XYZ";ps.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class uy{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}}let hy=0;const Xu=new V,Nr=new mn,Ei=new st,ba=new V,Ns=new V,fy=new V,dy=new mn,Yu=new V(1,0,0),Zu=new V(0,1,0),$u=new V(0,0,1),py={type:"added"},Ju={type:"removed"};class bt extends Ki{constructor(){super(),Object.defineProperty(this,"id",{value:hy++}),this.uuid=pi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=bt.DefaultUp.clone();const e=new V,t=new ps,n=new mn,i=new V(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new st},normalMatrix:{value:new cn}}),this.matrix=new st,this.matrixWorld=new st,this.matrixAutoUpdate=bt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new uy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Nr.setFromAxisAngle(e,t),this.quaternion.multiply(Nr),this}rotateOnWorldAxis(e,t){return Nr.setFromAxisAngle(e,t),this.quaternion.premultiply(Nr),this}rotateX(e){return this.rotateOnAxis(Yu,e)}rotateY(e){return this.rotateOnAxis(Zu,e)}rotateZ(e){return this.rotateOnAxis($u,e)}translateOnAxis(e,t){return Xu.copy(e).applyQuaternion(this.quaternion),this.position.add(Xu.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Yu,e)}translateY(e){return this.translateOnAxis(Zu,e)}translateZ(e){return this.translateOnAxis($u,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Ei.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ba.copy(e):ba.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ns.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ei.lookAt(Ns,ba,this.up):Ei.lookAt(ba,Ns,this.up),this.quaternion.setFromRotationMatrix(Ei),i&&(Ei.extractRotation(i.matrixWorld),Nr.setFromRotationMatrix(Ei),this.quaternion.premultiply(Nr.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(py)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ju)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ju)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ei.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ei.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ei),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ns,e,fy),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ns,dy,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(o,u){return o[u.uuid]===void 0&&(o[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const u=o.shapes;if(Array.isArray(u))for(let f=0,h=u.length;f<h;f++){const c=u[f];s(e.shapes,c)}else s(e.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let u=0,f=this.material.length;u<f;u++)o.push(s(e.materials,this.material[u]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const u=this.animations[o];i.animations.push(s(e.animations,u))}}if(t){const o=a(e.geometries),u=a(e.materials),f=a(e.textures),h=a(e.images),c=a(e.shapes),d=a(e.skeletons),g=a(e.animations);o.length>0&&(n.geometries=o),u.length>0&&(n.materials=u),f.length>0&&(n.textures=f),h.length>0&&(n.images=h),c.length>0&&(n.shapes=c),d.length>0&&(n.skeletons=d),g.length>0&&(n.animations=g)}return n.object=i,n;function a(o){const u=[];for(const f in o){const h=o[f];delete h.metadata,u.push(h)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}bt.DefaultUp=new V(0,1,0);bt.DefaultMatrixAutoUpdate=!0;bt.prototype.isObject3D=!0;const ii=new V,Ti=new V,ml=new V,Ai=new V,Dr=new V,Ir=new V,Qu=new V,gl=new V,vl=new V,yl=new V;class Yt{constructor(e=new V,t=new V,n=new V){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),ii.subVectors(e,t),i.cross(ii);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,n,i,s){ii.subVectors(i,t),Ti.subVectors(n,t),ml.subVectors(e,t);const a=ii.dot(ii),o=ii.dot(Ti),u=ii.dot(ml),f=Ti.dot(Ti),h=Ti.dot(ml),c=a*f-o*o;if(c===0)return s.set(-2,-1,-1);const d=1/c,g=(f*u-o*h)*d,x=(a*h-o*u)*d;return s.set(1-g-x,x,g)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Ai),Ai.x>=0&&Ai.y>=0&&Ai.x+Ai.y<=1}static getUV(e,t,n,i,s,a,o,u){return this.getBarycoord(e,t,n,i,Ai),u.set(0,0),u.addScaledVector(s,Ai.x),u.addScaledVector(a,Ai.y),u.addScaledVector(o,Ai.z),u}static isFrontFacing(e,t,n,i){return ii.subVectors(n,t),Ti.subVectors(e,t),ii.cross(Ti).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ii.subVectors(this.c,this.b),Ti.subVectors(this.a,this.b),ii.cross(Ti).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Yt.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Yt.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,s){return Yt.getUV(e,this.a,this.b,this.c,t,n,i,s)}containsPoint(e){return Yt.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Yt.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,s=this.c;let a,o;Dr.subVectors(i,n),Ir.subVectors(s,n),gl.subVectors(e,n);const u=Dr.dot(gl),f=Ir.dot(gl);if(u<=0&&f<=0)return t.copy(n);vl.subVectors(e,i);const h=Dr.dot(vl),c=Ir.dot(vl);if(h>=0&&c<=h)return t.copy(i);const d=u*c-h*f;if(d<=0&&u>=0&&h<=0)return a=u/(u-h),t.copy(n).addScaledVector(Dr,a);yl.subVectors(e,s);const g=Dr.dot(yl),x=Ir.dot(yl);if(x>=0&&g<=x)return t.copy(s);const v=g*f-u*x;if(v<=0&&f>=0&&x<=0)return o=f/(f-x),t.copy(n).addScaledVector(Ir,o);const b=h*x-g*c;if(b<=0&&c-h>=0&&g-x>=0)return Qu.subVectors(s,i),o=(c-h)/(c-h+(g-x)),t.copy(i).addScaledVector(Qu,o);const y=1/(b+v+d);return a=v*y,o=d*y,t.copy(n).addScaledVector(Dr,a).addScaledVector(Ir,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let my=0;class yn extends Ki{constructor(){super(),Object.defineProperty(this,"id",{value:my++}),this.uuid=pi(),this.name="",this.type="Material",this.fog=!0,this.blending=Gs,this.side=$s,this.vertexColors=!1,this.opacity=1,this.format=Gn,this.transparent=!1,this.blendSrc=Uf,this.blendDst=kf,this.blendEquation=Xr,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Jl,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ny,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=il,this.stencilZFail=il,this.stencilZPass=il,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===zf;continue}const i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheenTint&&this.sheenTint.isColor&&(n.sheenTint=this.sheenTint.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(n.specularTint=this.specularTint.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(n.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationTint!==void 0&&(n.attenuationTint=this.attenuationTint.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Gs&&(n.blending=this.blending),this.side!==$s&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.format!==Gn&&(n.format=this.format),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function i(s){const a=[];for(const o in s){const u=s[o];delete u.metadata,a.push(u)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let s=0;s!==i;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}yn.prototype.isMaterial=!0;const Xf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ri={h:0,s:0,l:0},Ma={h:0,s:0,l:0};function xl(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}function _l(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function wl(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class Ke{constructor(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this}setRGB(e,t,n){return this.r=e,this.g=t,this.b=n,this}setHSL(e,t,n){if(e=iy(e,1),t=Rn(t,0,1),n=Rn(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,s=2*n-i;this.r=xl(s,i,e+1/3),this.g=xl(s,i,e),this.b=xl(s,i,e-1/3)}return this}setStyle(e){function t(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let i;const s=n[1],a=n[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const o=parseFloat(i[1])/360,u=parseInt(i[2],10)/100,f=parseInt(i[3],10)/100;return t(i[4]),this.setHSL(o,u,f)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=n[1],s=i.length;if(s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Xf[e.toLowerCase()];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,t=2){return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}copyLinearToGamma(e,t=2){const n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=_l(e.r),this.g=_l(e.g),this.b=_l(e.b),this}copyLinearToSRGB(e){return this.r=wl(e.r),this.g=wl(e.g),this.b=wl(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const t=this.r,n=this.g,i=this.b,s=Math.max(t,n,i),a=Math.min(t,n,i);let o,u;const f=(a+s)/2;if(a===s)o=0,u=0;else{const h=s-a;switch(u=f<=.5?h/(s+a):h/(2-s-a),s){case t:o=(n-i)/h+(n<i?6:0);break;case n:o=(i-t)/h+2;break;case i:o=(t-n)/h+4;break}o/=6}return e.h=o,e.s=u,e.l=f,e}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(e,t,n){return this.getHSL(ri),ri.h+=e,ri.s+=t,ri.l+=n,this.setHSL(ri.h,ri.s,ri.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(ri),e.getHSL(Ma);const n=sl(ri.h,Ma.h,t),i=sl(ri.s,Ma.s,t),s=sl(ri.l,Ma.l,t);return this.setHSL(n,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Ke.NAMES=Xf;Ke.prototype.isColor=!0;Ke.prototype.r=1;Ke.prototype.g=1;Ke.prototype.b=1;class Ao extends yn{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Ke(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=wo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Ao.prototype.isMeshBasicMaterial=!0;const Pt=new V,Sa=new Fe;class Kt{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.usage=Qs,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new Ke),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new Fe),t[n++]=a.x,t[n++]=a.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new V),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new Ct),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Sa.fromBufferAttribute(this,t),Sa.applyMatrix3(e),this.setXY(t,Sa.x,Sa.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Pt.fromBufferAttribute(this,t),Pt.applyMatrix3(e),this.setXYZ(t,Pt.x,Pt.y,Pt.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Pt.x=this.getX(t),Pt.y=this.getY(t),Pt.z=this.getZ(t),Pt.applyMatrix4(e),this.setXYZ(t,Pt.x,Pt.y,Pt.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Pt.x=this.getX(t),Pt.y=this.getY(t),Pt.z=this.getZ(t),Pt.applyNormalMatrix(e),this.setXYZ(t,Pt.x,Pt.y,Pt.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Pt.x=this.getX(t),Pt.y=this.getY(t),Pt.z=this.getZ(t),Pt.transformDirection(e),this.setXYZ(t,Pt.x,Pt.y,Pt.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Qs&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}Kt.prototype.isBufferAttribute=!0;class Yf extends Kt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Zf extends Kt{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class gy extends Kt{constructor(e,t,n){super(new Uint16Array(e),t,n)}}gy.prototype.isFloat16BufferAttribute=!0;class qt extends Kt{constructor(e,t,n){super(new Float32Array(e),t,n)}}function $f(r){if(r.length===0)return-1/0;let e=r[0];for(let t=1,n=r.length;t<n;++t)r[t]>e&&(e=r[t]);return e}let vy=0;const jn=new st,bl=new bt,Fr=new V,Un=new ci,Ds=new ci,tn=new V;class Rt extends Ki{constructor(){super(),Object.defineProperty(this,"id",{value:vy++}),this.uuid=pi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new($f(e)>65535?Zf:Yf)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new cn().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return jn.makeRotationFromQuaternion(e),this.applyMatrix4(jn),this}rotateX(e){return jn.makeRotationX(e),this.applyMatrix4(jn),this}rotateY(e){return jn.makeRotationY(e),this.applyMatrix4(jn),this}rotateZ(e){return jn.makeRotationZ(e),this.applyMatrix4(jn),this}translate(e,t,n){return jn.makeTranslation(e,t,n),this.applyMatrix4(jn),this}scale(e,t,n){return jn.makeScale(e,t,n),this.applyMatrix4(jn),this}lookAt(e){return bl.lookAt(e),bl.updateMatrix(),this.applyMatrix4(bl.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fr).negate(),this.translate(Fr.x,Fr.y,Fr.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new qt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ci);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new V(-1/0,-1/0,-1/0),new V(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const s=t[n];Un.setFromBufferAttribute(s),this.morphTargetsRelative?(tn.addVectors(this.boundingBox.min,Un.min),this.boundingBox.expandByPoint(tn),tn.addVectors(this.boundingBox.max,Un.max),this.boundingBox.expandByPoint(tn)):(this.boundingBox.expandByPoint(Un.min),this.boundingBox.expandByPoint(Un.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new fs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new V,1/0);return}if(e){const n=this.boundingSphere.center;if(Un.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];Ds.setFromBufferAttribute(o),this.morphTargetsRelative?(tn.addVectors(Un.min,Ds.min),Un.expandByPoint(tn),tn.addVectors(Un.max,Ds.max),Un.expandByPoint(tn)):(Un.expandByPoint(Ds.min),Un.expandByPoint(Ds.max))}Un.getCenter(n);let i=0;for(let s=0,a=e.count;s<a;s++)tn.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(tn));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],u=this.morphTargetsRelative;for(let f=0,h=o.count;f<h;f++)tn.fromBufferAttribute(o,f),u&&(Fr.fromBufferAttribute(e,f),tn.add(Fr)),i=Math.max(i,n.distanceToSquared(tn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,i=t.position.array,s=t.normal.array,a=t.uv.array,o=i.length/3;t.tangent===void 0&&this.setAttribute("tangent",new Kt(new Float32Array(4*o),4));const u=t.tangent.array,f=[],h=[];for(let W=0;W<o;W++)f[W]=new V,h[W]=new V;const c=new V,d=new V,g=new V,x=new Fe,v=new Fe,b=new Fe,y=new V,w=new V;function S(W,B,se){c.fromArray(i,W*3),d.fromArray(i,B*3),g.fromArray(i,se*3),x.fromArray(a,W*2),v.fromArray(a,B*2),b.fromArray(a,se*2),d.sub(c),g.sub(c),v.sub(x),b.sub(x);const $=1/(v.x*b.y-b.x*v.y);!isFinite($)||(y.copy(d).multiplyScalar(b.y).addScaledVector(g,-v.y).multiplyScalar($),w.copy(g).multiplyScalar(v.x).addScaledVector(d,-b.x).multiplyScalar($),f[W].add(y),f[B].add(y),f[se].add(y),h[W].add(w),h[B].add(w),h[se].add(w))}let L=this.groups;L.length===0&&(L=[{start:0,count:n.length}]);for(let W=0,B=L.length;W<B;++W){const se=L[W],$=se.start,Q=se.count;for(let K=$,j=$+Q;K<j;K+=3)S(n[K+0],n[K+1],n[K+2])}const T=new V,m=new V,C=new V,N=new V;function z(W){C.fromArray(s,W*3),N.copy(C);const B=f[W];T.copy(B),T.sub(C.multiplyScalar(C.dot(B))).normalize(),m.crossVectors(N,B);const $=m.dot(h[W])<0?-1:1;u[W*4]=T.x,u[W*4+1]=T.y,u[W*4+2]=T.z,u[W*4+3]=$}for(let W=0,B=L.length;W<B;++W){const se=L[W],$=se.start,Q=se.count;for(let K=$,j=$+Q;K<j;K+=3)z(n[K+0]),z(n[K+1]),z(n[K+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Kt(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let d=0,g=n.count;d<g;d++)n.setXYZ(d,0,0,0);const i=new V,s=new V,a=new V,o=new V,u=new V,f=new V,h=new V,c=new V;if(e)for(let d=0,g=e.count;d<g;d+=3){const x=e.getX(d+0),v=e.getX(d+1),b=e.getX(d+2);i.fromBufferAttribute(t,x),s.fromBufferAttribute(t,v),a.fromBufferAttribute(t,b),h.subVectors(a,s),c.subVectors(i,s),h.cross(c),o.fromBufferAttribute(n,x),u.fromBufferAttribute(n,v),f.fromBufferAttribute(n,b),o.add(h),u.add(h),f.add(h),n.setXYZ(x,o.x,o.y,o.z),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(b,f.x,f.y,f.z)}else for(let d=0,g=t.count;d<g;d+=3)i.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),h.subVectors(a,s),c.subVectors(i,s),h.cross(c),n.setXYZ(d+0,h.x,h.y,h.z),n.setXYZ(d+1,h.x,h.y,h.z),n.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(e.attributes[i]===void 0)continue;const a=n[i].array,o=e.attributes[i],u=o.array,f=o.itemSize*t,h=Math.min(u.length,a.length-f);for(let c=0,d=f;c<h;c++,d++)a[d]=u[c]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)tn.fromBufferAttribute(e,t),tn.normalize(),e.setXYZ(t,tn.x,tn.y,tn.z)}toNonIndexed(){function e(o,u){const f=o.array,h=o.itemSize,c=o.normalized,d=new f.constructor(u.length*h);let g=0,x=0;for(let v=0,b=u.length;v<b;v++){o.isInterleavedBufferAttribute?g=u[v]*o.data.stride+o.offset:g=u[v]*h;for(let y=0;y<h;y++)d[x++]=f[g++]}return new Kt(d,h,c)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Rt,n=this.index.array,i=this.attributes;for(const o in i){const u=i[o],f=e(u,n);t.setAttribute(o,f)}const s=this.morphAttributes;for(const o in s){const u=[],f=s[o];for(let h=0,c=f.length;h<c;h++){const d=f[h],g=e(d,n);u.push(g)}t.morphAttributes[o]=u}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,u=a.length;o<u;o++){const f=a[o];t.addGroup(f.start,f.count,f.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const f in u)u[f]!==void 0&&(e[f]=u[f]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n){const f=n[u];e.data.attributes[u]=f.toJSON(e.data)}const i={};let s=!1;for(const u in this.morphAttributes){const f=this.morphAttributes[u],h=[];for(let c=0,d=f.length;c<d;c++){const g=f[c];h.push(g.toJSON(e.data))}h.length>0&&(i[u]=h,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new Rt().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const f in i){const h=i[f];this.setAttribute(f,h.clone(t))}const s=e.morphAttributes;for(const f in s){const h=[],c=s[f];for(let d=0,g=c.length;d<g;d++)h.push(c[d].clone(t));this.morphAttributes[f]=h}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let f=0,h=a.length;f<h;f++){const c=a[f];this.addGroup(c.start,c.count,c.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}Rt.prototype.isBufferGeometry=!0;const Ku=new st,Br=new ds,Ml=new fs,Oi=new V,zi=new V,Ui=new V,Sl=new V,El=new V,Tl=new V,Ea=new V,Ta=new V,Aa=new V,Ca=new Fe,La=new Fe,Ra=new Fe,Al=new V,Pa=new V;class wn extends bt{constructor(e=new Rt,t=new Ao){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,i=this.material,s=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Ml.copy(n.boundingSphere),Ml.applyMatrix4(s),e.ray.intersectsSphere(Ml)===!1)||(Ku.copy(s).invert(),Br.copy(e.ray).applyMatrix4(Ku),n.boundingBox!==null&&Br.intersectsBox(n.boundingBox)===!1))return;let a;if(n.isBufferGeometry){const o=n.index,u=n.attributes.position,f=n.morphAttributes.position,h=n.morphTargetsRelative,c=n.attributes.uv,d=n.attributes.uv2,g=n.groups,x=n.drawRange;if(o!==null)if(Array.isArray(i))for(let v=0,b=g.length;v<b;v++){const y=g[v],w=i[y.materialIndex],S=Math.max(y.start,x.start),L=Math.min(y.start+y.count,x.start+x.count);for(let T=S,m=L;T<m;T+=3){const C=o.getX(T),N=o.getX(T+1),z=o.getX(T+2);a=Na(this,w,e,Br,u,f,h,c,d,C,N,z),a&&(a.faceIndex=Math.floor(T/3),a.face.materialIndex=y.materialIndex,t.push(a))}}else{const v=Math.max(0,x.start),b=Math.min(o.count,x.start+x.count);for(let y=v,w=b;y<w;y+=3){const S=o.getX(y),L=o.getX(y+1),T=o.getX(y+2);a=Na(this,i,e,Br,u,f,h,c,d,S,L,T),a&&(a.faceIndex=Math.floor(y/3),t.push(a))}}else if(u!==void 0)if(Array.isArray(i))for(let v=0,b=g.length;v<b;v++){const y=g[v],w=i[y.materialIndex],S=Math.max(y.start,x.start),L=Math.min(y.start+y.count,x.start+x.count);for(let T=S,m=L;T<m;T+=3){const C=T,N=T+1,z=T+2;a=Na(this,w,e,Br,u,f,h,c,d,C,N,z),a&&(a.faceIndex=Math.floor(T/3),a.face.materialIndex=y.materialIndex,t.push(a))}}else{const v=Math.max(0,x.start),b=Math.min(u.count,x.start+x.count);for(let y=v,w=b;y<w;y+=3){const S=y,L=y+1,T=y+2;a=Na(this,i,e,Br,u,f,h,c,d,S,L,T),a&&(a.faceIndex=Math.floor(y/3),t.push(a))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}wn.prototype.isMesh=!0;function yy(r,e,t,n,i,s,a,o){let u;if(e.side===Jt?u=n.intersectTriangle(a,s,i,!0,o):u=n.intersectTriangle(i,s,a,e.side!==ss,o),u===null)return null;Pa.copy(o),Pa.applyMatrix4(r.matrixWorld);const f=t.ray.origin.distanceTo(Pa);return f<t.near||f>t.far?null:{distance:f,point:Pa.clone(),object:r}}function Na(r,e,t,n,i,s,a,o,u,f,h,c){Oi.fromBufferAttribute(i,f),zi.fromBufferAttribute(i,h),Ui.fromBufferAttribute(i,c);const d=r.morphTargetInfluences;if(s&&d){Ea.set(0,0,0),Ta.set(0,0,0),Aa.set(0,0,0);for(let x=0,v=s.length;x<v;x++){const b=d[x],y=s[x];b!==0&&(Sl.fromBufferAttribute(y,f),El.fromBufferAttribute(y,h),Tl.fromBufferAttribute(y,c),a?(Ea.addScaledVector(Sl,b),Ta.addScaledVector(El,b),Aa.addScaledVector(Tl,b)):(Ea.addScaledVector(Sl.sub(Oi),b),Ta.addScaledVector(El.sub(zi),b),Aa.addScaledVector(Tl.sub(Ui),b)))}Oi.add(Ea),zi.add(Ta),Ui.add(Aa)}r.isSkinnedMesh&&(r.boneTransform(f,Oi),r.boneTransform(h,zi),r.boneTransform(c,Ui));const g=yy(r,e,t,n,Oi,zi,Ui,Al);if(g){o&&(Ca.fromBufferAttribute(o,f),La.fromBufferAttribute(o,h),Ra.fromBufferAttribute(o,c),g.uv=Yt.getUV(Al,Oi,zi,Ui,Ca,La,Ra,new Fe)),u&&(Ca.fromBufferAttribute(u,f),La.fromBufferAttribute(u,h),Ra.fromBufferAttribute(u,c),g.uv2=Yt.getUV(Al,Oi,zi,Ui,Ca,La,Ra,new Fe));const x={a:f,b:h,c,normal:new V,materialIndex:0};Yt.getNormal(Oi,zi,Ui,x.normal),g.face=x}return g}class ra extends Rt{constructor(e=1,t=1,n=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const u=[],f=[],h=[],c=[];let d=0,g=0;x("z","y","x",-1,-1,n,t,e,a,s,0),x("z","y","x",1,-1,n,t,-e,a,s,1),x("x","z","y",1,1,e,n,t,i,a,2),x("x","z","y",1,-1,e,n,-t,i,a,3),x("x","y","z",1,-1,e,t,n,i,s,4),x("x","y","z",-1,-1,e,t,-n,i,s,5),this.setIndex(u),this.setAttribute("position",new qt(f,3)),this.setAttribute("normal",new qt(h,3)),this.setAttribute("uv",new qt(c,2));function x(v,b,y,w,S,L,T,m,C,N,z){const W=L/C,B=T/N,se=L/2,$=T/2,Q=m/2,K=C+1,j=N+1;let ie=0,de=0;const we=new V;for(let Ne=0;Ne<j;Ne++){const Se=Ne*B-$;for(let Ve=0;Ve<K;Ve++){const ue=Ve*W-se;we[v]=ue*w,we[b]=Se*S,we[y]=Q,f.push(we.x,we.y,we.z),we[v]=0,we[b]=0,we[y]=m>0?1:-1,h.push(we.x,we.y,we.z),c.push(Ve/C),c.push(1-Ne/N),ie+=1}}for(let Ne=0;Ne<N;Ne++)for(let Se=0;Se<C;Se++){const Ve=d+Se+K*Ne,ue=d+Se+K*(Ne+1),Ee=d+(Se+1)+K*(Ne+1),Oe=d+(Se+1)+K*Ne;u.push(Ve,ue,Oe),u.push(ue,Ee,Oe),de+=6}o.addGroup(g,de,z),g+=de,d+=ie}}static fromJSON(e){return new ra(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function os(r){const e={};for(const t in r){e[t]={};for(const n in r[t]){const i=r[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function pn(r){const e={};for(let t=0;t<r.length;t++){const n=os(r[t]);for(const i in n)e[i]=n[i]}return e}const xy={clone:os,merge:pn};var _y=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,wy=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class xr extends yn{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=_y,this.fragmentShader=wy,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=os(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}xr.prototype.isShaderMaterial=!0;class wc extends bt{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new st,this.projectionMatrix=new st,this.projectionMatrixInverse=new st}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}wc.prototype.isCamera=!0;class xn extends wc{constructor(e=50,t=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=nc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(rl*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return nc*2*Math.atan(Math.tan(rl*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(rl*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const u=a.fullWidth,f=a.fullHeight;s+=a.offsetX*i/u,t-=a.offsetY*n/f,i*=a.width/u,n*=a.height/f}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}xn.prototype.isPerspectiveCamera=!0;const Or=90,zr=1;class bc extends bt{constructor(e,t,n){if(super(),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const i=new xn(Or,zr,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new V(1,0,0)),this.add(i);const s=new xn(Or,zr,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new V(-1,0,0)),this.add(s);const a=new xn(Or,zr,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new V(0,1,0)),this.add(a);const o=new xn(Or,zr,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new V(0,-1,0)),this.add(o);const u=new xn(Or,zr,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new V(0,0,1)),this.add(u);const f=new xn(Or,zr,e,t);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new V(0,0,-1)),this.add(f)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[i,s,a,o,u,f]=this.children,h=e.xr.enabled,c=e.getRenderTarget();e.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,f),e.setRenderTarget(c),e.xr.enabled=h}}class Co extends un{constructor(e,t,n,i,s,a,o,u,f,h){e=e!==void 0?e:[],t=t!==void 0?t:bo,o=o!==void 0?o:qi,super(e,t,n,i,s,a,o,u,f,h),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Co.prototype.isCubeTexture=!0;class Jf extends mi{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),super(e,e,t),t=t||{},this.texture=new Co(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Yn,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=Gn,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ra(5,5,5),s=new xr({name:"CubemapFromEquirect",uniforms:os(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Jt,blending:Wi});s.uniforms.tEquirect.value=t;const a=new wn(i,s),o=t.minFilter;return t.minFilter===Eo&&(t.minFilter=Yn),new bc(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,i){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,i);e.setRenderTarget(s)}}Jf.prototype.isWebGLCubeRenderTarget=!0;const Cl=new V,by=new V,My=new cn;class Li{constructor(e=new V(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Cl.subVectors(n,t).cross(by.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(Cl),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||My.getNormalMatrix(e),i=this.coplanarPoint(Cl).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}Li.prototype.isPlane=!0;const Ur=new fs,Da=new V;class Lo{constructor(e=new Li,t=new Li,n=new Li,i=new Li,s=new Li,a=new Li){this.planes=[e,t,n,i,s,a]}set(e,t,n,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],s=n[1],a=n[2],o=n[3],u=n[4],f=n[5],h=n[6],c=n[7],d=n[8],g=n[9],x=n[10],v=n[11],b=n[12],y=n[13],w=n[14],S=n[15];return t[0].setComponents(o-i,c-u,v-d,S-b).normalize(),t[1].setComponents(o+i,c+u,v+d,S+b).normalize(),t[2].setComponents(o+s,c+f,v+g,S+y).normalize(),t[3].setComponents(o-s,c-f,v-g,S-y).normalize(),t[4].setComponents(o-a,c-h,v-x,S-w).normalize(),t[5].setComponents(o+a,c+h,v+x,S+w).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Ur.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ur)}intersectsSprite(e){return Ur.center.set(0,0,0),Ur.radius=.7071067811865476,Ur.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ur)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Da.x=i.normal.x>0?e.max.x:e.min.x,Da.y=i.normal.y>0?e.max.y:e.min.y,Da.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Da)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Qf(){let r=null,e=!1,t=null,n=null;function i(s,a){t(s,a),n=r.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=r.requestAnimationFrame(i),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){r=s}}}function Sy(r,e){const t=e.isWebGL2,n=new WeakMap;function i(f,h){const c=f.array,d=f.usage,g=r.createBuffer();r.bindBuffer(h,g),r.bufferData(h,c,d),f.onUploadCallback();let x=5126;return c instanceof Float32Array?x=5126:c instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):c instanceof Uint16Array?f.isFloat16BufferAttribute?t?x=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):x=5123:c instanceof Int16Array?x=5122:c instanceof Uint32Array?x=5125:c instanceof Int32Array?x=5124:c instanceof Int8Array?x=5120:(c instanceof Uint8Array||c instanceof Uint8ClampedArray)&&(x=5121),{buffer:g,type:x,bytesPerElement:c.BYTES_PER_ELEMENT,version:f.version}}function s(f,h,c){const d=h.array,g=h.updateRange;r.bindBuffer(c,f),g.count===-1?r.bufferSubData(c,0,d):(t?r.bufferSubData(c,g.offset*d.BYTES_PER_ELEMENT,d,g.offset,g.count):r.bufferSubData(c,g.offset*d.BYTES_PER_ELEMENT,d.subarray(g.offset,g.offset+g.count)),g.count=-1)}function a(f){return f.isInterleavedBufferAttribute&&(f=f.data),n.get(f)}function o(f){f.isInterleavedBufferAttribute&&(f=f.data);const h=n.get(f);h&&(r.deleteBuffer(h.buffer),n.delete(f))}function u(f,h){if(f.isGLBufferAttribute){const d=n.get(f);(!d||d.version<f.version)&&n.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);const c=n.get(f);c===void 0?n.set(f,i(f,h)):c.version<f.version&&(s(c.buffer,f,h),c.version=f.version)}return{get:a,remove:o,update:u}}class Mc extends Rt{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(n),u=Math.floor(i),f=o+1,h=u+1,c=e/o,d=t/u,g=[],x=[],v=[],b=[];for(let y=0;y<h;y++){const w=y*d-a;for(let S=0;S<f;S++){const L=S*c-s;x.push(L,-w,0),v.push(0,0,1),b.push(S/o),b.push(1-y/u)}}for(let y=0;y<u;y++)for(let w=0;w<o;w++){const S=w+f*y,L=w+f*(y+1),T=w+1+f*(y+1),m=w+1+f*y;g.push(S,L,m),g.push(L,T,m)}this.setIndex(g),this.setAttribute("position",new qt(x,3)),this.setAttribute("normal",new qt(v,3)),this.setAttribute("uv",new qt(b,2))}static fromJSON(e){return new Mc(e.width,e.height,e.widthSegments,e.heightSegments)}}var Ey=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Ty=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Ay=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Cy=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Ly=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Ry=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Py="vec3 transformed = vec3( position );",Ny=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Dy=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotVH = saturate( dot( geometry.viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float NoH ) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float NoV, float NoL ) {
	return saturate( 1.0 / ( 4.0 * ( NoL + NoV - NoL * NoV ) ) );
}
vec3 BRDF_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,Iy=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Fy=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,By=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Oy=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,zy=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Uy=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,ky=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Hy=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Vy=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Gy=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Wy=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,qy=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,jy=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Xy=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Yy=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Zy=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,$y="gl_FragColor = linearToOutputTexel( gl_FragColor );",Jy=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,Qy=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		envColor = envMapTexelToLinear( envColor );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Ky=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,ex=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,tx=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,nx=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,ix=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,rx=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,sx=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,ax=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ox=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lx=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,cx=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ux=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,hx=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,fx=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in GeometricContext geometry ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,dx=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,px=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,mx=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,gx=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,vx=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularTintFactor = specularTint;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARTINTMAP
			specularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularTintFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenTint = sheenTint;
#endif`,yx=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenTint;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += irradiance * BRDF_Sheen( material.roughness, directLight.direction, geometry, material.sheenTint );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,xx=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,_x=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,wx=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,bx=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Mx=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Sx=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Ex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Tx=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,Ax=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Cx=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Lx=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Rx=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Px=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Nx=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,Dx=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,Ix=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,Fx=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Bx=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Ox=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,zx=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Ux=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,kx=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Hx=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Vx=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Gx=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Wx=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,qx=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,jx=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Xx=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Yx=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Zx=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,$x=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Jx=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Qx=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Kx=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,e_=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,t_=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,n_=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,i_=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,r_=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,s_=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,a_=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,o_=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,l_=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,c_=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,u_=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationTint, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = transmission.a;
#endif`,h_=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationTint;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( float roughness, float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,f_=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,d_=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,p_=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,m_=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,g_=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,v_=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,y_=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,x_=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,__=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,w_=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,b_=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,M_=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,S_=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,E_=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,T_=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,A_=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,C_=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,L_=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,R_=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,P_=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N_=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,D_=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,I_=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,F_=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,B_=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,O_=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,z_=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,U_=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,k_=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,H_=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularTint;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARTINTMAP
		uniform sampler2D specularTintMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenTint;
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,V_=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,G_=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,W_=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,q_=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,j_=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,X_=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Y_=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Z_=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,$_=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`;const vt={alphamap_fragment:Ey,alphamap_pars_fragment:Ty,alphatest_fragment:Ay,alphatest_pars_fragment:Cy,aomap_fragment:Ly,aomap_pars_fragment:Ry,begin_vertex:Py,beginnormal_vertex:Ny,bsdfs:Dy,bumpmap_pars_fragment:Iy,clipping_planes_fragment:Fy,clipping_planes_pars_fragment:By,clipping_planes_pars_vertex:Oy,clipping_planes_vertex:zy,color_fragment:Uy,color_pars_fragment:ky,color_pars_vertex:Hy,color_vertex:Vy,common:Gy,cube_uv_reflection_fragment:Wy,defaultnormal_vertex:qy,displacementmap_pars_vertex:jy,displacementmap_vertex:Xy,emissivemap_fragment:Yy,emissivemap_pars_fragment:Zy,encodings_fragment:$y,encodings_pars_fragment:Jy,envmap_fragment:Qy,envmap_common_pars_fragment:Ky,envmap_pars_fragment:ex,envmap_pars_vertex:tx,envmap_physical_pars_fragment:fx,envmap_vertex:nx,fog_vertex:ix,fog_pars_vertex:rx,fog_fragment:sx,fog_pars_fragment:ax,gradientmap_pars_fragment:ox,lightmap_fragment:lx,lightmap_pars_fragment:cx,lights_lambert_vertex:ux,lights_pars_begin:hx,lights_toon_fragment:dx,lights_toon_pars_fragment:px,lights_phong_fragment:mx,lights_phong_pars_fragment:gx,lights_physical_fragment:vx,lights_physical_pars_fragment:yx,lights_fragment_begin:xx,lights_fragment_maps:_x,lights_fragment_end:wx,logdepthbuf_fragment:bx,logdepthbuf_pars_fragment:Mx,logdepthbuf_pars_vertex:Sx,logdepthbuf_vertex:Ex,map_fragment:Tx,map_pars_fragment:Ax,map_particle_fragment:Cx,map_particle_pars_fragment:Lx,metalnessmap_fragment:Rx,metalnessmap_pars_fragment:Px,morphnormal_vertex:Nx,morphtarget_pars_vertex:Dx,morphtarget_vertex:Ix,normal_fragment_begin:Fx,normal_fragment_maps:Bx,normal_pars_fragment:Ox,normal_pars_vertex:zx,normal_vertex:Ux,normalmap_pars_fragment:kx,clearcoat_normal_fragment_begin:Hx,clearcoat_normal_fragment_maps:Vx,clearcoat_pars_fragment:Gx,output_fragment:Wx,packing:qx,premultiplied_alpha_fragment:jx,project_vertex:Xx,dithering_fragment:Yx,dithering_pars_fragment:Zx,roughnessmap_fragment:$x,roughnessmap_pars_fragment:Jx,shadowmap_pars_fragment:Qx,shadowmap_pars_vertex:Kx,shadowmap_vertex:e_,shadowmask_pars_fragment:t_,skinbase_vertex:n_,skinning_pars_vertex:i_,skinning_vertex:r_,skinnormal_vertex:s_,specularmap_fragment:a_,specularmap_pars_fragment:o_,tonemapping_fragment:l_,tonemapping_pars_fragment:c_,transmission_fragment:u_,transmission_pars_fragment:h_,uv_pars_fragment:f_,uv_pars_vertex:d_,uv_vertex:p_,uv2_pars_fragment:m_,uv2_pars_vertex:g_,uv2_vertex:v_,worldpos_vertex:y_,background_frag:x_,background_vert:__,cube_frag:w_,cube_vert:b_,depth_frag:M_,depth_vert:S_,distanceRGBA_frag:E_,distanceRGBA_vert:T_,equirect_frag:A_,equirect_vert:C_,linedashed_frag:L_,linedashed_vert:R_,meshbasic_frag:P_,meshbasic_vert:N_,meshlambert_frag:D_,meshlambert_vert:I_,meshmatcap_frag:F_,meshmatcap_vert:B_,meshnormal_frag:O_,meshnormal_vert:z_,meshphong_frag:U_,meshphong_vert:k_,meshphysical_frag:H_,meshphysical_vert:V_,meshtoon_frag:G_,meshtoon_vert:W_,points_frag:q_,points_vert:j_,shadow_frag:X_,shadow_vert:Y_,sprite_frag:Z_,sprite_vert:$_},We={common:{diffuse:{value:new Ke(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new cn},uv2Transform:{value:new cn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Fe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ke(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ke(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new cn}},sprite:{diffuse:{value:new Ke(16777215)},opacity:{value:1},center:{value:new Fe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new cn}}},fi={basic:{uniforms:pn([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.fog]),vertexShader:vt.meshbasic_vert,fragmentShader:vt.meshbasic_frag},lambert:{uniforms:pn([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.fog,We.lights,{emissive:{value:new Ke(0)}}]),vertexShader:vt.meshlambert_vert,fragmentShader:vt.meshlambert_frag},phong:{uniforms:pn([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.fog,We.lights,{emissive:{value:new Ke(0)},specular:{value:new Ke(1118481)},shininess:{value:30}}]),vertexShader:vt.meshphong_vert,fragmentShader:vt.meshphong_frag},standard:{uniforms:pn([We.common,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.roughnessmap,We.metalnessmap,We.fog,We.lights,{emissive:{value:new Ke(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:vt.meshphysical_vert,fragmentShader:vt.meshphysical_frag},toon:{uniforms:pn([We.common,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.gradientmap,We.fog,We.lights,{emissive:{value:new Ke(0)}}]),vertexShader:vt.meshtoon_vert,fragmentShader:vt.meshtoon_frag},matcap:{uniforms:pn([We.common,We.bumpmap,We.normalmap,We.displacementmap,We.fog,{matcap:{value:null}}]),vertexShader:vt.meshmatcap_vert,fragmentShader:vt.meshmatcap_frag},points:{uniforms:pn([We.points,We.fog]),vertexShader:vt.points_vert,fragmentShader:vt.points_frag},dashed:{uniforms:pn([We.common,We.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:vt.linedashed_vert,fragmentShader:vt.linedashed_frag},depth:{uniforms:pn([We.common,We.displacementmap]),vertexShader:vt.depth_vert,fragmentShader:vt.depth_frag},normal:{uniforms:pn([We.common,We.bumpmap,We.normalmap,We.displacementmap,{opacity:{value:1}}]),vertexShader:vt.meshnormal_vert,fragmentShader:vt.meshnormal_frag},sprite:{uniforms:pn([We.sprite,We.fog]),vertexShader:vt.sprite_vert,fragmentShader:vt.sprite_frag},background:{uniforms:{uvTransform:{value:new cn},t2D:{value:null}},vertexShader:vt.background_vert,fragmentShader:vt.background_frag},cube:{uniforms:pn([We.envmap,{opacity:{value:1}}]),vertexShader:vt.cube_vert,fragmentShader:vt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:vt.equirect_vert,fragmentShader:vt.equirect_frag},distanceRGBA:{uniforms:pn([We.common,We.displacementmap,{referencePosition:{value:new V},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:vt.distanceRGBA_vert,fragmentShader:vt.distanceRGBA_frag},shadow:{uniforms:pn([We.lights,We.fog,{color:{value:new Ke(0)},opacity:{value:1}}]),vertexShader:vt.shadow_vert,fragmentShader:vt.shadow_frag}};fi.physical={uniforms:pn([fi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Fe(1,1)},clearcoatNormalMap:{value:null},sheenTint:{value:new Ke(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Fe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new Ke(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new Ke(1,1,1)},specularTintMap:{value:null}}]),vertexShader:vt.meshphysical_vert,fragmentShader:vt.meshphysical_frag};function J_(r,e,t,n,i){const s=new Ke(0);let a=0,o,u,f=null,h=0,c=null;function d(x,v){let b=!1,y=v.isScene===!0?v.background:null;y&&y.isTexture&&(y=e.get(y));const w=r.xr,S=w.getSession&&w.getSession();S&&S.environmentBlendMode==="additive"&&(y=null),y===null?g(s,a):y&&y.isColor&&(g(y,1),b=!0),(r.autoClear||b)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),y&&(y.isCubeTexture||y.mapping===So)?(u===void 0&&(u=new wn(new ra(1,1,1),new xr({name:"BackgroundCubeMaterial",uniforms:os(fi.cube.uniforms),vertexShader:fi.cube.vertexShader,fragmentShader:fi.cube.fragmentShader,side:Jt,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(L,T,m){this.matrixWorld.copyPosition(m.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,(f!==y||h!==y.version||c!==r.toneMapping)&&(u.material.needsUpdate=!0,f=y,h=y.version,c=r.toneMapping),x.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(o===void 0&&(o=new wn(new Mc(2,2),new xr({name:"BackgroundMaterial",uniforms:os(fi.background.uniforms),vertexShader:fi.background.vertexShader,fragmentShader:fi.background.fragmentShader,side:$s,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(o)),o.material.uniforms.t2D.value=y,y.matrixAutoUpdate===!0&&y.updateMatrix(),o.material.uniforms.uvTransform.value.copy(y.matrix),(f!==y||h!==y.version||c!==r.toneMapping)&&(o.material.needsUpdate=!0,f=y,h=y.version,c=r.toneMapping),x.unshift(o,o.geometry,o.material,0,0,null))}function g(x,v){t.buffers.color.setClear(x.r,x.g,x.b,v,i)}return{getClearColor:function(){return s},setClearColor:function(x,v=1){s.set(x),a=v,g(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(x){a=x,g(s,a)},render:d}}function Q_(r,e,t,n){const i=r.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||s!==null,o={},u=v(null);let f=u;function h($,Q,K,j,ie){let de=!1;if(a){const we=x(j,K,Q);f!==we&&(f=we,d(f.object)),de=b(j,ie),de&&y(j,ie)}else{const we=Q.wireframe===!0;(f.geometry!==j.id||f.program!==K.id||f.wireframe!==we)&&(f.geometry=j.id,f.program=K.id,f.wireframe=we,de=!0)}$.isInstancedMesh===!0&&(de=!0),ie!==null&&t.update(ie,34963),de&&(C($,Q,K,j),ie!==null&&r.bindBuffer(34963,t.get(ie).buffer))}function c(){return n.isWebGL2?r.createVertexArray():s.createVertexArrayOES()}function d($){return n.isWebGL2?r.bindVertexArray($):s.bindVertexArrayOES($)}function g($){return n.isWebGL2?r.deleteVertexArray($):s.deleteVertexArrayOES($)}function x($,Q,K){const j=K.wireframe===!0;let ie=o[$.id];ie===void 0&&(ie={},o[$.id]=ie);let de=ie[Q.id];de===void 0&&(de={},ie[Q.id]=de);let we=de[j];return we===void 0&&(we=v(c()),de[j]=we),we}function v($){const Q=[],K=[],j=[];for(let ie=0;ie<i;ie++)Q[ie]=0,K[ie]=0,j[ie]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Q,enabledAttributes:K,attributeDivisors:j,object:$,attributes:{},index:null}}function b($,Q){const K=f.attributes,j=$.attributes;let ie=0;for(const de in j){const we=K[de],Ne=j[de];if(we===void 0||we.attribute!==Ne||we.data!==Ne.data)return!0;ie++}return f.attributesNum!==ie||f.index!==Q}function y($,Q){const K={},j=$.attributes;let ie=0;for(const de in j){const we=j[de],Ne={};Ne.attribute=we,we.data&&(Ne.data=we.data),K[de]=Ne,ie++}f.attributes=K,f.attributesNum=ie,f.index=Q}function w(){const $=f.newAttributes;for(let Q=0,K=$.length;Q<K;Q++)$[Q]=0}function S($){L($,0)}function L($,Q){const K=f.newAttributes,j=f.enabledAttributes,ie=f.attributeDivisors;K[$]=1,j[$]===0&&(r.enableVertexAttribArray($),j[$]=1),ie[$]!==Q&&((n.isWebGL2?r:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"]($,Q),ie[$]=Q)}function T(){const $=f.newAttributes,Q=f.enabledAttributes;for(let K=0,j=Q.length;K<j;K++)Q[K]!==$[K]&&(r.disableVertexAttribArray(K),Q[K]=0)}function m($,Q,K,j,ie,de){n.isWebGL2===!0&&(K===5124||K===5125)?r.vertexAttribIPointer($,Q,K,ie,de):r.vertexAttribPointer($,Q,K,j,ie,de)}function C($,Q,K,j){if(n.isWebGL2===!1&&($.isInstancedMesh||j.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();const ie=j.attributes,de=K.getAttributes(),we=Q.defaultAttributeValues;for(const Ne in de){const Se=de[Ne];if(Se.location>=0){let Ve=ie[Ne];if(Ve===void 0&&(Ne==="instanceMatrix"&&$.instanceMatrix&&(Ve=$.instanceMatrix),Ne==="instanceColor"&&$.instanceColor&&(Ve=$.instanceColor)),Ve!==void 0){const ue=Ve.normalized,Ee=Ve.itemSize,Oe=t.get(Ve);if(Oe===void 0)continue;const re=Oe.buffer,ze=Oe.type,je=Oe.bytesPerElement;if(Ve.isInterleavedBufferAttribute){const Ie=Ve.data,Be=Ie.stride,Xe=Ve.offset;if(Ie&&Ie.isInstancedInterleavedBuffer){for(let fe=0;fe<Se.locationSize;fe++)L(Se.location+fe,Ie.meshPerAttribute);$.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=Ie.meshPerAttribute*Ie.count)}else for(let fe=0;fe<Se.locationSize;fe++)S(Se.location+fe);r.bindBuffer(34962,re);for(let fe=0;fe<Se.locationSize;fe++)m(Se.location+fe,Ee/Se.locationSize,ze,ue,Be*je,(Xe+Ee/Se.locationSize*fe)*je)}else{if(Ve.isInstancedBufferAttribute){for(let Ie=0;Ie<Se.locationSize;Ie++)L(Se.location+Ie,Ve.meshPerAttribute);$.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=Ve.meshPerAttribute*Ve.count)}else for(let Ie=0;Ie<Se.locationSize;Ie++)S(Se.location+Ie);r.bindBuffer(34962,re);for(let Ie=0;Ie<Se.locationSize;Ie++)m(Se.location+Ie,Ee/Se.locationSize,ze,ue,Ee*je,Ee/Se.locationSize*Ie*je)}}else if(we!==void 0){const ue=we[Ne];if(ue!==void 0)switch(ue.length){case 2:r.vertexAttrib2fv(Se.location,ue);break;case 3:r.vertexAttrib3fv(Se.location,ue);break;case 4:r.vertexAttrib4fv(Se.location,ue);break;default:r.vertexAttrib1fv(Se.location,ue)}}}}T()}function N(){B();for(const $ in o){const Q=o[$];for(const K in Q){const j=Q[K];for(const ie in j)g(j[ie].object),delete j[ie];delete Q[K]}delete o[$]}}function z($){if(o[$.id]===void 0)return;const Q=o[$.id];for(const K in Q){const j=Q[K];for(const ie in j)g(j[ie].object),delete j[ie];delete Q[K]}delete o[$.id]}function W($){for(const Q in o){const K=o[Q];if(K[$.id]===void 0)continue;const j=K[$.id];for(const ie in j)g(j[ie].object),delete j[ie];delete K[$.id]}}function B(){se(),f!==u&&(f=u,d(f.object))}function se(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:h,reset:B,resetDefaultState:se,dispose:N,releaseStatesOfGeometry:z,releaseStatesOfProgram:W,initAttributes:w,enableAttribute:S,disableUnusedAttributes:T}}function K_(r,e,t,n){const i=n.isWebGL2;let s;function a(f){s=f}function o(f,h){r.drawArrays(s,f,h),t.update(h,s,1)}function u(f,h,c){if(c===0)return;let d,g;if(i)d=r,g="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),g="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[g](s,f,h,c),t.update(h,s,c)}this.setMode=a,this.render=o,this.renderInstances=u}function ew(r,e,t){let n;function i(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");n=r.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(C){if(C==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";C="mediump"}return C==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext!="undefined"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&r instanceof WebGL2ComputeRenderingContext;let o=t.precision!==void 0?t.precision:"highp";const u=s(o);u!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",u,"instead."),o=u);const f=a||e.has("WEBGL_draw_buffers"),h=t.logarithmicDepthBuffer===!0,c=r.getParameter(34930),d=r.getParameter(35660),g=r.getParameter(3379),x=r.getParameter(34076),v=r.getParameter(34921),b=r.getParameter(36347),y=r.getParameter(36348),w=r.getParameter(36349),S=d>0,L=a||e.has("OES_texture_float"),T=S&&L,m=a?r.getParameter(36183):0;return{isWebGL2:a,drawBuffers:f,getMaxAnisotropy:i,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:h,maxTextures:c,maxVertexTextures:d,maxTextureSize:g,maxCubemapSize:x,maxAttributes:v,maxVertexUniforms:b,maxVaryings:y,maxFragmentUniforms:w,vertexTextures:S,floatFragmentTextures:L,floatVertexTextures:T,maxSamples:m}}function tw(r){const e=this;let t=null,n=0,i=!1,s=!1;const a=new Li,o=new cn,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(c,d,g){const x=c.length!==0||d||n!==0||i;return i=d,t=h(c,g,0),n=c.length,x},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1,f()},this.setState=function(c,d,g){const x=c.clippingPlanes,v=c.clipIntersection,b=c.clipShadows,y=r.get(c);if(!i||x===null||x.length===0||s&&!b)s?h(null):f();else{const w=s?0:n,S=w*4;let L=y.clippingState||null;u.value=L,L=h(x,d,S,g);for(let T=0;T!==S;++T)L[T]=t[T];y.clippingState=L,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=w}};function f(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(c,d,g,x){const v=c!==null?c.length:0;let b=null;if(v!==0){if(b=u.value,x!==!0||b===null){const y=g+v*4,w=d.matrixWorldInverse;o.getNormalMatrix(w),(b===null||b.length<y)&&(b=new Float32Array(y));for(let S=0,L=g;S!==v;++S,L+=4)a.copy(c[S]).applyMatrix4(w,o),a.normal.toArray(b,L),b[L+3]=a.constant}u.value=b,u.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,b}}function nw(r){let e=new WeakMap;function t(a,o){return o===Ql?a.mapping=bo:o===Kl&&(a.mapping=Mo),a}function n(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){const o=a.mapping;if(o===Ql||o===Kl)if(e.has(a)){const u=e.get(a).texture;return t(u,a.mapping)}else{const u=a.image;if(u&&u.height>0){const f=r.getRenderTarget(),h=new Jf(u.height/2);return h.fromEquirectangularTexture(r,a),e.set(a,h),r.setRenderTarget(f),a.addEventListener("dispose",i),t(h.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const u=e.get(o);u!==void 0&&(e.delete(o),u.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class Sc extends wc{constructor(e=-1,t=1,n=1,i=-1,s=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-e,a=n+e,o=i+t,u=i-t;if(this.view!==null&&this.view.enabled){const f=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=f*this.view.offsetX,a=s+f*this.view.width,o-=h*this.view.offsetY,u=o-h*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}Sc.prototype.isOrthographicCamera=!0;class Ro extends xr{constructor(e){super(e),this.type="RawShaderMaterial"}}Ro.prototype.isRawShaderMaterial=!0;const ns=4,ji=8,hi=Math.pow(2,ji),Kf=[.125,.215,.35,.446,.526,.582],ed=ji-ns+1+Kf.length,kr=20,di={[Nn]:0,[To]:1,[_c]:2,[Gf]:3,[Wf]:4,[qf]:5,[xc]:6},Ll=new Sc,{_lodPlanes:Is,_sizeLods:eh,_sigmas:Ia}=sw(),th=new Ke;let Rl=null;const pr=(1+Math.sqrt(5))/2,Hr=1/pr,nh=[new V(1,1,1),new V(-1,1,1),new V(1,1,-1),new V(-1,1,-1),new V(0,pr,Hr),new V(0,pr,-Hr),new V(Hr,0,pr),new V(-Hr,0,pr),new V(pr,Hr,0),new V(-pr,Hr,0)];class iw{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=aw(kr),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){Rl=this._renderer.getRenderTarget();const s=this._allocateTargets();return this._sceneToCubeUV(e,n,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=sh(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=rh(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<Is.length;e++)Is[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Rl),e.scissorTest=!1,Fa(e,0,0,e.width,e.height)}_fromTexture(e){Rl=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){const t={magFilter:nn,minFilter:nn,generateMipmaps:!1,type:as,format:hv,encoding:rw(e)?e.encoding:_c,depthBuffer:!1},n=ih(t);return n.depthBuffer=!e,this._pingPongRenderTarget=ih(t),n}_compileMaterial(e){const t=new wn(Is[0],e);this._renderer.compile(t,Ll)}_sceneToCubeUV(e,t,n,i){const o=new xn(90,1,t,n),u=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],h=this._renderer,c=h.autoClear,d=h.outputEncoding,g=h.toneMapping;h.getClearColor(th),h.toneMapping=vr,h.outputEncoding=Nn,h.autoClear=!1;const x=new Ao({name:"PMREM.Background",side:Jt,depthWrite:!1,depthTest:!1}),v=new wn(new ra,x);let b=!1;const y=e.background;y?y.isColor&&(x.color.copy(y),e.background=null,b=!0):(x.color.copy(th),b=!0);for(let w=0;w<6;w++){const S=w%3;S==0?(o.up.set(0,u[w],0),o.lookAt(f[w],0,0)):S==1?(o.up.set(0,0,u[w]),o.lookAt(0,f[w],0)):(o.up.set(0,u[w],0),o.lookAt(0,0,f[w])),Fa(i,S*hi,w>2?hi:0,hi,hi),h.setRenderTarget(i),b&&h.render(v,o),h.render(e,o)}v.geometry.dispose(),v.material.dispose(),h.toneMapping=g,h.outputEncoding=d,h.autoClear=c,e.background=y}_textureToCubeUV(e,t){const n=this._renderer;e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=sh()):this._equirectShader==null&&(this._equirectShader=rh());const i=e.isCubeTexture?this._cubemapShader:this._equirectShader,s=new wn(Is[0],i),a=i.uniforms;a.envMap.value=e,e.isCubeTexture||a.texelSize.value.set(1/e.image.width,1/e.image.height),a.inputEncoding.value=di[e.encoding],a.outputEncoding.value=di[t.texture.encoding],Fa(t,0,0,3*hi,2*hi),n.setRenderTarget(t),n.render(s,Ll)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<ed;i++){const s=Math.sqrt(Ia[i]*Ia[i]-Ia[i-1]*Ia[i-1]),a=nh[(i-1)%nh.length];this._blur(e,i-1,i,s,a)}t.autoClear=n}_blur(e,t,n,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,i,"latitudinal",s),this._halfBlur(a,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,a,o){const u=this._renderer,f=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,c=new wn(Is[i],f),d=f.uniforms,g=eh[n]-1,x=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*kr-1),v=s/x,b=isFinite(s)?1+Math.floor(h*v):kr;b>kr&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${kr}`);const y=[];let w=0;for(let m=0;m<kr;++m){const C=m/v,N=Math.exp(-C*C/2);y.push(N),m==0?w+=N:m<b&&(w+=2*N)}for(let m=0;m<y.length;m++)y[m]=y[m]/w;d.envMap.value=e.texture,d.samples.value=b,d.weights.value=y,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o),d.dTheta.value=x,d.mipInt.value=ji-n,d.inputEncoding.value=di[e.texture.encoding],d.outputEncoding.value=di[e.texture.encoding];const S=eh[i],L=3*Math.max(0,hi-2*S),T=(i===0?0:2*hi)+2*S*(i>ji-ns?i-ji+ns:0);Fa(t,L,T,3*S,2*S),u.setRenderTarget(t),u.render(c,Ll)}}function rw(r){return r===void 0||r.type!==as?!1:r.encoding===Nn||r.encoding===To||r.encoding===xc}function sw(){const r=[],e=[],t=[];let n=ji;for(let i=0;i<ed;i++){const s=Math.pow(2,n);e.push(s);let a=1/s;i>ji-ns?a=Kf[i-ji+ns-1]:i==0&&(a=0),t.push(a);const o=1/(s-1),u=-o/2,f=1+o/2,h=[u,u,f,u,f,f,u,u,f,f,u,f],c=6,d=6,g=3,x=2,v=1,b=new Float32Array(g*d*c),y=new Float32Array(x*d*c),w=new Float32Array(v*d*c);for(let L=0;L<c;L++){const T=L%3*2/3-1,m=L>2?0:-1,C=[T,m,0,T+2/3,m,0,T+2/3,m+1,0,T,m,0,T+2/3,m+1,0,T,m+1,0];b.set(C,g*d*L),y.set(h,x*d*L);const N=[L,L,L,L,L,L];w.set(N,v*d*L)}const S=new Rt;S.setAttribute("position",new Kt(b,g)),S.setAttribute("uv",new Kt(y,x)),S.setAttribute("faceIndex",new Kt(w,v)),r.push(S),n>ns&&n--}return{_lodPlanes:r,_sizeLods:e,_sigmas:t}}function ih(r){const e=new mi(3*hi,3*hi,r);return e.texture.mapping=So,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Fa(r,e,t,n,i){r.viewport.set(e,t,n,i),r.scissor.set(e,t,n,i)}function aw(r){const e=new Float32Array(r),t=new V(0,1,0);return new Ro({name:"SphericalGaussianBlur",defines:{n:r},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:di[Nn]},outputEncoding:{value:di[Nn]}},vertexShader:Ec(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${Tc()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Wi,depthTest:!1,depthWrite:!1})}function rh(){const r=new Fe(1,1);return new Ro({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:r},inputEncoding:{value:di[Nn]},outputEncoding:{value:di[Nn]}},vertexShader:Ec(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${Tc()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Wi,depthTest:!1,depthWrite:!1})}function sh(){return new Ro({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:di[Nn]},outputEncoding:{value:di[Nn]}},vertexShader:Ec(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${Tc()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Wi,depthTest:!1,depthWrite:!1})}function Ec(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Tc(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function ow(r){let e=new WeakMap,t=null;function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const u=o.mapping,f=u===Ql||u===Kl,h=u===bo||u===Mo;if(f||h){if(e.has(o))return e.get(o).texture;{const c=o.image;if(f&&c&&c.height>0||h&&c&&i(c)){const d=r.getRenderTarget();t===null&&(t=new iw(r));const g=f?t.fromEquirectangular(o):t.fromCubemap(o);return e.set(o,g),r.setRenderTarget(d),o.addEventListener("dispose",s),g.texture}else return null}}}return o}function i(o){let u=0;const f=6;for(let h=0;h<f;h++)o[h]!==void 0&&u++;return u===f}function s(o){const u=o.target;u.removeEventListener("dispose",s);const f=e.get(u);f!==void 0&&(e.delete(u),f.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function lw(r){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=r.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function cw(r,e,t,n){const i={},s=new WeakMap;function a(c){const d=c.target;d.index!==null&&e.remove(d.index);for(const x in d.attributes)e.remove(d.attributes[x]);d.removeEventListener("dispose",a),delete i[d.id];const g=s.get(d);g&&(e.remove(g),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function o(c,d){return i[d.id]===!0||(d.addEventListener("dispose",a),i[d.id]=!0,t.memory.geometries++),d}function u(c){const d=c.attributes;for(const x in d)e.update(d[x],34962);const g=c.morphAttributes;for(const x in g){const v=g[x];for(let b=0,y=v.length;b<y;b++)e.update(v[b],34962)}}function f(c){const d=[],g=c.index,x=c.attributes.position;let v=0;if(g!==null){const w=g.array;v=g.version;for(let S=0,L=w.length;S<L;S+=3){const T=w[S+0],m=w[S+1],C=w[S+2];d.push(T,m,m,C,C,T)}}else{const w=x.array;v=x.version;for(let S=0,L=w.length/3-1;S<L;S+=3){const T=S+0,m=S+1,C=S+2;d.push(T,m,m,C,C,T)}}const b=new($f(d)>65535?Zf:Yf)(d,1);b.version=v;const y=s.get(c);y&&e.remove(y),s.set(c,b)}function h(c){const d=s.get(c);if(d){const g=c.index;g!==null&&d.version<g.version&&f(c)}else f(c);return s.get(c)}return{get:o,update:u,getWireframeAttribute:h}}function uw(r,e,t,n){const i=n.isWebGL2;let s;function a(d){s=d}let o,u;function f(d){o=d.type,u=d.bytesPerElement}function h(d,g){r.drawElements(s,g,o,d*u),t.update(g,s,1)}function c(d,g,x){if(x===0)return;let v,b;if(i)v=r,b="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),b="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[b](s,g,o,d*u,x),t.update(g,s,x)}this.setMode=a,this.setIndex=f,this.render=h,this.renderInstances=c}function hw(r){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,o){switch(t.calls++,a){case 4:t.triangles+=o*(s/3);break;case 1:t.lines+=o*(s/2);break;case 3:t.lines+=o*(s-1);break;case 2:t.lines+=o*s;break;case 0:t.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function fw(r,e){return r[0]-e[0]}function dw(r,e){return Math.abs(e[1])-Math.abs(r[1])}function pw(r){const e={},t=new Float32Array(8),n=[];for(let s=0;s<8;s++)n[s]=[s,0];function i(s,a,o,u){const f=s.morphTargetInfluences,h=f===void 0?0:f.length;let c=e[a.id];if(c===void 0||c.length!==h){c=[];for(let b=0;b<h;b++)c[b]=[b,0];e[a.id]=c}for(let b=0;b<h;b++){const y=c[b];y[0]=b,y[1]=f[b]}c.sort(dw);for(let b=0;b<8;b++)b<h&&c[b][1]?(n[b][0]=c[b][0],n[b][1]=c[b][1]):(n[b][0]=Number.MAX_SAFE_INTEGER,n[b][1]=0);n.sort(fw);const d=a.morphAttributes.position,g=a.morphAttributes.normal;let x=0;for(let b=0;b<8;b++){const y=n[b],w=y[0],S=y[1];w!==Number.MAX_SAFE_INTEGER&&S?(d&&a.getAttribute("morphTarget"+b)!==d[w]&&a.setAttribute("morphTarget"+b,d[w]),g&&a.getAttribute("morphNormal"+b)!==g[w]&&a.setAttribute("morphNormal"+b,g[w]),t[b]=S,x+=S):(d&&a.hasAttribute("morphTarget"+b)===!0&&a.deleteAttribute("morphTarget"+b),g&&a.hasAttribute("morphNormal"+b)===!0&&a.deleteAttribute("morphNormal"+b),t[b]=0)}const v=a.morphTargetsRelative?1:1-x;u.getUniforms().setValue(r,"morphTargetBaseInfluence",v),u.getUniforms().setValue(r,"morphTargetInfluences",t)}return{update:i}}function mw(r,e,t,n){let i=new WeakMap;function s(u){const f=n.render.frame,h=u.geometry,c=e.get(u,h);return i.get(c)!==f&&(e.update(c),i.set(c,f)),u.isInstancedMesh&&(u.hasEventListener("dispose",o)===!1&&u.addEventListener("dispose",o),t.update(u.instanceMatrix,34962),u.instanceColor!==null&&t.update(u.instanceColor,34962)),c}function a(){i=new WeakMap}function o(u){const f=u.target;f.removeEventListener("dispose",o),t.remove(f.instanceMatrix),f.instanceColor!==null&&t.remove(f.instanceColor)}return{update:s,dispose:a}}class td extends un{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=nn,this.minFilter=nn,this.wrapR=Vn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}td.prototype.isDataTexture2DArray=!0;class nd extends un{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=nn,this.minFilter=nn,this.wrapR=Vn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}nd.prototype.isDataTexture3D=!0;const id=new un,gw=new td,vw=new nd,rd=new Co,ah=[],oh=[],lh=new Float32Array(16),ch=new Float32Array(9),uh=new Float32Array(4);function ms(r,e,t){const n=r[0];if(n<=0||n>0)return r;const i=e*t;let s=ah[i];if(s===void 0&&(s=new Float32Array(i),ah[i]=s),e!==0){n.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,r[a].toArray(s,o)}return s}function bn(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function vn(r,e){for(let t=0,n=e.length;t<n;t++)r[t]=e[t]}function sd(r,e){let t=oh[e];t===void 0&&(t=new Int32Array(e),oh[e]=t);for(let n=0;n!==e;++n)t[n]=r.allocateTextureUnit();return t}function yw(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function xw(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(bn(t,e))return;r.uniform2fv(this.addr,e),vn(t,e)}}function _w(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(bn(t,e))return;r.uniform3fv(this.addr,e),vn(t,e)}}function ww(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(bn(t,e))return;r.uniform4fv(this.addr,e),vn(t,e)}}function bw(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(bn(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),vn(t,e)}else{if(bn(t,n))return;uh.set(n),r.uniformMatrix2fv(this.addr,!1,uh),vn(t,n)}}function Mw(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(bn(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),vn(t,e)}else{if(bn(t,n))return;ch.set(n),r.uniformMatrix3fv(this.addr,!1,ch),vn(t,n)}}function Sw(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(bn(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),vn(t,e)}else{if(bn(t,n))return;lh.set(n),r.uniformMatrix4fv(this.addr,!1,lh),vn(t,n)}}function Ew(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function Tw(r,e){const t=this.cache;bn(t,e)||(r.uniform2iv(this.addr,e),vn(t,e))}function Aw(r,e){const t=this.cache;bn(t,e)||(r.uniform3iv(this.addr,e),vn(t,e))}function Cw(r,e){const t=this.cache;bn(t,e)||(r.uniform4iv(this.addr,e),vn(t,e))}function Lw(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function Rw(r,e){const t=this.cache;bn(t,e)||(r.uniform2uiv(this.addr,e),vn(t,e))}function Pw(r,e){const t=this.cache;bn(t,e)||(r.uniform3uiv(this.addr,e),vn(t,e))}function Nw(r,e){const t=this.cache;bn(t,e)||(r.uniform4uiv(this.addr,e),vn(t,e))}function Dw(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.safeSetTexture2D(e||id,i)}function Iw(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||vw,i)}function Fw(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.safeSetTextureCube(e||rd,i)}function Bw(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||gw,i)}function Ow(r){switch(r){case 5126:return yw;case 35664:return xw;case 35665:return _w;case 35666:return ww;case 35674:return bw;case 35675:return Mw;case 35676:return Sw;case 5124:case 35670:return Ew;case 35667:case 35671:return Tw;case 35668:case 35672:return Aw;case 35669:case 35673:return Cw;case 5125:return Lw;case 36294:return Rw;case 36295:return Pw;case 36296:return Nw;case 35678:case 36198:case 36298:case 36306:case 35682:return Dw;case 35679:case 36299:case 36307:return Iw;case 35680:case 36300:case 36308:case 36293:return Fw;case 36289:case 36303:case 36311:case 36292:return Bw}}function zw(r,e){r.uniform1fv(this.addr,e)}function Uw(r,e){const t=ms(e,this.size,2);r.uniform2fv(this.addr,t)}function kw(r,e){const t=ms(e,this.size,3);r.uniform3fv(this.addr,t)}function Hw(r,e){const t=ms(e,this.size,4);r.uniform4fv(this.addr,t)}function Vw(r,e){const t=ms(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function Gw(r,e){const t=ms(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function Ww(r,e){const t=ms(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function qw(r,e){r.uniform1iv(this.addr,e)}function jw(r,e){r.uniform2iv(this.addr,e)}function Xw(r,e){r.uniform3iv(this.addr,e)}function Yw(r,e){r.uniform4iv(this.addr,e)}function Zw(r,e){r.uniform1uiv(this.addr,e)}function $w(r,e){r.uniform2uiv(this.addr,e)}function Jw(r,e){r.uniform3uiv(this.addr,e)}function Qw(r,e){r.uniform4uiv(this.addr,e)}function Kw(r,e,t){const n=e.length,i=sd(t,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)t.safeSetTexture2D(e[s]||id,i[s])}function eb(r,e,t){const n=e.length,i=sd(t,n);r.uniform1iv(this.addr,i);for(let s=0;s!==n;++s)t.safeSetTextureCube(e[s]||rd,i[s])}function tb(r){switch(r){case 5126:return zw;case 35664:return Uw;case 35665:return kw;case 35666:return Hw;case 35674:return Vw;case 35675:return Gw;case 35676:return Ww;case 5124:case 35670:return qw;case 35667:case 35671:return jw;case 35668:case 35672:return Xw;case 35669:case 35673:return Yw;case 5125:return Zw;case 36294:return $w;case 36295:return Jw;case 36296:return Qw;case 35678:case 36198:case 36298:case 36306:case 35682:return Kw;case 35680:case 36300:case 36308:case 36293:return eb}}function nb(r,e,t){this.id=r,this.addr=t,this.cache=[],this.setValue=Ow(e.type)}function ad(r,e,t){this.id=r,this.addr=t,this.cache=[],this.size=e.size,this.setValue=tb(e.type)}ad.prototype.updateCache=function(r){const e=this.cache;r instanceof Float32Array&&e.length!==r.length&&(this.cache=new Float32Array(r.length)),vn(e,r)};function od(r){this.id=r,this.seq=[],this.map={}}od.prototype.setValue=function(r,e,t){const n=this.seq;for(let i=0,s=n.length;i!==s;++i){const a=n[i];a.setValue(r,e[a.id],t)}};const Pl=/(\w+)(\])?(\[|\.)?/g;function hh(r,e){r.seq.push(e),r.map[e.id]=e}function ib(r,e,t){const n=r.name,i=n.length;for(Pl.lastIndex=0;;){const s=Pl.exec(n),a=Pl.lastIndex;let o=s[1];const u=s[2]==="]",f=s[3];if(u&&(o=o|0),f===void 0||f==="["&&a+2===i){hh(t,f===void 0?new nb(o,r,e):new ad(o,r,e));break}else{let c=t.map[o];c===void 0&&(c=new od(o),hh(t,c)),t=c}}}function Xi(r,e){this.seq=[],this.map={};const t=r.getProgramParameter(e,35718);for(let n=0;n<t;++n){const i=r.getActiveUniform(e,n),s=r.getUniformLocation(e,i.name);ib(i,s,this)}}Xi.prototype.setValue=function(r,e,t,n){const i=this.map[e];i!==void 0&&i.setValue(r,t,n)};Xi.prototype.setOptional=function(r,e,t){const n=e[t];n!==void 0&&this.setValue(r,t,n)};Xi.upload=function(r,e,t,n){for(let i=0,s=e.length;i!==s;++i){const a=e[i],o=t[a.id];o.needsUpdate!==!1&&a.setValue(r,o.value,n)}};Xi.seqWithValue=function(r,e){const t=[];for(let n=0,i=r.length;n!==i;++n){const s=r[n];s.id in e&&t.push(s)}return t};function fh(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}let rb=0;function sb(r){const e=r.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function ld(r){switch(r){case Nn:return["Linear","( value )"];case To:return["sRGB","( value )"];case _c:return["RGBE","( value )"];case Gf:return["RGBM","( value, 7.0 )"];case Wf:return["RGBM","( value, 16.0 )"];case qf:return["RGBD","( value, 256.0 )"];case xc:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Qv:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function dh(r,e,t){const n=r.getShaderParameter(e,35713),i=r.getShaderInfoLog(e).trim();return n&&i===""?"":t.toUpperCase()+`

`+i+`

`+sb(r.getShaderSource(e))}function Vr(r,e){const t=ld(e);return"vec4 "+r+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function ab(r,e){const t=ld(e);return"vec4 "+r+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function ob(r,e){let t;switch(e){case $0:t="Linear";break;case J0:t="Reinhard";break;case Q0:t="OptimizedCineon";break;case K0:t="ACESFilmic";break;case ev:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function lb(r){return[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap||r.transmission)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Hs).join(`
`)}function cb(r){const e=[];for(const t in r){const n=r[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function ub(r,e){const t={},n=r.getProgramParameter(e,35721);for(let i=0;i<n;i++){const s=r.getActiveAttrib(e,i),a=s.name;let o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),t[a]={type:s.type,location:r.getAttribLocation(e,a),locationSize:o}}return t}function Hs(r){return r!==""}function ph(r,e){return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function mh(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const hb=/^[ \t]*#include +<([\w\d./]+)>/gm;function ic(r){return r.replace(hb,fb)}function fb(r,e){const t=vt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return ic(t)}const db=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,pb=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function gh(r){return r.replace(pb,cd).replace(db,mb)}function mb(r,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),cd(r,e,t,n)}function cd(r,e,t,n){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function vh(r){let e="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function gb(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===Of?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===C0?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===ks&&(e="SHADOWMAP_TYPE_VSM"),e}function vb(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case bo:case Mo:e="ENVMAP_TYPE_CUBE";break;case So:case vc:e="ENVMAP_TYPE_CUBE_UV";break}return e}function yb(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case Mo:case vc:e="ENVMAP_MODE_REFRACTION";break}return e}function xb(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case wo:e="ENVMAP_BLENDING_MULTIPLY";break;case Y0:e="ENVMAP_BLENDING_MIX";break;case Z0:e="ENVMAP_BLENDING_ADD";break}return e}function _b(r,e,t,n){const i=r.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const u=gb(t),f=vb(t),h=yb(t),c=xb(t),d=r.gammaFactor>0?r.gammaFactor:1,g=t.isWebGL2?"":lb(t),x=cb(s),v=i.createProgram();let b,y,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(b=[x].filter(Hs).join(`
`),b.length>0&&(b+=`
`),y=[g,x].filter(Hs).join(`
`),y.length>0&&(y+=`
`)):(b=[vh(t),"#define SHADER_NAME "+t.shaderName,x,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularTintMap?"#define USE_SPECULARTINTMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Hs).join(`
`),y=[g,vh(t),"#define SHADER_NAME "+t.shaderName,x,"#define GAMMA_FACTOR "+d,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.envMap?"#define "+h:"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularTintMap?"#define USE_SPECULARTINTMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheenTint?"#define USE_SHEEN":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==vr?"#define TONE_MAPPING":"",t.toneMapping!==vr?vt.tonemapping_pars_fragment:"",t.toneMapping!==vr?ob("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.format===qi?"#define OPAQUE":"",vt.encodings_pars_fragment,t.map?Vr("mapTexelToLinear",t.mapEncoding):"",t.matcap?Vr("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?Vr("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?Vr("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.specularTintMap?Vr("specularTintMapTexelToLinear",t.specularTintMapEncoding):"",t.lightMap?Vr("lightMapTexelToLinear",t.lightMapEncoding):"",ab("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Hs).join(`
`)),a=ic(a),a=ph(a,t),a=mh(a,t),o=ic(o),o=ph(o,t),o=mh(o,t),a=gh(a),o=gh(o),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,b=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,y=["#define varying in",t.glslVersion===Hu?"":"out highp vec4 pc_fragColor;",t.glslVersion===Hu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const S=w+b+a,L=w+y+o,T=fh(i,35633,S),m=fh(i,35632,L);if(i.attachShader(v,T),i.attachShader(v,m),t.index0AttributeName!==void 0?i.bindAttribLocation(v,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(v,0,"position"),i.linkProgram(v),r.debug.checkShaderErrors){const z=i.getProgramInfoLog(v).trim(),W=i.getShaderInfoLog(T).trim(),B=i.getShaderInfoLog(m).trim();let se=!0,$=!0;if(i.getProgramParameter(v,35714)===!1){se=!1;const Q=dh(i,T,"vertex"),K=dh(i,m,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(v,35715)+`

Program Info Log: `+z+`
`+Q+`
`+K)}else z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",z):(W===""||B==="")&&($=!1);$&&(this.diagnostics={runnable:se,programLog:z,vertexShader:{log:W,prefix:b},fragmentShader:{log:B,prefix:y}})}i.deleteShader(T),i.deleteShader(m);let C;this.getUniforms=function(){return C===void 0&&(C=new Xi(i,v)),C};let N;return this.getAttributes=function(){return N===void 0&&(N=ub(i,v)),N},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(v),this.program=void 0},this.name=t.shaderName,this.id=rb++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=T,this.fragmentShader=m,this}function wb(r,e,t,n,i,s,a){const o=[],u=i.isWebGL2,f=i.logarithmicDepthBuffer,h=i.floatVertexTextures,c=i.maxVertexUniforms,d=i.vertexTextures;let g=i.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},v=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheenTint","transmission","transmissionMap","thicknessMap"];function b(C){const z=C.skeleton.bones;if(h)return 1024;{const B=Math.floor((c-20)/4),se=Math.min(B,z.length);return se<z.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+z.length+" bones. This GPU supports "+se+"."),0):se}}function y(C){let N;return C&&C.isTexture?N=C.encoding:C&&C.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),N=C.texture.encoding):N=Nn,N}function w(C,N,z,W,B){const se=W.fog,$=C.isMeshStandardMaterial?W.environment:null,Q=(C.isMeshStandardMaterial?t:e).get(C.envMap||$),K=x[C.type],j=B.isSkinnedMesh?b(B):0;C.precision!==null&&(g=i.getMaxPrecision(C.precision),g!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",g,"instead."));let ie,de;if(K){const ue=fi[K];ie=ue.vertexShader,de=ue.fragmentShader}else ie=C.vertexShader,de=C.fragmentShader;const we=r.getRenderTarget(),Ne=C.alphaTest>0,Se=C.clearcoat>0;return{isWebGL2:u,shaderID:K,shaderName:C.type,vertexShader:ie,fragmentShader:de,defines:C.defines,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:g,instancing:B.isInstancedMesh===!0,instancingColor:B.isInstancedMesh===!0&&B.instanceColor!==null,supportsVertexTextures:d,outputEncoding:we!==null?y(we.texture):r.outputEncoding,map:!!C.map,mapEncoding:y(C.map),matcap:!!C.matcap,matcapEncoding:y(C.matcap),envMap:!!Q,envMapMode:Q&&Q.mapping,envMapEncoding:y(Q),envMapCubeUV:!!Q&&(Q.mapping===So||Q.mapping===vc),lightMap:!!C.lightMap,lightMapEncoding:y(C.lightMap),aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,emissiveMapEncoding:y(C.emissiveMap),bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===ty,tangentSpaceNormalMap:C.normalMapType===us,clearcoat:Se,clearcoatMap:Se&&!!C.clearcoatMap,clearcoatRoughnessMap:Se&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:Se&&!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularTintMap:!!C.specularTintMap,specularTintMapEncoding:y(C.specularTintMap),alphaMap:!!C.alphaMap,alphaTest:Ne,gradientMap:!!C.gradientMap,sheenTint:!!C.sheenTint&&(C.sheenTint.r>0||C.sheenTint.g>0||C.sheenTint.b>0),transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!B.geometry&&!!B.geometry.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!B.geometry&&!!B.geometry.attributes.color&&B.geometry.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularTintMap,uvsVertexOnly:!(!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatNormalMap||C.transmission>0||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularTintMap)&&!!C.displacementMap,fog:!!se,useFog:C.fog,fogExp2:se&&se.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:f,skinning:B.isSkinnedMesh===!0&&j>0,maxBones:j,useVertexTexture:h,morphTargets:!!B.geometry&&!!B.geometry.morphAttributes.position,morphNormals:!!B.geometry&&!!B.geometry.morphAttributes.normal,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,format:C.format,dithering:C.dithering,shadowMapEnabled:r.shadowMap.enabled&&z.length>0,shadowMapType:r.shadowMap.type,toneMapping:C.toneMapped?r.toneMapping:vr,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===ss,flipSided:C.side===Jt,depthPacking:C.depthPacking!==void 0?C.depthPacking:!1,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function S(C){const N=[];if(C.shaderID?N.push(C.shaderID):(N.push(C.fragmentShader),N.push(C.vertexShader)),C.defines!==void 0)for(const z in C.defines)N.push(z),N.push(C.defines[z]);if(C.isRawShaderMaterial===!1){for(let z=0;z<v.length;z++)N.push(C[v[z]]);N.push(r.outputEncoding),N.push(r.gammaFactor)}return N.push(C.customProgramCacheKey),N.join()}function L(C){const N=x[C.type];let z;if(N){const W=fi[N];z=xy.clone(W.uniforms)}else z=C.uniforms;return z}function T(C,N){let z;for(let W=0,B=o.length;W<B;W++){const se=o[W];if(se.cacheKey===N){z=se,++z.usedTimes;break}}return z===void 0&&(z=new _b(r,N,C,s),o.push(z)),z}function m(C){if(--C.usedTimes===0){const N=o.indexOf(C);o[N]=o[o.length-1],o.pop(),C.destroy()}}return{getParameters:w,getProgramCacheKey:S,getUniforms:L,acquireProgram:T,releaseProgram:m,programs:o}}function bb(){let r=new WeakMap;function e(s){let a=r.get(s);return a===void 0&&(a={},r.set(s,a)),a}function t(s){r.delete(s)}function n(s,a,o){r.get(s)[a]=o}function i(){r=new WeakMap}return{get:e,remove:t,update:n,dispose:i}}function Mb(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.program!==e.program?r.program.id-e.program.id:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function yh(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function xh(r){const e=[];let t=0;const n=[],i=[],s=[],a={id:-1};function o(){t=0,n.length=0,i.length=0,s.length=0}function u(g,x,v,b,y,w){let S=e[t];const L=r.get(v);return S===void 0?(S={id:g.id,object:g,geometry:x,material:v,program:L.program||a,groupOrder:b,renderOrder:g.renderOrder,z:y,group:w},e[t]=S):(S.id=g.id,S.object=g,S.geometry=x,S.material=v,S.program=L.program||a,S.groupOrder=b,S.renderOrder=g.renderOrder,S.z=y,S.group=w),t++,S}function f(g,x,v,b,y,w){const S=u(g,x,v,b,y,w);v.transmission>0?i.push(S):v.transparent===!0?s.push(S):n.push(S)}function h(g,x,v,b,y,w){const S=u(g,x,v,b,y,w);v.transmission>0?i.unshift(S):v.transparent===!0?s.unshift(S):n.unshift(S)}function c(g,x){n.length>1&&n.sort(g||Mb),i.length>1&&i.sort(x||yh),s.length>1&&s.sort(x||yh)}function d(){for(let g=t,x=e.length;g<x;g++){const v=e[g];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.program=null,v.group=null}}return{opaque:n,transmissive:i,transparent:s,init:o,push:f,unshift:h,finish:d,sort:c}}function Sb(r){let e=new WeakMap;function t(i,s){let a;return e.has(i)===!1?(a=new xh(r),e.set(i,[a])):s>=e.get(i).length?(a=new xh(r),e.get(i).push(a)):a=e.get(i)[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}function Eb(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new V,color:new Ke};break;case"SpotLight":t={position:new V,direction:new V,color:new Ke,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new V,color:new Ke,distance:0,decay:0};break;case"HemisphereLight":t={direction:new V,skyColor:new Ke,groundColor:new Ke};break;case"RectAreaLight":t={color:new Ke,position:new V,halfWidth:new V,halfHeight:new V};break}return r[e.id]=t,t}}}function Tb(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=t,t}}}let Ab=0;function Cb(r,e){return(e.castShadow?1:0)-(r.castShadow?1:0)}function Lb(r,e){const t=new Eb,n=Tb(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let h=0;h<9;h++)i.probe.push(new V);const s=new V,a=new st,o=new st;function u(h,c){let d=0,g=0,x=0;for(let z=0;z<9;z++)i.probe[z].set(0,0,0);let v=0,b=0,y=0,w=0,S=0,L=0,T=0,m=0;h.sort(Cb);const C=c!==!0?Math.PI:1;for(let z=0,W=h.length;z<W;z++){const B=h[z],se=B.color,$=B.intensity,Q=B.distance,K=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)d+=se.r*$*C,g+=se.g*$*C,x+=se.b*$*C;else if(B.isLightProbe)for(let j=0;j<9;j++)i.probe[j].addScaledVector(B.sh.coefficients[j],$);else if(B.isDirectionalLight){const j=t.get(B);if(j.color.copy(B.color).multiplyScalar(B.intensity*C),B.castShadow){const ie=B.shadow,de=n.get(B);de.shadowBias=ie.bias,de.shadowNormalBias=ie.normalBias,de.shadowRadius=ie.radius,de.shadowMapSize=ie.mapSize,i.directionalShadow[v]=de,i.directionalShadowMap[v]=K,i.directionalShadowMatrix[v]=B.shadow.matrix,L++}i.directional[v]=j,v++}else if(B.isSpotLight){const j=t.get(B);if(j.position.setFromMatrixPosition(B.matrixWorld),j.color.copy(se).multiplyScalar($*C),j.distance=Q,j.coneCos=Math.cos(B.angle),j.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),j.decay=B.decay,B.castShadow){const ie=B.shadow,de=n.get(B);de.shadowBias=ie.bias,de.shadowNormalBias=ie.normalBias,de.shadowRadius=ie.radius,de.shadowMapSize=ie.mapSize,i.spotShadow[y]=de,i.spotShadowMap[y]=K,i.spotShadowMatrix[y]=B.shadow.matrix,m++}i.spot[y]=j,y++}else if(B.isRectAreaLight){const j=t.get(B);j.color.copy(se).multiplyScalar($),j.halfWidth.set(B.width*.5,0,0),j.halfHeight.set(0,B.height*.5,0),i.rectArea[w]=j,w++}else if(B.isPointLight){const j=t.get(B);if(j.color.copy(B.color).multiplyScalar(B.intensity*C),j.distance=B.distance,j.decay=B.decay,B.castShadow){const ie=B.shadow,de=n.get(B);de.shadowBias=ie.bias,de.shadowNormalBias=ie.normalBias,de.shadowRadius=ie.radius,de.shadowMapSize=ie.mapSize,de.shadowCameraNear=ie.camera.near,de.shadowCameraFar=ie.camera.far,i.pointShadow[b]=de,i.pointShadowMap[b]=K,i.pointShadowMatrix[b]=B.shadow.matrix,T++}i.point[b]=j,b++}else if(B.isHemisphereLight){const j=t.get(B);j.skyColor.copy(B.color).multiplyScalar($*C),j.groundColor.copy(B.groundColor).multiplyScalar($*C),i.hemi[S]=j,S++}}w>0&&(e.isWebGL2||r.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=We.LTC_FLOAT_1,i.rectAreaLTC2=We.LTC_FLOAT_2):r.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=We.LTC_HALF_1,i.rectAreaLTC2=We.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=d,i.ambient[1]=g,i.ambient[2]=x;const N=i.hash;(N.directionalLength!==v||N.pointLength!==b||N.spotLength!==y||N.rectAreaLength!==w||N.hemiLength!==S||N.numDirectionalShadows!==L||N.numPointShadows!==T||N.numSpotShadows!==m)&&(i.directional.length=v,i.spot.length=y,i.rectArea.length=w,i.point.length=b,i.hemi.length=S,i.directionalShadow.length=L,i.directionalShadowMap.length=L,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=m,i.spotShadowMap.length=m,i.directionalShadowMatrix.length=L,i.pointShadowMatrix.length=T,i.spotShadowMatrix.length=m,N.directionalLength=v,N.pointLength=b,N.spotLength=y,N.rectAreaLength=w,N.hemiLength=S,N.numDirectionalShadows=L,N.numPointShadows=T,N.numSpotShadows=m,i.version=Ab++)}function f(h,c){let d=0,g=0,x=0,v=0,b=0;const y=c.matrixWorldInverse;for(let w=0,S=h.length;w<S;w++){const L=h[w];if(L.isDirectionalLight){const T=i.directional[d];T.direction.setFromMatrixPosition(L.matrixWorld),s.setFromMatrixPosition(L.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),d++}else if(L.isSpotLight){const T=i.spot[x];T.position.setFromMatrixPosition(L.matrixWorld),T.position.applyMatrix4(y),T.direction.setFromMatrixPosition(L.matrixWorld),s.setFromMatrixPosition(L.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),x++}else if(L.isRectAreaLight){const T=i.rectArea[v];T.position.setFromMatrixPosition(L.matrixWorld),T.position.applyMatrix4(y),o.identity(),a.copy(L.matrixWorld),a.premultiply(y),o.extractRotation(a),T.halfWidth.set(L.width*.5,0,0),T.halfHeight.set(0,L.height*.5,0),T.halfWidth.applyMatrix4(o),T.halfHeight.applyMatrix4(o),v++}else if(L.isPointLight){const T=i.point[g];T.position.setFromMatrixPosition(L.matrixWorld),T.position.applyMatrix4(y),g++}else if(L.isHemisphereLight){const T=i.hemi[b];T.direction.setFromMatrixPosition(L.matrixWorld),T.direction.transformDirection(y),T.direction.normalize(),b++}}}return{setup:u,setupView:f,state:i}}function _h(r,e){const t=new Lb(r,e),n=[],i=[];function s(){n.length=0,i.length=0}function a(c){n.push(c)}function o(c){i.push(c)}function u(c){t.setup(n,c)}function f(c){t.setupView(n,c)}return{init:s,state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:u,setupLightsView:f,pushLight:a,pushShadow:o}}function Rb(r,e){let t=new WeakMap;function n(s,a=0){let o;return t.has(s)===!1?(o=new _h(r,e),t.set(s,[o])):a>=t.get(s).length?(o=new _h(r,e),t.get(s).push(o)):o=t.get(s)[a],o}function i(){t=new WeakMap}return{get:n,dispose:i}}class ud extends yn{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=Kv,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}ud.prototype.isMeshDepthMaterial=!0;class hd extends yn{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new V,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}hd.prototype.isMeshDistanceMaterial=!0;var Pb=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
uniform float samples;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,Nb=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function fd(r,e,t){let n=new Lo;const i=new Fe,s=new Fe,a=new Ct,o=new ud({depthPacking:ey}),u=new hd,f={},h=t.maxTextureSize,c={0:Jt,1:$s,2:ss},d=new xr({uniforms:{shadow_pass:{value:null},resolution:{value:new Fe},radius:{value:4},samples:{value:8}},vertexShader:Nb,fragmentShader:Pb}),g=d.clone();g.defines.HORIZONTAL_PASS=1;const x=new Rt;x.setAttribute("position",new Kt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new wn(x,d),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Of,this.render=function(L,T,m){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||L.length===0)return;const C=r.getRenderTarget(),N=r.getActiveCubeFace(),z=r.getActiveMipmapLevel(),W=r.state;W.setBlending(Wi),W.buffers.color.setClear(1,1,1,1),W.buffers.depth.setTest(!0),W.setScissorTest(!1);for(let B=0,se=L.length;B<se;B++){const $=L[B],Q=$.shadow;if(Q===void 0){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}if(Q.autoUpdate===!1&&Q.needsUpdate===!1)continue;i.copy(Q.mapSize);const K=Q.getFrameExtents();if(i.multiply(K),s.copy(Q.mapSize),(i.x>h||i.y>h)&&(i.x>h&&(s.x=Math.floor(h/K.x),i.x=s.x*K.x,Q.mapSize.x=s.x),i.y>h&&(s.y=Math.floor(h/K.y),i.y=s.y*K.y,Q.mapSize.y=s.y)),Q.map===null&&!Q.isPointLightShadow&&this.type===ks){const ie={minFilter:Yn,magFilter:Yn,format:Gn};Q.map=new mi(i.x,i.y,ie),Q.map.texture.name=$.name+".shadowMap",Q.mapPass=new mi(i.x,i.y,ie),Q.camera.updateProjectionMatrix()}if(Q.map===null){const ie={minFilter:nn,magFilter:nn,format:Gn};Q.map=new mi(i.x,i.y,ie),Q.map.texture.name=$.name+".shadowMap",Q.camera.updateProjectionMatrix()}r.setRenderTarget(Q.map),r.clear();const j=Q.getViewportCount();for(let ie=0;ie<j;ie++){const de=Q.getViewport(ie);a.set(s.x*de.x,s.y*de.y,s.x*de.z,s.y*de.w),W.viewport(a),Q.updateMatrices($,ie),n=Q.getFrustum(),S(T,m,Q.camera,$,this.type)}!Q.isPointLightShadow&&this.type===ks&&y(Q,m),Q.needsUpdate=!1}b.needsUpdate=!1,r.setRenderTarget(C,N,z)};function y(L,T){const m=e.update(v);d.uniforms.shadow_pass.value=L.map.texture,d.uniforms.resolution.value=L.mapSize,d.uniforms.radius.value=L.radius,d.uniforms.samples.value=L.blurSamples,r.setRenderTarget(L.mapPass),r.clear(),r.renderBufferDirect(T,null,m,d,v,null),g.uniforms.shadow_pass.value=L.mapPass.texture,g.uniforms.resolution.value=L.mapSize,g.uniforms.radius.value=L.radius,g.uniforms.samples.value=L.blurSamples,r.setRenderTarget(L.map),r.clear(),r.renderBufferDirect(T,null,m,g,v,null)}function w(L,T,m,C,N,z,W){let B=null;const se=C.isPointLight===!0?L.customDistanceMaterial:L.customDepthMaterial;if(se!==void 0?B=se:B=C.isPointLight===!0?u:o,r.localClippingEnabled&&m.clipShadows===!0&&m.clippingPlanes.length!==0||m.displacementMap&&m.displacementScale!==0||m.alphaMap&&m.alphaTest>0){const $=B.uuid,Q=m.uuid;let K=f[$];K===void 0&&(K={},f[$]=K);let j=K[Q];j===void 0&&(j=B.clone(),K[Q]=j),B=j}return B.visible=m.visible,B.wireframe=m.wireframe,W===ks?B.side=m.shadowSide!==null?m.shadowSide:m.side:B.side=m.shadowSide!==null?m.shadowSide:c[m.side],B.alphaMap=m.alphaMap,B.alphaTest=m.alphaTest,B.clipShadows=m.clipShadows,B.clippingPlanes=m.clippingPlanes,B.clipIntersection=m.clipIntersection,B.displacementMap=m.displacementMap,B.displacementScale=m.displacementScale,B.displacementBias=m.displacementBias,B.wireframeLinewidth=m.wireframeLinewidth,B.linewidth=m.linewidth,C.isPointLight===!0&&B.isMeshDistanceMaterial===!0&&(B.referencePosition.setFromMatrixPosition(C.matrixWorld),B.nearDistance=N,B.farDistance=z),B}function S(L,T,m,C,N){if(L.visible===!1)return;if(L.layers.test(T.layers)&&(L.isMesh||L.isLine||L.isPoints)&&(L.castShadow||L.receiveShadow&&N===ks)&&(!L.frustumCulled||n.intersectsObject(L))){L.modelViewMatrix.multiplyMatrices(m.matrixWorldInverse,L.matrixWorld);const B=e.update(L),se=L.material;if(Array.isArray(se)){const $=B.groups;for(let Q=0,K=$.length;Q<K;Q++){const j=$[Q],ie=se[j.materialIndex];if(ie&&ie.visible){const de=w(L,B,ie,C,m.near,m.far,N);r.renderBufferDirect(m,null,B,de,L,j)}}}else if(se.visible){const $=w(L,B,se,C,m.near,m.far,N);r.renderBufferDirect(m,null,B,$,L,null)}}const W=L.children;for(let B=0,se=W.length;B<se;B++)S(W[B],T,m,C,N)}}function Db(r,e,t){const n=t.isWebGL2;function i(){let U=!1;const ce=new Ct;let oe=null;const Ue=new Ct(0,0,0,0);return{setMask:function(q){oe!==q&&!U&&(r.colorMask(q,q,q,q),oe=q)},setLocked:function(q){U=q},setClear:function(q,Pe,ct,pt,Nt){Nt===!0&&(q*=pt,Pe*=pt,ct*=pt),ce.set(q,Pe,ct,pt),Ue.equals(ce)===!1&&(r.clearColor(q,Pe,ct,pt),Ue.copy(ce))},reset:function(){U=!1,oe=null,Ue.set(-1,0,0,0)}}}function s(){let U=!1,ce=null,oe=null,Ue=null;return{setTest:function(q){q?Ee(2929):Oe(2929)},setMask:function(q){ce!==q&&!U&&(r.depthMask(q),ce=q)},setFunc:function(q){if(oe!==q){if(q)switch(q){case H0:r.depthFunc(512);break;case V0:r.depthFunc(519);break;case G0:r.depthFunc(513);break;case Jl:r.depthFunc(515);break;case W0:r.depthFunc(514);break;case q0:r.depthFunc(518);break;case j0:r.depthFunc(516);break;case X0:r.depthFunc(517);break;default:r.depthFunc(515)}else r.depthFunc(515);oe=q}},setLocked:function(q){U=q},setClear:function(q){Ue!==q&&(r.clearDepth(q),Ue=q)},reset:function(){U=!1,ce=null,oe=null,Ue=null}}}function a(){let U=!1,ce=null,oe=null,Ue=null,q=null,Pe=null,ct=null,pt=null,Nt=null;return{setTest:function(ft){U||(ft?Ee(2960):Oe(2960))},setMask:function(ft){ce!==ft&&!U&&(r.stencilMask(ft),ce=ft)},setFunc:function(ft,_t,en){(oe!==ft||Ue!==_t||q!==en)&&(r.stencilFunc(ft,_t,en),oe=ft,Ue=_t,q=en)},setOp:function(ft,_t,en){(Pe!==ft||ct!==_t||pt!==en)&&(r.stencilOp(ft,_t,en),Pe=ft,ct=_t,pt=en)},setLocked:function(ft){U=ft},setClear:function(ft){Nt!==ft&&(r.clearStencil(ft),Nt=ft)},reset:function(){U=!1,ce=null,oe=null,Ue=null,q=null,Pe=null,ct=null,pt=null,Nt=null}}}const o=new i,u=new s,f=new a;let h={},c=null,d={},g=null,x=!1,v=null,b=null,y=null,w=null,S=null,L=null,T=null,m=!1,C=null,N=null,z=null,W=null,B=null;const se=r.getParameter(35661);let $=!1,Q=0;const K=r.getParameter(7938);K.indexOf("WebGL")!==-1?(Q=parseFloat(/^WebGL (\d)/.exec(K)[1]),$=Q>=1):K.indexOf("OpenGL ES")!==-1&&(Q=parseFloat(/^OpenGL ES (\d)/.exec(K)[1]),$=Q>=2);let j=null,ie={};const de=r.getParameter(3088),we=r.getParameter(2978),Ne=new Ct().fromArray(de),Se=new Ct().fromArray(we);function Ve(U,ce,oe){const Ue=new Uint8Array(4),q=r.createTexture();r.bindTexture(U,q),r.texParameteri(U,10241,9728),r.texParameteri(U,10240,9728);for(let Pe=0;Pe<oe;Pe++)r.texImage2D(ce+Pe,0,6408,1,1,0,6408,5121,Ue);return q}const ue={};ue[3553]=Ve(3553,3553,1),ue[34067]=Ve(34067,34069,6),o.setClear(0,0,0,1),u.setClear(1),f.setClear(0),Ee(2929),u.setFunc(Jl),ge(!1),Ae(Mu),Ee(2884),Xe(Wi);function Ee(U){h[U]!==!0&&(r.enable(U),h[U]=!0)}function Oe(U){h[U]!==!1&&(r.disable(U),h[U]=!1)}function re(U){U!==c&&(r.bindFramebuffer(36160,U),c=U)}function ze(U,ce){return ce===null&&c!==null&&(ce=c),d[U]!==ce?(r.bindFramebuffer(U,ce),d[U]=ce,n&&(U===36009&&(d[36160]=ce),U===36160&&(d[36009]=ce)),!0):!1}function je(U){return g!==U?(r.useProgram(U),g=U,!0):!1}const Ie={[Xr]:32774,[R0]:32778,[P0]:32779};if(n)Ie[Au]=32775,Ie[Cu]=32776;else{const U=e.get("EXT_blend_minmax");U!==null&&(Ie[Au]=U.MIN_EXT,Ie[Cu]=U.MAX_EXT)}const Be={[N0]:0,[D0]:1,[I0]:768,[Uf]:770,[k0]:776,[z0]:774,[B0]:772,[F0]:769,[kf]:771,[U0]:775,[O0]:773};function Xe(U,ce,oe,Ue,q,Pe,ct,pt){if(U===Wi){x===!0&&(Oe(3042),x=!1);return}if(x===!1&&(Ee(3042),x=!0),U!==L0){if(U!==v||pt!==m){if((b!==Xr||S!==Xr)&&(r.blendEquation(32774),b=Xr,S=Xr),pt)switch(U){case Gs:r.blendFuncSeparate(1,771,1,771);break;case Su:r.blendFunc(1,1);break;case Eu:r.blendFuncSeparate(0,0,769,771);break;case Tu:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",U);break}else switch(U){case Gs:r.blendFuncSeparate(770,771,1,771);break;case Su:r.blendFunc(770,1);break;case Eu:r.blendFunc(0,769);break;case Tu:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",U);break}y=null,w=null,L=null,T=null,v=U,m=pt}return}q=q||ce,Pe=Pe||oe,ct=ct||Ue,(ce!==b||q!==S)&&(r.blendEquationSeparate(Ie[ce],Ie[q]),b=ce,S=q),(oe!==y||Ue!==w||Pe!==L||ct!==T)&&(r.blendFuncSeparate(Be[oe],Be[Ue],Be[Pe],Be[ct]),y=oe,w=Ue,L=Pe,T=ct),v=U,m=null}function fe(U,ce){U.side===ss?Oe(2884):Ee(2884);let oe=U.side===Jt;ce&&(oe=!oe),ge(oe),U.blending===Gs&&U.transparent===!1?Xe(Wi):Xe(U.blending,U.blendEquation,U.blendSrc,U.blendDst,U.blendEquationAlpha,U.blendSrcAlpha,U.blendDstAlpha,U.premultipliedAlpha),u.setFunc(U.depthFunc),u.setTest(U.depthTest),u.setMask(U.depthWrite),o.setMask(U.colorWrite);const Ue=U.stencilWrite;f.setTest(Ue),Ue&&(f.setMask(U.stencilWriteMask),f.setFunc(U.stencilFunc,U.stencilRef,U.stencilFuncMask),f.setOp(U.stencilFail,U.stencilZFail,U.stencilZPass)),pe(U.polygonOffset,U.polygonOffsetFactor,U.polygonOffsetUnits),U.alphaToCoverage===!0?Ee(32926):Oe(32926)}function ge(U){C!==U&&(U?r.frontFace(2304):r.frontFace(2305),C=U)}function Ae(U){U!==T0?(Ee(2884),U!==N&&(U===Mu?r.cullFace(1029):U===A0?r.cullFace(1028):r.cullFace(1032))):Oe(2884),N=U}function ke(U){U!==z&&($&&r.lineWidth(U),z=U)}function pe(U,ce,oe){U?(Ee(32823),(W!==ce||B!==oe)&&(r.polygonOffset(ce,oe),W=ce,B=oe)):Oe(32823)}function O(U){U?Ee(3089):Oe(3089)}function F(U){U===void 0&&(U=33984+se-1),j!==U&&(r.activeTexture(U),j=U)}function ye(U,ce){j===null&&F();let oe=ie[j];oe===void 0&&(oe={type:void 0,texture:void 0},ie[j]=oe),(oe.type!==U||oe.texture!==ce)&&(r.bindTexture(U,ce||ue[U]),oe.type=U,oe.texture=ce)}function D(){const U=ie[j];U!==void 0&&U.type!==void 0&&(r.bindTexture(U.type,null),U.type=void 0,U.texture=void 0)}function X(){try{r.compressedTexImage2D.apply(r,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function J(){try{r.texImage2D.apply(r,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function Y(){try{r.texImage3D.apply(r,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function ve(U){Ne.equals(U)===!1&&(r.scissor(U.x,U.y,U.z,U.w),Ne.copy(U))}function Te(U){Se.equals(U)===!1&&(r.viewport(U.x,U.y,U.z,U.w),Se.copy(U))}function Me(){r.disable(3042),r.disable(2884),r.disable(2929),r.disable(32823),r.disable(3089),r.disable(2960),r.disable(32926),r.blendEquation(32774),r.blendFunc(1,0),r.blendFuncSeparate(1,0,1,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(513),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(519,0,4294967295),r.stencilOp(7680,7680,7680),r.clearStencil(0),r.cullFace(1029),r.frontFace(2305),r.polygonOffset(0,0),r.activeTexture(33984),r.bindFramebuffer(36160,null),n===!0&&(r.bindFramebuffer(36009,null),r.bindFramebuffer(36008,null)),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),h={},j=null,ie={},c=null,d={},g=null,x=!1,v=null,b=null,y=null,w=null,S=null,L=null,T=null,m=!1,C=null,N=null,z=null,W=null,B=null,Ne.set(0,0,r.canvas.width,r.canvas.height),Se.set(0,0,r.canvas.width,r.canvas.height),o.reset(),u.reset(),f.reset()}return{buffers:{color:o,depth:u,stencil:f},enable:Ee,disable:Oe,bindFramebuffer:ze,bindXRFramebuffer:re,useProgram:je,setBlending:Xe,setMaterial:fe,setFlipSided:ge,setCullFace:Ae,setLineWidth:ke,setPolygonOffset:pe,setScissorTest:O,activeTexture:F,bindTexture:ye,unbindTexture:D,compressedTexImage2D:X,texImage2D:J,texImage3D:Y,scissor:ve,viewport:Te,reset:Me}}function Ib(r,e,t,n,i,s,a){const o=i.isWebGL2,u=i.maxTextures,f=i.maxCubemapSize,h=i.maxTextureSize,c=i.maxSamples,d=new WeakMap;let g,x=!1;try{x=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(O,F){return x?new OffscreenCanvas(O,F):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function b(O,F,ye,D){let X=1;if((O.width>D||O.height>D)&&(X=D/Math.max(O.width,O.height)),X<1||F===!0)if(typeof HTMLImageElement!="undefined"&&O instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&O instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&O instanceof ImageBitmap){const J=F?ry:Math.floor,Y=J(X*O.width),ve=J(X*O.height);g===void 0&&(g=v(Y,ve));const Te=ye?v(Y,ve):g;return Te.width=Y,Te.height=ve,Te.getContext("2d").drawImage(O,0,0,Y,ve),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+O.width+"x"+O.height+") to ("+Y+"x"+ve+")."),Te}else return"data"in O&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+O.width+"x"+O.height+")."),O;return O}function y(O){return Vu(O.width)&&Vu(O.height)}function w(O){return o?!1:O.wrapS!==Vn||O.wrapT!==Vn||O.minFilter!==nn&&O.minFilter!==Yn}function S(O,F){return O.generateMipmaps&&F&&O.minFilter!==nn&&O.minFilter!==Yn}function L(O,F,ye,D,X=1){r.generateMipmap(O);const J=n.get(F);J.__maxMipLevel=Math.log2(Math.max(ye,D,X))}function T(O,F,ye){if(o===!1)return F;if(O!==null){if(r[O]!==void 0)return r[O];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+O+"'")}let D=F;return F===6403&&(ye===5126&&(D=33326),ye===5131&&(D=33325),ye===5121&&(D=33321)),F===6407&&(ye===5126&&(D=34837),ye===5131&&(D=34843),ye===5121&&(D=32849)),F===6408&&(ye===5126&&(D=34836),ye===5131&&(D=34842),ye===5121&&(D=32856)),(D===33325||D===33326||D===34842||D===34836)&&e.get("EXT_color_buffer_float"),D}function m(O){return O===nn||O===Lu||O===Ru?9728:9729}function C(O){const F=O.target;F.removeEventListener("dispose",C),z(F),F.isVideoTexture&&d.delete(F),a.memory.textures--}function N(O){const F=O.target;F.removeEventListener("dispose",N),W(F)}function z(O){const F=n.get(O);F.__webglInit!==void 0&&(r.deleteTexture(F.__webglTexture),n.remove(O))}function W(O){const F=O.texture,ye=n.get(O),D=n.get(F);if(!!O){if(D.__webglTexture!==void 0&&(r.deleteTexture(D.__webglTexture),a.memory.textures--),O.depthTexture&&O.depthTexture.dispose(),O.isWebGLCubeRenderTarget)for(let X=0;X<6;X++)r.deleteFramebuffer(ye.__webglFramebuffer[X]),ye.__webglDepthbuffer&&r.deleteRenderbuffer(ye.__webglDepthbuffer[X]);else r.deleteFramebuffer(ye.__webglFramebuffer),ye.__webglDepthbuffer&&r.deleteRenderbuffer(ye.__webglDepthbuffer),ye.__webglMultisampledFramebuffer&&r.deleteFramebuffer(ye.__webglMultisampledFramebuffer),ye.__webglColorRenderbuffer&&r.deleteRenderbuffer(ye.__webglColorRenderbuffer),ye.__webglDepthRenderbuffer&&r.deleteRenderbuffer(ye.__webglDepthRenderbuffer);if(O.isWebGLMultipleRenderTargets)for(let X=0,J=F.length;X<J;X++){const Y=n.get(F[X]);Y.__webglTexture&&(r.deleteTexture(Y.__webglTexture),a.memory.textures--),n.remove(F[X])}n.remove(F),n.remove(O)}}let B=0;function se(){B=0}function $(){const O=B;return O>=u&&console.warn("THREE.WebGLTextures: Trying to use "+O+" texture units while this GPU supports only "+u),B+=1,O}function Q(O,F){const ye=n.get(O);if(O.isVideoTexture&&fe(O),O.version>0&&ye.__version!==O.version){const D=O.image;if(D===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(D.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ve(ye,O,F);return}}t.activeTexture(33984+F),t.bindTexture(3553,ye.__webglTexture)}function K(O,F){const ye=n.get(O);if(O.version>0&&ye.__version!==O.version){Ve(ye,O,F);return}t.activeTexture(33984+F),t.bindTexture(35866,ye.__webglTexture)}function j(O,F){const ye=n.get(O);if(O.version>0&&ye.__version!==O.version){Ve(ye,O,F);return}t.activeTexture(33984+F),t.bindTexture(32879,ye.__webglTexture)}function ie(O,F){const ye=n.get(O);if(O.version>0&&ye.__version!==O.version){ue(ye,O,F);return}t.activeTexture(33984+F),t.bindTexture(34067,ye.__webglTexture)}const de={[ec]:10497,[Vn]:33071,[tc]:33648},we={[nn]:9728,[Lu]:9984,[Ru]:9986,[Yn]:9729,[tv]:9985,[Eo]:9987};function Ne(O,F,ye){if(ye?(r.texParameteri(O,10242,de[F.wrapS]),r.texParameteri(O,10243,de[F.wrapT]),(O===32879||O===35866)&&r.texParameteri(O,32882,de[F.wrapR]),r.texParameteri(O,10240,we[F.magFilter]),r.texParameteri(O,10241,we[F.minFilter])):(r.texParameteri(O,10242,33071),r.texParameteri(O,10243,33071),(O===32879||O===35866)&&r.texParameteri(O,32882,33071),(F.wrapS!==Vn||F.wrapT!==Vn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(O,10240,m(F.magFilter)),r.texParameteri(O,10241,m(F.minFilter)),F.minFilter!==nn&&F.minFilter!==Yn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const D=e.get("EXT_texture_filter_anisotropic");if(F.type===mr&&e.has("OES_texture_float_linear")===!1||o===!1&&F.type===es&&e.has("OES_texture_half_float_linear")===!1)return;(F.anisotropy>1||n.get(F).__currentAnisotropy)&&(r.texParameterf(O,D.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(F.anisotropy,i.getMaxAnisotropy())),n.get(F).__currentAnisotropy=F.anisotropy)}}function Se(O,F){O.__webglInit===void 0&&(O.__webglInit=!0,F.addEventListener("dispose",C),O.__webglTexture=r.createTexture(),a.memory.textures++)}function Ve(O,F,ye){let D=3553;F.isDataTexture2DArray&&(D=35866),F.isDataTexture3D&&(D=32879),Se(O,F),t.activeTexture(33984+ye),t.bindTexture(D,O.__webglTexture),r.pixelStorei(37440,F.flipY),r.pixelStorei(37441,F.premultiplyAlpha),r.pixelStorei(3317,F.unpackAlignment),r.pixelStorei(37443,0);const X=w(F)&&y(F.image)===!1,J=b(F.image,X,!1,h),Y=y(J)||o,ve=s.convert(F.format);let Te=s.convert(F.type),Me=T(F.internalFormat,ve,Te);Ne(D,F,Y);let U;const ce=F.mipmaps;if(F.isDepthTexture)Me=6402,o?F.type===mr?Me=36012:F.type===Za?Me=33190:F.type===Ws?Me=35056:Me=33189:F.type===mr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),F.format===ts&&Me===6402&&F.type!==ro&&F.type!==Za&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),F.type=ro,Te=s.convert(F.type)),F.format===Js&&Me===6402&&(Me=34041,F.type!==Ws&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),F.type=Ws,Te=s.convert(F.type))),t.texImage2D(3553,0,Me,J.width,J.height,0,ve,Te,null);else if(F.isDataTexture)if(ce.length>0&&Y){for(let oe=0,Ue=ce.length;oe<Ue;oe++)U=ce[oe],t.texImage2D(3553,oe,Me,U.width,U.height,0,ve,Te,U.data);F.generateMipmaps=!1,O.__maxMipLevel=ce.length-1}else t.texImage2D(3553,0,Me,J.width,J.height,0,ve,Te,J.data),O.__maxMipLevel=0;else if(F.isCompressedTexture){for(let oe=0,Ue=ce.length;oe<Ue;oe++)U=ce[oe],F.format!==Gn&&F.format!==qi?ve!==null?t.compressedTexImage2D(3553,oe,Me,U.width,U.height,0,U.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(3553,oe,Me,U.width,U.height,0,ve,Te,U.data);O.__maxMipLevel=ce.length-1}else if(F.isDataTexture2DArray)t.texImage3D(35866,0,Me,J.width,J.height,J.depth,0,ve,Te,J.data),O.__maxMipLevel=0;else if(F.isDataTexture3D)t.texImage3D(32879,0,Me,J.width,J.height,J.depth,0,ve,Te,J.data),O.__maxMipLevel=0;else if(ce.length>0&&Y){for(let oe=0,Ue=ce.length;oe<Ue;oe++)U=ce[oe],t.texImage2D(3553,oe,Me,ve,Te,U);F.generateMipmaps=!1,O.__maxMipLevel=ce.length-1}else t.texImage2D(3553,0,Me,ve,Te,J),O.__maxMipLevel=0;S(F,Y)&&L(D,F,J.width,J.height),O.__version=F.version,F.onUpdate&&F.onUpdate(F)}function ue(O,F,ye){if(F.image.length!==6)return;Se(O,F),t.activeTexture(33984+ye),t.bindTexture(34067,O.__webglTexture),r.pixelStorei(37440,F.flipY),r.pixelStorei(37441,F.premultiplyAlpha),r.pixelStorei(3317,F.unpackAlignment),r.pixelStorei(37443,0);const D=F&&(F.isCompressedTexture||F.image[0].isCompressedTexture),X=F.image[0]&&F.image[0].isDataTexture,J=[];for(let oe=0;oe<6;oe++)!D&&!X?J[oe]=b(F.image[oe],!1,!0,f):J[oe]=X?F.image[oe].image:F.image[oe];const Y=J[0],ve=y(Y)||o,Te=s.convert(F.format),Me=s.convert(F.type),U=T(F.internalFormat,Te,Me);Ne(34067,F,ve);let ce;if(D){for(let oe=0;oe<6;oe++){ce=J[oe].mipmaps;for(let Ue=0;Ue<ce.length;Ue++){const q=ce[Ue];F.format!==Gn&&F.format!==qi?Te!==null?t.compressedTexImage2D(34069+oe,Ue,U,q.width,q.height,0,q.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(34069+oe,Ue,U,q.width,q.height,0,Te,Me,q.data)}}O.__maxMipLevel=ce.length-1}else{ce=F.mipmaps;for(let oe=0;oe<6;oe++)if(X){t.texImage2D(34069+oe,0,U,J[oe].width,J[oe].height,0,Te,Me,J[oe].data);for(let Ue=0;Ue<ce.length;Ue++){const Pe=ce[Ue].image[oe].image;t.texImage2D(34069+oe,Ue+1,U,Pe.width,Pe.height,0,Te,Me,Pe.data)}}else{t.texImage2D(34069+oe,0,U,Te,Me,J[oe]);for(let Ue=0;Ue<ce.length;Ue++){const q=ce[Ue];t.texImage2D(34069+oe,Ue+1,U,Te,Me,q.image[oe])}}O.__maxMipLevel=ce.length}S(F,ve)&&L(34067,F,Y.width,Y.height),O.__version=F.version,F.onUpdate&&F.onUpdate(F)}function Ee(O,F,ye,D,X){const J=s.convert(ye.format),Y=s.convert(ye.type),ve=T(ye.internalFormat,J,Y);X===32879||X===35866?t.texImage3D(X,0,ve,F.width,F.height,F.depth,0,J,Y,null):t.texImage2D(X,0,ve,F.width,F.height,0,J,Y,null),t.bindFramebuffer(36160,O),r.framebufferTexture2D(36160,D,X,n.get(ye).__webglTexture,0),t.bindFramebuffer(36160,null)}function Oe(O,F,ye){if(r.bindRenderbuffer(36161,O),F.depthBuffer&&!F.stencilBuffer){let D=33189;if(ye){const X=F.depthTexture;X&&X.isDepthTexture&&(X.type===mr?D=36012:X.type===Za&&(D=33190));const J=Xe(F);r.renderbufferStorageMultisample(36161,J,D,F.width,F.height)}else r.renderbufferStorage(36161,D,F.width,F.height);r.framebufferRenderbuffer(36160,36096,36161,O)}else if(F.depthBuffer&&F.stencilBuffer){if(ye){const D=Xe(F);r.renderbufferStorageMultisample(36161,D,35056,F.width,F.height)}else r.renderbufferStorage(36161,34041,F.width,F.height);r.framebufferRenderbuffer(36160,33306,36161,O)}else{const D=F.isWebGLMultipleRenderTargets===!0?F.texture[0]:F.texture,X=s.convert(D.format),J=s.convert(D.type),Y=T(D.internalFormat,X,J);if(ye){const ve=Xe(F);r.renderbufferStorageMultisample(36161,ve,Y,F.width,F.height)}else r.renderbufferStorage(36161,Y,F.width,F.height)}r.bindRenderbuffer(36161,null)}function re(O,F){if(F&&F.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,O),!(F.depthTexture&&F.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(F.depthTexture).__webglTexture||F.depthTexture.image.width!==F.width||F.depthTexture.image.height!==F.height)&&(F.depthTexture.image.width=F.width,F.depthTexture.image.height=F.height,F.depthTexture.needsUpdate=!0),Q(F.depthTexture,0);const D=n.get(F.depthTexture).__webglTexture;if(F.depthTexture.format===ts)r.framebufferTexture2D(36160,36096,3553,D,0);else if(F.depthTexture.format===Js)r.framebufferTexture2D(36160,33306,3553,D,0);else throw new Error("Unknown depthTexture format")}function ze(O){const F=n.get(O),ye=O.isWebGLCubeRenderTarget===!0;if(O.depthTexture){if(ye)throw new Error("target.depthTexture not supported in Cube render targets");re(F.__webglFramebuffer,O)}else if(ye){F.__webglDepthbuffer=[];for(let D=0;D<6;D++)t.bindFramebuffer(36160,F.__webglFramebuffer[D]),F.__webglDepthbuffer[D]=r.createRenderbuffer(),Oe(F.__webglDepthbuffer[D],O,!1)}else t.bindFramebuffer(36160,F.__webglFramebuffer),F.__webglDepthbuffer=r.createRenderbuffer(),Oe(F.__webglDepthbuffer,O,!1);t.bindFramebuffer(36160,null)}function je(O){const F=O.texture,ye=n.get(O),D=n.get(F);O.addEventListener("dispose",N),O.isWebGLMultipleRenderTargets!==!0&&(D.__webglTexture=r.createTexture(),D.__version=F.version,a.memory.textures++);const X=O.isWebGLCubeRenderTarget===!0,J=O.isWebGLMultipleRenderTargets===!0,Y=O.isWebGLMultisampleRenderTarget===!0,ve=F.isDataTexture3D||F.isDataTexture2DArray,Te=y(O)||o;if(o&&F.format===qi&&(F.type===mr||F.type===es)&&(F.format=Gn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),X){ye.__webglFramebuffer=[];for(let Me=0;Me<6;Me++)ye.__webglFramebuffer[Me]=r.createFramebuffer()}else if(ye.__webglFramebuffer=r.createFramebuffer(),J)if(i.drawBuffers){const Me=O.texture;for(let U=0,ce=Me.length;U<ce;U++){const oe=n.get(Me[U]);oe.__webglTexture===void 0&&(oe.__webglTexture=r.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Y)if(o){ye.__webglMultisampledFramebuffer=r.createFramebuffer(),ye.__webglColorRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,ye.__webglColorRenderbuffer);const Me=s.convert(F.format),U=s.convert(F.type),ce=T(F.internalFormat,Me,U),oe=Xe(O);r.renderbufferStorageMultisample(36161,oe,ce,O.width,O.height),t.bindFramebuffer(36160,ye.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064,36161,ye.__webglColorRenderbuffer),r.bindRenderbuffer(36161,null),O.depthBuffer&&(ye.__webglDepthRenderbuffer=r.createRenderbuffer(),Oe(ye.__webglDepthRenderbuffer,O,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(X){t.bindTexture(34067,D.__webglTexture),Ne(34067,F,Te);for(let Me=0;Me<6;Me++)Ee(ye.__webglFramebuffer[Me],O,F,36064,34069+Me);S(F,Te)&&L(34067,F,O.width,O.height),t.unbindTexture()}else if(J){const Me=O.texture;for(let U=0,ce=Me.length;U<ce;U++){const oe=Me[U],Ue=n.get(oe);t.bindTexture(3553,Ue.__webglTexture),Ne(3553,oe,Te),Ee(ye.__webglFramebuffer,O,oe,36064+U,3553),S(oe,Te)&&L(3553,oe,O.width,O.height)}t.unbindTexture()}else{let Me=3553;ve&&(o?Me=F.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(Me,D.__webglTexture),Ne(Me,F,Te),Ee(ye.__webglFramebuffer,O,F,36064,Me),S(F,Te)&&L(Me,F,O.width,O.height,O.depth),t.unbindTexture()}O.depthBuffer&&ze(O)}function Ie(O){const F=y(O)||o,ye=O.isWebGLMultipleRenderTargets===!0?O.texture:[O.texture];for(let D=0,X=ye.length;D<X;D++){const J=ye[D];if(S(J,F)){const Y=O.isWebGLCubeRenderTarget?34067:3553,ve=n.get(J).__webglTexture;t.bindTexture(Y,ve),L(Y,J,O.width,O.height),t.unbindTexture()}}}function Be(O){if(O.isWebGLMultisampleRenderTarget)if(o){const F=O.width,ye=O.height;let D=16384;O.depthBuffer&&(D|=256),O.stencilBuffer&&(D|=1024);const X=n.get(O);t.bindFramebuffer(36008,X.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,X.__webglFramebuffer),r.blitFramebuffer(0,0,F,ye,0,0,F,ye,D,9728),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,X.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Xe(O){return o&&O.isWebGLMultisampleRenderTarget?Math.min(c,O.samples):0}function fe(O){const F=a.render.frame;d.get(O)!==F&&(d.set(O,F),O.update())}let ge=!1,Ae=!1;function ke(O,F){O&&O.isWebGLRenderTarget&&(ge===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),ge=!0),O=O.texture),Q(O,F)}function pe(O,F){O&&O.isWebGLCubeRenderTarget&&(Ae===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ae=!0),O=O.texture),ie(O,F)}this.allocateTextureUnit=$,this.resetTextureUnits=se,this.setTexture2D=Q,this.setTexture2DArray=K,this.setTexture3D=j,this.setTextureCube=ie,this.setupRenderTarget=je,this.updateRenderTargetMipmap=Ie,this.updateMultisampleRenderTarget=Be,this.safeSetTexture2D=ke,this.safeSetTextureCube=pe}function Fb(r,e,t){const n=t.isWebGL2;function i(s){let a;if(s===as)return 5121;if(s===sv)return 32819;if(s===av)return 32820;if(s===ov)return 33635;if(s===nv)return 5120;if(s===iv)return 5122;if(s===ro)return 5123;if(s===rv)return 5124;if(s===Za)return 5125;if(s===mr)return 5126;if(s===es)return n?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===lv)return 6406;if(s===qi)return 6407;if(s===Gn)return 6408;if(s===cv)return 6409;if(s===uv)return 6410;if(s===ts)return 6402;if(s===Js)return 34041;if(s===fv)return 6403;if(s===dv)return 36244;if(s===pv)return 33319;if(s===mv)return 33320;if(s===gv)return 36248;if(s===vv)return 36249;if(s===Pu||s===Nu||s===Du||s===Iu)if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Pu)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Nu)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Du)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Iu)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===Fu||s===Bu||s===Ou||s===zu)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===Fu)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===Bu)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===Ou)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===zu)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===yv)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if((s===Uu||s===ku)&&(a=e.get("WEBGL_compressed_texture_etc"),a!==null)){if(s===Uu)return a.COMPRESSED_RGB8_ETC2;if(s===ku)return a.COMPRESSED_RGBA8_ETC2_EAC}if(s===xv||s===_v||s===wv||s===bv||s===Mv||s===Sv||s===Ev||s===Tv||s===Av||s===Cv||s===Lv||s===Rv||s===Pv||s===Nv||s===Iv||s===Fv||s===Bv||s===Ov||s===zv||s===Uv||s===kv||s===Hv||s===Vv||s===Gv||s===Wv||s===qv||s===jv||s===Xv)return a=e.get("WEBGL_compressed_texture_astc"),a!==null?s:null;if(s===Dv)return a=e.get("EXT_texture_compression_bptc"),a!==null?s:null;if(s===Ws)return n?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:i}}class dd extends xn{constructor(e=[]){super(),this.cameras=e}}dd.prototype.isArrayCamera=!0;class Jr extends bt{constructor(){super(),this.type="Group"}}Jr.prototype.isGroup=!0;const Bb={type:"move"};class Nl{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Jr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Jr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new V,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new V),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Jr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new V,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new V),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,s=null,a=null;const o=this._targetRay,u=this._grip,f=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(o!==null&&(i=t.getPose(e.targetRaySpace,n),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Bb))),f&&e.hand){a=!0;for(const v of e.hand.values()){const b=t.getJointPose(v,n);if(f.joints[v.jointName]===void 0){const w=new Jr;w.matrixAutoUpdate=!1,w.visible=!1,f.joints[v.jointName]=w,f.add(w)}const y=f.joints[v.jointName];b!==null&&(y.matrix.fromArray(b.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=b.radius),y.visible=b!==null}const h=f.joints["index-finger-tip"],c=f.joints["thumb-tip"],d=h.position.distanceTo(c.position),g=.02,x=.005;f.inputState.pinching&&d>g+x?(f.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!f.inputState.pinching&&d<=g-x&&(f.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(u.matrix.fromArray(s.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),s.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(s.linearVelocity)):u.hasLinearVelocity=!1,s.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(s.angularVelocity)):u.hasAngularVelocity=!1));return o!==null&&(o.visible=i!==null),u!==null&&(u.visible=s!==null),f!==null&&(f.visible=a!==null),this}}class Ob extends Ki{constructor(e,t){super();const n=this,i=e.state;let s=null,a=1,o=null,u="local-floor",f=null,h=null,c=null,d=null,g=null,x=!1,v=null,b=null,y=null,w=null,S=null,L=null;const T=[],m=new Map,C=new xn;C.layers.enable(1),C.viewport=new Ct;const N=new xn;N.layers.enable(2),N.viewport=new Ct;const z=[C,N],W=new dd;W.layers.enable(1),W.layers.enable(2);let B=null,se=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ue){let Ee=T[ue];return Ee===void 0&&(Ee=new Nl,T[ue]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ue){let Ee=T[ue];return Ee===void 0&&(Ee=new Nl,T[ue]=Ee),Ee.getGripSpace()},this.getHand=function(ue){let Ee=T[ue];return Ee===void 0&&(Ee=new Nl,T[ue]=Ee),Ee.getHandSpace()};function $(ue){const Ee=m.get(ue.inputSource);Ee&&Ee.dispatchEvent({type:ue.type,data:ue.inputSource})}function Q(){m.forEach(function(ue,Ee){ue.disconnect(Ee)}),m.clear(),B=null,se=null,i.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),c&&t.deleteFramebuffer(c),v&&t.deleteFramebuffer(v),b&&t.deleteRenderbuffer(b),y&&t.deleteRenderbuffer(y),c=null,v=null,b=null,y=null,g=null,d=null,h=null,s=null,Ve.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ue){a=ue,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ue){u=ue,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return d!==null?d:g},this.getBinding=function(){return h},this.getFrame=function(){return w},this.getSession=function(){return s},this.setSession=async function(ue){if(s=ue,s!==null){s.addEventListener("select",$),s.addEventListener("selectstart",$),s.addEventListener("selectend",$),s.addEventListener("squeeze",$),s.addEventListener("squeezestart",$),s.addEventListener("squeezeend",$),s.addEventListener("end",Q),s.addEventListener("inputsourceschange",K);const Ee=t.getContextAttributes();if(Ee.xrCompatible!==!0&&await t.makeXRCompatible(),s.renderState.layers===void 0){const Oe={antialias:Ee.antialias,alpha:Ee.alpha,depth:Ee.depth,stencil:Ee.stencil,framebufferScaleFactor:a};g=new XRWebGLLayer(s,t,Oe),s.updateRenderState({baseLayer:g})}else if(t instanceof WebGLRenderingContext){const Oe={antialias:!0,alpha:Ee.alpha,depth:Ee.depth,stencil:Ee.stencil,framebufferScaleFactor:a};g=new XRWebGLLayer(s,t,Oe),s.updateRenderState({layers:[g]})}else{x=Ee.antialias;let Oe=null;Ee.depth&&(L=256,Ee.stencil&&(L|=1024),S=Ee.stencil?33306:36096,Oe=Ee.stencil?35056:33190);const re={colorFormat:Ee.alpha?32856:32849,depthFormat:Oe,scaleFactor:a};h=new XRWebGLBinding(s,t),d=h.createProjectionLayer(re),c=t.createFramebuffer(),s.updateRenderState({layers:[d]}),x&&(v=t.createFramebuffer(),b=t.createRenderbuffer(),t.bindRenderbuffer(36161,b),t.renderbufferStorageMultisample(36161,4,32856,d.textureWidth,d.textureHeight),i.bindFramebuffer(36160,v),t.framebufferRenderbuffer(36160,36064,36161,b),t.bindRenderbuffer(36161,null),Oe!==null&&(y=t.createRenderbuffer(),t.bindRenderbuffer(36161,y),t.renderbufferStorageMultisample(36161,4,Oe,d.textureWidth,d.textureHeight),t.framebufferRenderbuffer(36160,S,36161,y),t.bindRenderbuffer(36161,null)),i.bindFramebuffer(36160,null))}o=await s.requestReferenceSpace(u),Ve.setContext(s),Ve.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function K(ue){const Ee=s.inputSources;for(let Oe=0;Oe<T.length;Oe++)m.set(Ee[Oe],T[Oe]);for(let Oe=0;Oe<ue.removed.length;Oe++){const re=ue.removed[Oe],ze=m.get(re);ze&&(ze.dispatchEvent({type:"disconnected",data:re}),m.delete(re))}for(let Oe=0;Oe<ue.added.length;Oe++){const re=ue.added[Oe],ze=m.get(re);ze&&ze.dispatchEvent({type:"connected",data:re})}}const j=new V,ie=new V;function de(ue,Ee,Oe){j.setFromMatrixPosition(Ee.matrixWorld),ie.setFromMatrixPosition(Oe.matrixWorld);const re=j.distanceTo(ie),ze=Ee.projectionMatrix.elements,je=Oe.projectionMatrix.elements,Ie=ze[14]/(ze[10]-1),Be=ze[14]/(ze[10]+1),Xe=(ze[9]+1)/ze[5],fe=(ze[9]-1)/ze[5],ge=(ze[8]-1)/ze[0],Ae=(je[8]+1)/je[0],ke=Ie*ge,pe=Ie*Ae,O=re/(-ge+Ae),F=O*-ge;Ee.matrixWorld.decompose(ue.position,ue.quaternion,ue.scale),ue.translateX(F),ue.translateZ(O),ue.matrixWorld.compose(ue.position,ue.quaternion,ue.scale),ue.matrixWorldInverse.copy(ue.matrixWorld).invert();const ye=Ie+O,D=Be+O,X=ke-F,J=pe+(re-F),Y=Xe*Be/D*ye,ve=fe*Be/D*ye;ue.projectionMatrix.makePerspective(X,J,Y,ve,ye,D)}function we(ue,Ee){Ee===null?ue.matrixWorld.copy(ue.matrix):ue.matrixWorld.multiplyMatrices(Ee.matrixWorld,ue.matrix),ue.matrixWorldInverse.copy(ue.matrixWorld).invert()}this.updateCamera=function(ue){if(s===null)return;W.near=N.near=C.near=ue.near,W.far=N.far=C.far=ue.far,(B!==W.near||se!==W.far)&&(s.updateRenderState({depthNear:W.near,depthFar:W.far}),B=W.near,se=W.far);const Ee=ue.parent,Oe=W.cameras;we(W,Ee);for(let ze=0;ze<Oe.length;ze++)we(Oe[ze],Ee);W.matrixWorld.decompose(W.position,W.quaternion,W.scale),ue.position.copy(W.position),ue.quaternion.copy(W.quaternion),ue.scale.copy(W.scale),ue.matrix.copy(W.matrix),ue.matrixWorld.copy(W.matrixWorld);const re=ue.children;for(let ze=0,je=re.length;ze<je;ze++)re[ze].updateMatrixWorld(!0);Oe.length===2?de(W,C,N):W.projectionMatrix.copy(C.projectionMatrix)},this.getCamera=function(){return W},this.getFoveation=function(){if(d!==null)return d.fixedFoveation;if(g!==null)return g.fixedFoveation},this.setFoveation=function(ue){d!==null&&(d.fixedFoveation=ue),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=ue)};let Ne=null;function Se(ue,Ee){if(f=Ee.getViewerPose(o),w=Ee,f!==null){const re=f.views;g!==null&&i.bindXRFramebuffer(g.framebuffer);let ze=!1;re.length!==W.cameras.length&&(W.cameras.length=0,ze=!0);for(let je=0;je<re.length;je++){const Ie=re[je];let Be=null;if(g!==null)Be=g.getViewport(Ie);else{const fe=h.getViewSubImage(d,Ie);i.bindXRFramebuffer(c),fe.depthStencilTexture!==void 0&&t.framebufferTexture2D(36160,S,3553,fe.depthStencilTexture,0),t.framebufferTexture2D(36160,36064,3553,fe.colorTexture,0),Be=fe.viewport}const Xe=z[je];Xe.matrix.fromArray(Ie.transform.matrix),Xe.projectionMatrix.fromArray(Ie.projectionMatrix),Xe.viewport.set(Be.x,Be.y,Be.width,Be.height),je===0&&W.matrix.copy(Xe.matrix),ze===!0&&W.cameras.push(Xe)}x&&(i.bindXRFramebuffer(v),L!==null&&t.clear(L))}const Oe=s.inputSources;for(let re=0;re<T.length;re++){const ze=T[re],je=Oe[re];ze.update(je,Ee,o)}if(Ne&&Ne(ue,Ee),x){const re=d.textureWidth,ze=d.textureHeight;i.bindFramebuffer(36008,v),i.bindFramebuffer(36009,c),t.invalidateFramebuffer(36008,[S]),t.invalidateFramebuffer(36009,[S]),t.blitFramebuffer(0,0,re,ze,0,0,re,ze,16384,9728),t.invalidateFramebuffer(36008,[36064]),i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),i.bindFramebuffer(36160,v)}w=null}const Ve=new Qf;Ve.setAnimationLoop(Se),this.setAnimationLoop=function(ue){Ne=ue},this.dispose=function(){}}}function zb(r){function e(y,w){y.fogColor.value.copy(w.color),w.isFog?(y.fogNear.value=w.near,y.fogFar.value=w.far):w.isFogExp2&&(y.fogDensity.value=w.density)}function t(y,w,S,L,T){w.isMeshBasicMaterial?n(y,w):w.isMeshLambertMaterial?(n(y,w),u(y,w)):w.isMeshToonMaterial?(n(y,w),h(y,w)):w.isMeshPhongMaterial?(n(y,w),f(y,w)):w.isMeshStandardMaterial?(n(y,w),w.isMeshPhysicalMaterial?d(y,w,T):c(y,w)):w.isMeshMatcapMaterial?(n(y,w),g(y,w)):w.isMeshDepthMaterial?(n(y,w),x(y,w)):w.isMeshDistanceMaterial?(n(y,w),v(y,w)):w.isMeshNormalMaterial?(n(y,w),b(y,w)):w.isLineBasicMaterial?(i(y,w),w.isLineDashedMaterial&&s(y,w)):w.isPointsMaterial?a(y,w,S,L):w.isSpriteMaterial?o(y,w):w.isShadowMaterial?(y.color.value.copy(w.color),y.opacity.value=w.opacity):w.isShaderMaterial&&(w.uniformsNeedUpdate=!1)}function n(y,w){y.opacity.value=w.opacity,w.color&&y.diffuse.value.copy(w.color),w.emissive&&y.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(y.map.value=w.map),w.alphaMap&&(y.alphaMap.value=w.alphaMap),w.specularMap&&(y.specularMap.value=w.specularMap),w.alphaTest>0&&(y.alphaTest.value=w.alphaTest);const S=r.get(w).envMap;if(S){y.envMap.value=S,y.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=w.reflectivity,y.ior.value=w.ior,y.refractionRatio.value=w.refractionRatio;const m=r.get(S).__maxMipLevel;m!==void 0&&(y.maxMipLevel.value=m)}w.lightMap&&(y.lightMap.value=w.lightMap,y.lightMapIntensity.value=w.lightMapIntensity),w.aoMap&&(y.aoMap.value=w.aoMap,y.aoMapIntensity.value=w.aoMapIntensity);let L;w.map?L=w.map:w.specularMap?L=w.specularMap:w.displacementMap?L=w.displacementMap:w.normalMap?L=w.normalMap:w.bumpMap?L=w.bumpMap:w.roughnessMap?L=w.roughnessMap:w.metalnessMap?L=w.metalnessMap:w.alphaMap?L=w.alphaMap:w.emissiveMap?L=w.emissiveMap:w.clearcoatMap?L=w.clearcoatMap:w.clearcoatNormalMap?L=w.clearcoatNormalMap:w.clearcoatRoughnessMap?L=w.clearcoatRoughnessMap:w.specularIntensityMap?L=w.specularIntensityMap:w.specularTintMap?L=w.specularTintMap:w.transmissionMap?L=w.transmissionMap:w.thicknessMap&&(L=w.thicknessMap),L!==void 0&&(L.isWebGLRenderTarget&&(L=L.texture),L.matrixAutoUpdate===!0&&L.updateMatrix(),y.uvTransform.value.copy(L.matrix));let T;w.aoMap?T=w.aoMap:w.lightMap&&(T=w.lightMap),T!==void 0&&(T.isWebGLRenderTarget&&(T=T.texture),T.matrixAutoUpdate===!0&&T.updateMatrix(),y.uv2Transform.value.copy(T.matrix))}function i(y,w){y.diffuse.value.copy(w.color),y.opacity.value=w.opacity}function s(y,w){y.dashSize.value=w.dashSize,y.totalSize.value=w.dashSize+w.gapSize,y.scale.value=w.scale}function a(y,w,S,L){y.diffuse.value.copy(w.color),y.opacity.value=w.opacity,y.size.value=w.size*S,y.scale.value=L*.5,w.map&&(y.map.value=w.map),w.alphaMap&&(y.alphaMap.value=w.alphaMap),w.alphaTest>0&&(y.alphaTest.value=w.alphaTest);let T;w.map?T=w.map:w.alphaMap&&(T=w.alphaMap),T!==void 0&&(T.matrixAutoUpdate===!0&&T.updateMatrix(),y.uvTransform.value.copy(T.matrix))}function o(y,w){y.diffuse.value.copy(w.color),y.opacity.value=w.opacity,y.rotation.value=w.rotation,w.map&&(y.map.value=w.map),w.alphaMap&&(y.alphaMap.value=w.alphaMap),w.alphaTest>0&&(y.alphaTest.value=w.alphaTest);let S;w.map?S=w.map:w.alphaMap&&(S=w.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}function u(y,w){w.emissiveMap&&(y.emissiveMap.value=w.emissiveMap)}function f(y,w){y.specular.value.copy(w.specular),y.shininess.value=Math.max(w.shininess,1e-4),w.emissiveMap&&(y.emissiveMap.value=w.emissiveMap),w.bumpMap&&(y.bumpMap.value=w.bumpMap,y.bumpScale.value=w.bumpScale,w.side===Jt&&(y.bumpScale.value*=-1)),w.normalMap&&(y.normalMap.value=w.normalMap,y.normalScale.value.copy(w.normalScale),w.side===Jt&&y.normalScale.value.negate()),w.displacementMap&&(y.displacementMap.value=w.displacementMap,y.displacementScale.value=w.displacementScale,y.displacementBias.value=w.displacementBias)}function h(y,w){w.gradientMap&&(y.gradientMap.value=w.gradientMap),w.emissiveMap&&(y.emissiveMap.value=w.emissiveMap),w.bumpMap&&(y.bumpMap.value=w.bumpMap,y.bumpScale.value=w.bumpScale,w.side===Jt&&(y.bumpScale.value*=-1)),w.normalMap&&(y.normalMap.value=w.normalMap,y.normalScale.value.copy(w.normalScale),w.side===Jt&&y.normalScale.value.negate()),w.displacementMap&&(y.displacementMap.value=w.displacementMap,y.displacementScale.value=w.displacementScale,y.displacementBias.value=w.displacementBias)}function c(y,w){y.roughness.value=w.roughness,y.metalness.value=w.metalness,w.roughnessMap&&(y.roughnessMap.value=w.roughnessMap),w.metalnessMap&&(y.metalnessMap.value=w.metalnessMap),w.emissiveMap&&(y.emissiveMap.value=w.emissiveMap),w.bumpMap&&(y.bumpMap.value=w.bumpMap,y.bumpScale.value=w.bumpScale,w.side===Jt&&(y.bumpScale.value*=-1)),w.normalMap&&(y.normalMap.value=w.normalMap,y.normalScale.value.copy(w.normalScale),w.side===Jt&&y.normalScale.value.negate()),w.displacementMap&&(y.displacementMap.value=w.displacementMap,y.displacementScale.value=w.displacementScale,y.displacementBias.value=w.displacementBias),r.get(w).envMap&&(y.envMapIntensity.value=w.envMapIntensity)}function d(y,w,S){c(y,w),y.ior.value=w.ior,w.sheenTint&&y.sheenTint.value.copy(w.sheenTint),w.clearcoat>0&&(y.clearcoat.value=w.clearcoat,y.clearcoatRoughness.value=w.clearcoatRoughness,w.clearcoatMap&&(y.clearcoatMap.value=w.clearcoatMap),w.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=w.clearcoatRoughnessMap),w.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(w.clearcoatNormalScale),y.clearcoatNormalMap.value=w.clearcoatNormalMap,w.side===Jt&&y.clearcoatNormalScale.value.negate())),w.transmission>0&&(y.transmission.value=w.transmission,y.transmissionSamplerMap.value=S.texture,y.transmissionSamplerSize.value.set(S.width,S.height),w.transmissionMap&&(y.transmissionMap.value=w.transmissionMap),y.thickness.value=w.thickness,w.thicknessMap&&(y.thicknessMap.value=w.thicknessMap),y.attenuationDistance.value=w.attenuationDistance,y.attenuationTint.value.copy(w.attenuationTint)),y.specularIntensity.value=w.specularIntensity,y.specularTint.value.copy(w.specularTint),w.specularIntensityMap&&(y.specularIntensityMap.value=w.specularIntensityMap),w.specularTintMap&&(y.specularTintMap.value=w.specularTintMap)}function g(y,w){w.matcap&&(y.matcap.value=w.matcap),w.bumpMap&&(y.bumpMap.value=w.bumpMap,y.bumpScale.value=w.bumpScale,w.side===Jt&&(y.bumpScale.value*=-1)),w.normalMap&&(y.normalMap.value=w.normalMap,y.normalScale.value.copy(w.normalScale),w.side===Jt&&y.normalScale.value.negate()),w.displacementMap&&(y.displacementMap.value=w.displacementMap,y.displacementScale.value=w.displacementScale,y.displacementBias.value=w.displacementBias)}function x(y,w){w.displacementMap&&(y.displacementMap.value=w.displacementMap,y.displacementScale.value=w.displacementScale,y.displacementBias.value=w.displacementBias)}function v(y,w){w.displacementMap&&(y.displacementMap.value=w.displacementMap,y.displacementScale.value=w.displacementScale,y.displacementBias.value=w.displacementBias),y.referencePosition.value.copy(w.referencePosition),y.nearDistance.value=w.nearDistance,y.farDistance.value=w.farDistance}function b(y,w){w.bumpMap&&(y.bumpMap.value=w.bumpMap,y.bumpScale.value=w.bumpScale,w.side===Jt&&(y.bumpScale.value*=-1)),w.normalMap&&(y.normalMap.value=w.normalMap,y.normalScale.value.copy(w.normalScale),w.side===Jt&&y.normalScale.value.negate()),w.displacementMap&&(y.displacementMap.value=w.displacementMap,y.displacementScale.value=w.displacementScale,y.displacementBias.value=w.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:t}}function Ub(){const r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.style.display="block",r}function Et(r={}){const e=r.canvas!==void 0?r.canvas:Ub(),t=r.context!==void 0?r.context:null,n=r.alpha!==void 0?r.alpha:!1,i=r.depth!==void 0?r.depth:!0,s=r.stencil!==void 0?r.stencil:!0,a=r.antialias!==void 0?r.antialias:!1,o=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,u=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,f=r.powerPreference!==void 0?r.powerPreference:"default",h=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let c=null,d=null;const g=[],x=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Nn,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1;const v=this;let b=!1,y=0,w=0,S=null,L=-1,T=null;const m=new Ct,C=new Ct;let N=null,z=e.width,W=e.height,B=1,se=null,$=null;const Q=new Ct(0,0,z,W),K=new Ct(0,0,z,W);let j=!1;const ie=[],de=new Lo;let we=!1,Ne=!1,Se=null;const Ve=new st,ue=new V,Ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Oe(){return S===null?B:1}let re=t;function ze(I,le){for(let ne=0;ne<I.length;ne++){const me=I[ne],De=e.getContext(me,le);if(De!==null)return De}return null}try{const I={alpha:n,depth:i,stencil:s,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:u,powerPreference:f,failIfMajorPerformanceCaveat:h};if(e.addEventListener("webglcontextlost",ct,!1),e.addEventListener("webglcontextrestored",pt,!1),re===null){const le=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&le.shift(),re=ze(le,I),re===null)throw ze(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}re.getShaderPrecisionFormat===void 0&&(re.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(I){throw console.error("THREE.WebGLRenderer: "+I.message),I}let je,Ie,Be,Xe,fe,ge,Ae,ke,pe,O,F,ye,D,X,J,Y,ve,Te,Me,U,ce,oe,Ue;function q(){je=new lw(re),Ie=new ew(re,je,r),je.init(Ie),oe=new Fb(re,je,Ie),Be=new Db(re,je,Ie),ie[0]=1029,Xe=new hw,fe=new bb,ge=new Ib(re,je,Be,fe,Ie,oe,Xe),Ae=new nw(v),ke=new ow(v),pe=new Sy(re,Ie),Ue=new Q_(re,je,pe,Ie),O=new cw(re,pe,Xe,Ue),F=new mw(re,O,pe,Xe),Me=new pw(re),Y=new tw(fe),ye=new wb(v,Ae,ke,je,Ie,Ue,Y),D=new zb(fe),X=new Sb(fe),J=new Rb(je,Ie),Te=new J_(v,Ae,Be,F,o),ve=new fd(v,F,Ie),U=new K_(re,je,Xe,Ie),ce=new uw(re,je,Xe,Ie),Xe.programs=ye.programs,v.capabilities=Ie,v.extensions=je,v.properties=fe,v.renderLists=X,v.shadowMap=ve,v.state=Be,v.info=Xe}q();const Pe=new Ob(v,re);this.xr=Pe,this.getContext=function(){return re},this.getContextAttributes=function(){return re.getContextAttributes()},this.forceContextLoss=function(){const I=je.get("WEBGL_lose_context");I&&I.loseContext()},this.forceContextRestore=function(){const I=je.get("WEBGL_lose_context");I&&I.restoreContext()},this.getPixelRatio=function(){return B},this.setPixelRatio=function(I){I!==void 0&&(B=I,this.setSize(z,W,!1))},this.getSize=function(I){return I.set(z,W)},this.setSize=function(I,le,ne){if(Pe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}z=I,W=le,e.width=Math.floor(I*B),e.height=Math.floor(le*B),ne!==!1&&(e.style.width=I+"px",e.style.height=le+"px"),this.setViewport(0,0,I,le)},this.getDrawingBufferSize=function(I){return I.set(z*B,W*B).floor()},this.setDrawingBufferSize=function(I,le,ne){z=I,W=le,B=ne,e.width=Math.floor(I*ne),e.height=Math.floor(le*ne),this.setViewport(0,0,I,le)},this.getCurrentViewport=function(I){return I.copy(m)},this.getViewport=function(I){return I.copy(Q)},this.setViewport=function(I,le,ne,me){I.isVector4?Q.set(I.x,I.y,I.z,I.w):Q.set(I,le,ne,me),Be.viewport(m.copy(Q).multiplyScalar(B).floor())},this.getScissor=function(I){return I.copy(K)},this.setScissor=function(I,le,ne,me){I.isVector4?K.set(I.x,I.y,I.z,I.w):K.set(I,le,ne,me),Be.scissor(C.copy(K).multiplyScalar(B).floor())},this.getScissorTest=function(){return j},this.setScissorTest=function(I){Be.setScissorTest(j=I)},this.setOpaqueSort=function(I){se=I},this.setTransparentSort=function(I){$=I},this.getClearColor=function(I){return I.copy(Te.getClearColor())},this.setClearColor=function(){Te.setClearColor.apply(Te,arguments)},this.getClearAlpha=function(){return Te.getClearAlpha()},this.setClearAlpha=function(){Te.setClearAlpha.apply(Te,arguments)},this.clear=function(I,le,ne){let me=0;(I===void 0||I)&&(me|=16384),(le===void 0||le)&&(me|=256),(ne===void 0||ne)&&(me|=1024),re.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ct,!1),e.removeEventListener("webglcontextrestored",pt,!1),X.dispose(),J.dispose(),fe.dispose(),Ae.dispose(),ke.dispose(),F.dispose(),Ue.dispose(),Pe.dispose(),Pe.removeEventListener("sessionstart",tr),Pe.removeEventListener("sessionend",$n),Se&&(Se.dispose(),Se=null),fn.stop()};function ct(I){I.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function pt(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const I=Xe.autoReset,le=ve.enabled,ne=ve.autoUpdate,me=ve.needsUpdate,De=ve.type;q(),Xe.autoReset=I,ve.enabled=le,ve.autoUpdate=ne,ve.needsUpdate=me,ve.type=De}function Nt(I){const le=I.target;le.removeEventListener("dispose",Nt),ft(le)}function ft(I){_t(I),fe.remove(I)}function _t(I){const le=fe.get(I).programs;le!==void 0&&le.forEach(function(ne){ye.releaseProgram(ne)})}function en(I,le){I.render(function(ne){v.renderBufferImmediate(ne,le)})}this.renderBufferImmediate=function(I,le){Ue.initAttributes();const ne=fe.get(I);I.hasPositions&&!ne.position&&(ne.position=re.createBuffer()),I.hasNormals&&!ne.normal&&(ne.normal=re.createBuffer()),I.hasUvs&&!ne.uv&&(ne.uv=re.createBuffer()),I.hasColors&&!ne.color&&(ne.color=re.createBuffer());const me=le.getAttributes();I.hasPositions&&(re.bindBuffer(34962,ne.position),re.bufferData(34962,I.positionArray,35048),Ue.enableAttribute(me.position.location),re.vertexAttribPointer(me.position.location,3,5126,!1,0,0)),I.hasNormals&&(re.bindBuffer(34962,ne.normal),re.bufferData(34962,I.normalArray,35048),Ue.enableAttribute(me.normal.location),re.vertexAttribPointer(me.normal.location,3,5126,!1,0,0)),I.hasUvs&&(re.bindBuffer(34962,ne.uv),re.bufferData(34962,I.uvArray,35048),Ue.enableAttribute(me.uv.location),re.vertexAttribPointer(me.uv.location,2,5126,!1,0,0)),I.hasColors&&(re.bindBuffer(34962,ne.color),re.bufferData(34962,I.colorArray,35048),Ue.enableAttribute(me.color.location),re.vertexAttribPointer(me.color.location,3,5126,!1,0,0)),Ue.disableUnusedAttributes(),re.drawArrays(4,0,I.count),I.count=0},this.renderBufferDirect=function(I,le,ne,me,De,ot){le===null&&(le=Ee);const Je=De.isMesh&&De.matrixWorld.determinant()<0,Ge=rr(I,le,me,De);Be.setMaterial(me,Je);let Ye=ne.index;const dt=ne.attributes.position;if(Ye===null){if(dt===void 0||dt.count===0)return}else if(Ye.count===0)return;let mt=1;me.wireframe===!0&&(Ye=O.getWireframeAttribute(ne),mt=2),(ne.morphAttributes.position!==void 0||ne.morphAttributes.normal!==void 0)&&Me.update(De,ne,me,Ge),Ue.setup(De,me,Ge,ne,Ye);let yt,at=U;Ye!==null&&(yt=pe.get(Ye),at=ce,at.setIndex(yt));const xi=Ye!==null?Ye.count:dt.count,Dt=ne.drawRange.start*mt,ui=ne.drawRange.count*mt,Mn=ot!==null?ot.start*mt:0,_i=ot!==null?ot.count*mt:1/0,Qn=Math.max(Dt,Mn),Gt=Math.min(xi,Dt+ui,Mn+_i)-1,Sn=Math.max(0,Gt-Qn+1);if(Sn!==0){if(De.isMesh)me.wireframe===!0?(Be.setLineWidth(me.wireframeLinewidth*Oe()),at.setMode(1)):at.setMode(4);else if(De.isLine){let jt=me.linewidth;jt===void 0&&(jt=1),Be.setLineWidth(jt*Oe()),De.isLineSegments?at.setMode(1):De.isLineLoop?at.setMode(2):at.setMode(3)}else De.isPoints?at.setMode(0):De.isSprite&&at.setMode(4);if(De.isInstancedMesh)at.renderInstances(Qn,Sn,De.count);else if(ne.isInstancedBufferGeometry){const jt=Math.min(ne.instanceCount,ne._maxInstanceCount);at.renderInstances(Qn,Sn,jt)}else at.render(Qn,Sn)}},this.compile=function(I,le){d=J.get(I),d.init(),x.push(d),I.traverseVisible(function(ne){ne.isLight&&ne.layers.test(le.layers)&&(d.pushLight(ne),ne.castShadow&&d.pushShadow(ne))}),d.setupLights(v.physicallyCorrectLights),I.traverse(function(ne){const me=ne.material;if(me)if(Array.isArray(me))for(let De=0;De<me.length;De++){const ot=me[De];ir(ot,I,ne)}else ir(me,I,ne)}),x.pop(),d=null};let rn=null;function hn(I){rn&&rn(I)}function tr(){fn.stop()}function $n(){fn.start()}const fn=new Qf;fn.setAnimationLoop(hn),typeof window!="undefined"&&fn.setContext(window),this.setAnimationLoop=function(I){rn=I,Pe.setAnimationLoop(I),I===null?fn.stop():fn.start()},Pe.addEventListener("sessionstart",tr),Pe.addEventListener("sessionend",$n),this.render=function(I,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;I.autoUpdate===!0&&I.updateMatrixWorld(),le.parent===null&&le.updateMatrixWorld(),Pe.enabled===!0&&Pe.isPresenting===!0&&(Pe.cameraAutoUpdate===!0&&Pe.updateCamera(le),le=Pe.getCamera()),I.isScene===!0&&I.onBeforeRender(v,I,le,S),d=J.get(I,x.length),d.init(),x.push(d),Ve.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),de.setFromProjectionMatrix(Ve),Ne=this.localClippingEnabled,we=Y.init(this.clippingPlanes,Ne,le),c=X.get(I,g.length),c.init(),g.push(c),Wn(I,le,0,v.sortObjects),c.finish(),v.sortObjects===!0&&c.sort(se,$),we===!0&&Y.beginShadows();const ne=d.state.shadowsArray;if(ve.render(ne,I,le),we===!0&&Y.endShadows(),this.info.autoReset===!0&&this.info.reset(),Te.render(c,I),d.setupLights(v.physicallyCorrectLights),le.isArrayCamera){const me=le.cameras;for(let De=0,ot=me.length;De<ot;De++){const Je=me[De];wr(c,I,Je,Je.viewport)}}else wr(c,I,le);S!==null&&(ge.updateMultisampleRenderTarget(S),ge.updateRenderTargetMipmap(S)),I.isScene===!0&&I.onAfterRender(v,I,le),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),Be.setPolygonOffset(!1),Ue.resetDefaultState(),L=-1,T=null,x.pop(),x.length>0?d=x[x.length-1]:d=null,g.pop(),g.length>0?c=g[g.length-1]:c=null};function Wn(I,le,ne,me){if(I.visible===!1)return;if(I.layers.test(le.layers)){if(I.isGroup)ne=I.renderOrder;else if(I.isLOD)I.autoUpdate===!0&&I.update(le);else if(I.isLight)d.pushLight(I),I.castShadow&&d.pushShadow(I);else if(I.isSprite){if(!I.frustumCulled||de.intersectsSprite(I)){me&&ue.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Ve);const Je=F.update(I),Ge=I.material;Ge.visible&&c.push(I,Je,Ge,ne,ue.z,null)}}else if(I.isImmediateRenderObject)me&&ue.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Ve),c.push(I,null,I.material,ne,ue.z,null);else if((I.isMesh||I.isLine||I.isPoints)&&(I.isSkinnedMesh&&I.skeleton.frame!==Xe.render.frame&&(I.skeleton.update(),I.skeleton.frame=Xe.render.frame),!I.frustumCulled||de.intersectsObject(I))){me&&ue.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Ve);const Je=F.update(I),Ge=I.material;if(Array.isArray(Ge)){const Ye=Je.groups;for(let dt=0,mt=Ye.length;dt<mt;dt++){const yt=Ye[dt],at=Ge[yt.materialIndex];at&&at.visible&&c.push(I,Je,at,ne,ue.z,yt)}}else Ge.visible&&c.push(I,Je,Ge,ne,ue.z,null)}}const ot=I.children;for(let Je=0,Ge=ot.length;Je<Ge;Je++)Wn(ot[Je],le,ne,me)}function wr(I,le,ne,me){const De=I.opaque,ot=I.transmissive,Je=I.transparent;d.setupLightsView(ne),ot.length>0&&nr(De,le,ne),me&&Be.viewport(m.copy(me)),De.length>0&&Jn(De,le,ne),ot.length>0&&Jn(ot,le,ne),Je.length>0&&Jn(Je,le,ne)}function nr(I,le,ne){if(Se===null){const Je=a===!0&&Ie.isWebGL2===!0?jf:mi;Se=new Je(1024,1024,{generateMipmaps:!0,type:oe.convert(es)!==null?es:as,minFilter:Eo,magFilter:nn,wrapS:Vn,wrapT:Vn})}const me=v.getRenderTarget();v.setRenderTarget(Se),v.clear();const De=v.toneMapping;v.toneMapping=vr,Jn(I,le,ne),v.toneMapping=De,ge.updateMultisampleRenderTarget(Se),ge.updateRenderTargetMipmap(Se),v.setRenderTarget(me)}function Jn(I,le,ne){const me=le.isScene===!0?le.overrideMaterial:null;for(let De=0,ot=I.length;De<ot;De++){const Je=I[De],Ge=Je.object,Ye=Je.geometry,dt=me===null?Je.material:me,mt=Je.group;Ge.layers.test(ne.layers)&&_s(Ge,le,ne,Ye,dt,mt)}}function _s(I,le,ne,me,De,ot){if(I.onBeforeRender(v,le,ne,me,De,ot),I.modelViewMatrix.multiplyMatrices(ne.matrixWorldInverse,I.matrixWorld),I.normalMatrix.getNormalMatrix(I.modelViewMatrix),I.isImmediateRenderObject){const Je=rr(ne,le,De,I);Be.setMaterial(De),Ue.reset(),en(I,Je)}else De.transparent===!0&&De.side===ss?(De.side=Jt,De.needsUpdate=!0,v.renderBufferDirect(ne,le,me,De,I,ot),De.side=$s,De.needsUpdate=!0,v.renderBufferDirect(ne,le,me,De,I,ot),De.side=ss):v.renderBufferDirect(ne,le,me,De,I,ot);I.onAfterRender(v,le,ne,me,De,ot)}function ir(I,le,ne){le.isScene!==!0&&(le=Ee);const me=fe.get(I),De=d.state.lights,ot=d.state.shadowsArray,Je=De.state.version,Ge=ye.getParameters(I,De.state,ot,le,ne),Ye=ye.getProgramCacheKey(Ge);let dt=me.programs;me.environment=I.isMeshStandardMaterial?le.environment:null,me.fog=le.fog,me.envMap=(I.isMeshStandardMaterial?ke:Ae).get(I.envMap||me.environment),dt===void 0&&(I.addEventListener("dispose",Nt),dt=new Map,me.programs=dt);let mt=dt.get(Ye);if(mt!==void 0){if(me.currentProgram===mt&&me.lightsStateVersion===Je)return br(I,Ge),mt}else Ge.uniforms=ye.getUniforms(I),I.onBuild(Ge,v),I.onBeforeCompile(Ge,v),mt=ye.acquireProgram(Ge,Ye),dt.set(Ye,mt),me.uniforms=Ge.uniforms;const yt=me.uniforms;(!I.isShaderMaterial&&!I.isRawShaderMaterial||I.clipping===!0)&&(yt.clippingPlanes=Y.uniform),br(I,Ge),me.needsLights=bs(I),me.lightsStateVersion=Je,me.needsLights&&(yt.ambientLightColor.value=De.state.ambient,yt.lightProbe.value=De.state.probe,yt.directionalLights.value=De.state.directional,yt.directionalLightShadows.value=De.state.directionalShadow,yt.spotLights.value=De.state.spot,yt.spotLightShadows.value=De.state.spotShadow,yt.rectAreaLights.value=De.state.rectArea,yt.ltc_1.value=De.state.rectAreaLTC1,yt.ltc_2.value=De.state.rectAreaLTC2,yt.pointLights.value=De.state.point,yt.pointLightShadows.value=De.state.pointShadow,yt.hemisphereLights.value=De.state.hemi,yt.directionalShadowMap.value=De.state.directionalShadowMap,yt.directionalShadowMatrix.value=De.state.directionalShadowMatrix,yt.spotShadowMap.value=De.state.spotShadowMap,yt.spotShadowMatrix.value=De.state.spotShadowMatrix,yt.pointShadowMap.value=De.state.pointShadowMap,yt.pointShadowMatrix.value=De.state.pointShadowMatrix);const at=mt.getUniforms(),xi=Xi.seqWithValue(at.seq,yt);return me.currentProgram=mt,me.uniformsList=xi,mt}function br(I,le){const ne=fe.get(I);ne.outputEncoding=le.outputEncoding,ne.instancing=le.instancing,ne.skinning=le.skinning,ne.morphTargets=le.morphTargets,ne.morphNormals=le.morphNormals,ne.numClippingPlanes=le.numClippingPlanes,ne.numIntersection=le.numClipIntersection,ne.vertexAlphas=le.vertexAlphas,ne.vertexTangents=le.vertexTangents}function rr(I,le,ne,me){le.isScene!==!0&&(le=Ee),ge.resetTextureUnits();const De=le.fog,ot=ne.isMeshStandardMaterial?le.environment:null,Je=S===null?v.outputEncoding:S.texture.encoding,Ge=(ne.isMeshStandardMaterial?ke:Ae).get(ne.envMap||ot),Ye=ne.vertexColors===!0&&!!me.geometry&&!!me.geometry.attributes.color&&me.geometry.attributes.color.itemSize===4,dt=!!me.geometry&&!!me.geometry.attributes.tangent,mt=!!me.geometry&&!!me.geometry.morphAttributes.position,yt=!!me.geometry&&!!me.geometry.morphAttributes.normal,at=fe.get(ne),xi=d.state.lights;if(we===!0&&(Ne===!0||I!==T)){const jt=I===T&&ne.id===L;Y.setState(ne,I,jt)}let Dt=!1;ne.version===at.__version?(at.needsLights&&at.lightsStateVersion!==xi.state.version||at.outputEncoding!==Je||me.isInstancedMesh&&at.instancing===!1||!me.isInstancedMesh&&at.instancing===!0||me.isSkinnedMesh&&at.skinning===!1||!me.isSkinnedMesh&&at.skinning===!0||at.envMap!==Ge||ne.fog&&at.fog!==De||at.numClippingPlanes!==void 0&&(at.numClippingPlanes!==Y.numPlanes||at.numIntersection!==Y.numIntersection)||at.vertexAlphas!==Ye||at.vertexTangents!==dt||at.morphTargets!==mt||at.morphNormals!==yt)&&(Dt=!0):(Dt=!0,at.__version=ne.version);let ui=at.currentProgram;Dt===!0&&(ui=ir(ne,le,me));let Mn=!1,_i=!1,Qn=!1;const Gt=ui.getUniforms(),Sn=at.uniforms;if(Be.useProgram(ui.program)&&(Mn=!0,_i=!0,Qn=!0),ne.id!==L&&(L=ne.id,_i=!0),Mn||T!==I){if(Gt.setValue(re,"projectionMatrix",I.projectionMatrix),Ie.logarithmicDepthBuffer&&Gt.setValue(re,"logDepthBufFC",2/(Math.log(I.far+1)/Math.LN2)),T!==I&&(T=I,_i=!0,Qn=!0),ne.isShaderMaterial||ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshStandardMaterial||ne.envMap){const jt=Gt.map.cameraPosition;jt!==void 0&&jt.setValue(re,ue.setFromMatrixPosition(I.matrixWorld))}(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial)&&Gt.setValue(re,"isOrthographic",I.isOrthographicCamera===!0),(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial||ne.isShadowMaterial||me.isSkinnedMesh)&&Gt.setValue(re,"viewMatrix",I.matrixWorldInverse)}if(me.isSkinnedMesh){Gt.setOptional(re,me,"bindMatrix"),Gt.setOptional(re,me,"bindMatrixInverse");const jt=me.skeleton;jt&&(Ie.floatVertexTextures?(jt.boneTexture===null&&jt.computeBoneTexture(),Gt.setValue(re,"boneTexture",jt.boneTexture,ge),Gt.setValue(re,"boneTextureSize",jt.boneTextureSize)):Gt.setOptional(re,jt,"boneMatrices"))}return(_i||at.receiveShadow!==me.receiveShadow)&&(at.receiveShadow=me.receiveShadow,Gt.setValue(re,"receiveShadow",me.receiveShadow)),_i&&(Gt.setValue(re,"toneMappingExposure",v.toneMappingExposure),at.needsLights&&ws(Sn,Qn),De&&ne.fog&&D.refreshFogUniforms(Sn,De),D.refreshMaterialUniforms(Sn,ne,B,W,Se),Xi.upload(re,at.uniformsList,Sn,ge)),ne.isShaderMaterial&&ne.uniformsNeedUpdate===!0&&(Xi.upload(re,at.uniformsList,Sn,ge),ne.uniformsNeedUpdate=!1),ne.isSpriteMaterial&&Gt.setValue(re,"center",me.center),Gt.setValue(re,"modelViewMatrix",me.modelViewMatrix),Gt.setValue(re,"normalMatrix",me.normalMatrix),Gt.setValue(re,"modelMatrix",me.matrixWorld),ui}function ws(I,le){I.ambientLightColor.needsUpdate=le,I.lightProbe.needsUpdate=le,I.directionalLights.needsUpdate=le,I.directionalLightShadows.needsUpdate=le,I.pointLights.needsUpdate=le,I.pointLightShadows.needsUpdate=le,I.spotLights.needsUpdate=le,I.spotLightShadows.needsUpdate=le,I.rectAreaLights.needsUpdate=le,I.hemisphereLights.needsUpdate=le}function bs(I){return I.isMeshLambertMaterial||I.isMeshToonMaterial||I.isMeshPhongMaterial||I.isMeshStandardMaterial||I.isShadowMaterial||I.isShaderMaterial&&I.lights===!0}this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return S},this.setRenderTarget=function(I,le=0,ne=0){S=I,y=le,w=ne,I&&fe.get(I).__webglFramebuffer===void 0&&ge.setupRenderTarget(I);let me=null,De=!1,ot=!1;if(I){const Ge=I.texture;(Ge.isDataTexture3D||Ge.isDataTexture2DArray)&&(ot=!0);const Ye=fe.get(I).__webglFramebuffer;I.isWebGLCubeRenderTarget?(me=Ye[le],De=!0):I.isWebGLMultisampleRenderTarget?me=fe.get(I).__webglMultisampledFramebuffer:me=Ye,m.copy(I.viewport),C.copy(I.scissor),N=I.scissorTest}else m.copy(Q).multiplyScalar(B).floor(),C.copy(K).multiplyScalar(B).floor(),N=j;if(Be.bindFramebuffer(36160,me)&&Ie.drawBuffers){let Ge=!1;if(I)if(I.isWebGLMultipleRenderTargets){const Ye=I.texture;if(ie.length!==Ye.length||ie[0]!==36064){for(let dt=0,mt=Ye.length;dt<mt;dt++)ie[dt]=36064+dt;ie.length=Ye.length,Ge=!0}}else(ie.length!==1||ie[0]!==36064)&&(ie[0]=36064,ie.length=1,Ge=!0);else(ie.length!==1||ie[0]!==1029)&&(ie[0]=1029,ie.length=1,Ge=!0);Ge&&(Ie.isWebGL2?re.drawBuffers(ie):je.get("WEBGL_draw_buffers").drawBuffersWEBGL(ie))}if(Be.viewport(m),Be.scissor(C),Be.setScissorTest(N),De){const Ge=fe.get(I.texture);re.framebufferTexture2D(36160,36064,34069+le,Ge.__webglTexture,ne)}else if(ot){const Ge=fe.get(I.texture),Ye=le||0;re.framebufferTextureLayer(36160,36064,Ge.__webglTexture,ne||0,Ye)}L=-1},this.readRenderTargetPixels=function(I,le,ne,me,De,ot,Je){if(!(I&&I.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ge=fe.get(I).__webglFramebuffer;if(I.isWebGLCubeRenderTarget&&Je!==void 0&&(Ge=Ge[Je]),Ge){Be.bindFramebuffer(36160,Ge);try{const Ye=I.texture,dt=Ye.format,mt=Ye.type;if(dt!==Gn&&oe.convert(dt)!==re.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const yt=mt===es&&(je.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&je.has("EXT_color_buffer_float"));if(mt!==as&&oe.convert(mt)!==re.getParameter(35738)&&!(mt===mr&&(Ie.isWebGL2||je.has("OES_texture_float")||je.has("WEBGL_color_buffer_float")))&&!yt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}re.checkFramebufferStatus(36160)===36053?le>=0&&le<=I.width-me&&ne>=0&&ne<=I.height-De&&re.readPixels(le,ne,me,De,oe.convert(dt),oe.convert(mt),ot):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ye=S!==null?fe.get(S).__webglFramebuffer:null;Be.bindFramebuffer(36160,Ye)}}},this.copyFramebufferToTexture=function(I,le,ne=0){const me=Math.pow(2,-ne),De=Math.floor(le.image.width*me),ot=Math.floor(le.image.height*me);let Je=oe.convert(le.format);Ie.isWebGL2&&(Je===6407&&(Je=32849),Je===6408&&(Je=32856)),ge.setTexture2D(le,0),re.copyTexImage2D(3553,ne,Je,I.x,I.y,De,ot,0),Be.unbindTexture()},this.copyTextureToTexture=function(I,le,ne,me=0){const De=le.image.width,ot=le.image.height,Je=oe.convert(ne.format),Ge=oe.convert(ne.type);ge.setTexture2D(ne,0),re.pixelStorei(37440,ne.flipY),re.pixelStorei(37441,ne.premultiplyAlpha),re.pixelStorei(3317,ne.unpackAlignment),le.isDataTexture?re.texSubImage2D(3553,me,I.x,I.y,De,ot,Je,Ge,le.image.data):le.isCompressedTexture?re.compressedTexSubImage2D(3553,me,I.x,I.y,le.mipmaps[0].width,le.mipmaps[0].height,Je,le.mipmaps[0].data):re.texSubImage2D(3553,me,I.x,I.y,Je,Ge,le.image),me===0&&ne.generateMipmaps&&re.generateMipmap(3553),Be.unbindTexture()},this.copyTextureToTexture3D=function(I,le,ne,me,De=0){if(v.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ot=I.max.x-I.min.x+1,Je=I.max.y-I.min.y+1,Ge=I.max.z-I.min.z+1,Ye=oe.convert(me.format),dt=oe.convert(me.type);let mt;if(me.isDataTexture3D)ge.setTexture3D(me,0),mt=32879;else if(me.isDataTexture2DArray)ge.setTexture2DArray(me,0),mt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}re.pixelStorei(37440,me.flipY),re.pixelStorei(37441,me.premultiplyAlpha),re.pixelStorei(3317,me.unpackAlignment);const yt=re.getParameter(3314),at=re.getParameter(32878),xi=re.getParameter(3316),Dt=re.getParameter(3315),ui=re.getParameter(32877),Mn=ne.isCompressedTexture?ne.mipmaps[0]:ne.image;re.pixelStorei(3314,Mn.width),re.pixelStorei(32878,Mn.height),re.pixelStorei(3316,I.min.x),re.pixelStorei(3315,I.min.y),re.pixelStorei(32877,I.min.z),ne.isDataTexture||ne.isDataTexture3D?re.texSubImage3D(mt,De,le.x,le.y,le.z,ot,Je,Ge,Ye,dt,Mn.data):ne.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),re.compressedTexSubImage3D(mt,De,le.x,le.y,le.z,ot,Je,Ge,Ye,Mn.data)):re.texSubImage3D(mt,De,le.x,le.y,le.z,ot,Je,Ge,Ye,dt,Mn),re.pixelStorei(3314,yt),re.pixelStorei(32878,at),re.pixelStorei(3316,xi),re.pixelStorei(3315,Dt),re.pixelStorei(32877,ui),De===0&&me.generateMipmaps&&re.generateMipmap(mt),Be.unbindTexture()},this.initTexture=function(I){ge.setTexture2D(I,0),Be.unbindTexture()},this.resetState=function(){y=0,w=0,S=null,Be.reset(),Ue.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class kb extends Et{}kb.prototype.isWebGL1Renderer=!0;class Ac extends bt{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}Ac.prototype.isScene=!0;class sa{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Qs,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=pi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=pi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=pi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}sa.prototype.isInterleavedBuffer=!0;const Wt=new V;class Ks{constructor(e,t,n,i=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Wt.x=this.getX(t),Wt.y=this.getY(t),Wt.z=this.getZ(t),Wt.applyMatrix4(e),this.setXYZ(t,Wt.x,Wt.y,Wt.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Wt.x=this.getX(t),Wt.y=this.getY(t),Wt.z=this.getZ(t),Wt.applyNormalMatrix(e),this.setXYZ(t,Wt.x,Wt.y,Wt.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Wt.x=this.getX(t),Wt.y=this.getY(t),Wt.z=this.getZ(t),Wt.transformDirection(e),this.setXYZ(t,Wt.x,Wt.y,Wt.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new Kt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ks(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ks.prototype.isInterleavedBufferAttribute=!0;class pd extends yn{constructor(e){super(),this.type="SpriteMaterial",this.color=new Ke(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}pd.prototype.isSpriteMaterial=!0;let Gr;const Fs=new V,Wr=new V,qr=new V,jr=new Fe,Bs=new Fe,md=new st,Ba=new V,Os=new V,Oa=new V,wh=new Fe,Dl=new Fe,bh=new Fe;class Hb extends bt{constructor(e){if(super(),this.type="Sprite",Gr===void 0){Gr=new Rt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new sa(t,5);Gr.setIndex([0,1,2,0,2,3]),Gr.setAttribute("position",new Ks(n,3,0,!1)),Gr.setAttribute("uv",new Ks(n,2,3,!1))}this.geometry=Gr,this.material=e!==void 0?e:new pd,this.center=new Fe(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Wr.setFromMatrixScale(this.matrixWorld),md.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),qr.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Wr.multiplyScalar(-qr.z);const n=this.material.rotation;let i,s;n!==0&&(s=Math.cos(n),i=Math.sin(n));const a=this.center;za(Ba.set(-.5,-.5,0),qr,a,Wr,i,s),za(Os.set(.5,-.5,0),qr,a,Wr,i,s),za(Oa.set(.5,.5,0),qr,a,Wr,i,s),wh.set(0,0),Dl.set(1,0),bh.set(1,1);let o=e.ray.intersectTriangle(Ba,Os,Oa,!1,Fs);if(o===null&&(za(Os.set(-.5,.5,0),qr,a,Wr,i,s),Dl.set(0,1),o=e.ray.intersectTriangle(Ba,Oa,Os,!1,Fs),o===null))return;const u=e.ray.origin.distanceTo(Fs);u<e.near||u>e.far||t.push({distance:u,point:Fs.clone(),uv:Yt.getUV(Fs,Ba,Os,Oa,wh,Dl,bh,new Fe),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}Hb.prototype.isSprite=!0;function za(r,e,t,n,i,s){jr.subVectors(r,t).addScalar(.5).multiply(n),i!==void 0?(Bs.x=s*jr.x-i*jr.y,Bs.y=i*jr.x+s*jr.y):Bs.copy(jr),r.copy(e),r.x+=Bs.x,r.y+=Bs.y,r.applyMatrix4(md)}const Mh=new V,Sh=new Ct,Eh=new Ct,Vb=new V,Th=new st;class gd extends wn{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new st,this.bindMatrixInverse=new st}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ct,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;Sh.fromBufferAttribute(i.attributes.skinIndex,e),Eh.fromBufferAttribute(i.attributes.skinWeight,e),Mh.fromBufferAttribute(i.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=Eh.getComponent(s);if(a!==0){const o=Sh.getComponent(s);Th.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Vb.copy(Mh).applyMatrix4(Th),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}gd.prototype.isSkinnedMesh=!0;class Gb extends bt{constructor(){super(),this.type="Bone"}}Gb.prototype.isBone=!0;class Wb extends un{constructor(e=null,t=1,n=1,i,s,a,o,u,f=nn,h=nn,c,d){super(null,a,o,u,f,h,i,s,c,d),this.image={data:e,width:t,height:n},this.magFilter=f,this.minFilter=h,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Wb.prototype.isDataTexture=!0;class rc extends Kt{constructor(e,t,n,i=1){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}rc.prototype.isInstancedBufferAttribute=!0;const Ah=new st,Ch=new st,Ua=[],zs=new wn;class qb extends wn{constructor(e,t,n){super(e,t),this.instanceMatrix=new rc(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(zs.geometry=this.geometry,zs.material=this.material,zs.material!==void 0)for(let s=0;s<i;s++){this.getMatrixAt(s,Ah),Ch.multiplyMatrices(n,Ah),zs.matrixWorld=Ch,zs.raycast(e,Ua);for(let a=0,o=Ua.length;a<o;a++){const u=Ua[a];u.instanceId=s,u.object=this,t.push(u)}Ua.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new rc(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}qb.prototype.isInstancedMesh=!0;class gs extends yn{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Ke(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}gs.prototype.isLineBasicMaterial=!0;const Lh=new V,Rh=new V,Ph=new st,Il=new ds,ka=new fs;class Po extends bt{constructor(e=new Rt,t=new gs){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,s=t.count;i<s;i++)Lh.fromBufferAttribute(t,i-1),Rh.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Lh.distanceTo(Rh);e.setAttribute("lineDistance",new qt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ka.copy(n.boundingSphere),ka.applyMatrix4(i),ka.radius+=s,e.ray.intersectsSphere(ka)===!1)return;Ph.copy(i).invert(),Il.copy(e.ray).applyMatrix4(Ph);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=o*o,f=new V,h=new V,c=new V,d=new V,g=this.isLineSegments?2:1;if(n.isBufferGeometry){const x=n.index,b=n.attributes.position;if(x!==null){const y=Math.max(0,a.start),w=Math.min(x.count,a.start+a.count);for(let S=y,L=w-1;S<L;S+=g){const T=x.getX(S),m=x.getX(S+1);if(f.fromBufferAttribute(b,T),h.fromBufferAttribute(b,m),Il.distanceSqToSegment(f,h,d,c)>u)continue;d.applyMatrix4(this.matrixWorld);const N=e.ray.origin.distanceTo(d);N<e.near||N>e.far||t.push({distance:N,point:c.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,a.start),w=Math.min(b.count,a.start+a.count);for(let S=y,L=w-1;S<L;S+=g){if(f.fromBufferAttribute(b,S),h.fromBufferAttribute(b,S+1),Il.distanceSqToSegment(f,h,d,c)>u)continue;d.applyMatrix4(this.matrixWorld);const m=e.ray.origin.distanceTo(d);m<e.near||m>e.far||t.push({distance:m,point:c.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Po.prototype.isLine=!0;const Nh=new V,Dh=new V;class Cc extends Po{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,s=t.count;i<s;i+=2)Nh.fromBufferAttribute(t,i),Dh.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Nh.distanceTo(Dh);e.setAttribute("lineDistance",new qt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Cc.prototype.isLineSegments=!0;class jb extends Po{constructor(e,t){super(e,t),this.type="LineLoop"}}jb.prototype.isLineLoop=!0;class vd extends yn{constructor(e){super(),this.type="PointsMaterial",this.color=new Ke(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}vd.prototype.isPointsMaterial=!0;const Ih=new st,sc=new ds,Ha=new fs,Va=new V;class Xb extends bt{constructor(e=new Rt,t=new vd){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ha.copy(n.boundingSphere),Ha.applyMatrix4(i),Ha.radius+=s,e.ray.intersectsSphere(Ha)===!1)return;Ih.copy(i).invert(),sc.copy(e.ray).applyMatrix4(Ih);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=o*o;if(n.isBufferGeometry){const f=n.index,c=n.attributes.position;if(f!==null){const d=Math.max(0,a.start),g=Math.min(f.count,a.start+a.count);for(let x=d,v=g;x<v;x++){const b=f.getX(x);Va.fromBufferAttribute(c,b),Fh(Va,b,u,i,e,t,this)}}else{const d=Math.max(0,a.start),g=Math.min(c.count,a.start+a.count);for(let x=d,v=g;x<v;x++)Va.fromBufferAttribute(c,x),Fh(Va,x,u,i,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}else{const t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Xb.prototype.isPoints=!0;function Fh(r,e,t,n,i,s,a){const o=sc.distanceSqToPoint(r);if(o<t){const u=new V;sc.closestPointToPoint(r,u),u.applyMatrix4(n);const f=i.ray.origin.distanceTo(u);if(f<i.near||f>i.far)return;s.push({distance:f,distanceToRay:Math.sqrt(o),point:u,index:e,face:null,object:a})}}class Yb extends un{constructor(e,t,n,i,s,a,o,u,f){super(e,t,n,i,s,a,o,u,f),this.format=o!==void 0?o:qi,this.minFilter=a!==void 0?a:Yn,this.magFilter=s!==void 0?s:Yn,this.generateMipmaps=!1;const h=this;function c(){h.needsUpdate=!0,e.requestVideoFrameCallback(c)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(c)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Yb.prototype.isVideoTexture=!0;class Zb extends un{constructor(e,t,n,i,s,a,o,u,f,h,c,d){super(null,a,o,u,f,h,i,s,c,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Zb.prototype.isCompressedTexture=!0;class $b extends un{constructor(e,t,n,i,s,a,o,u,f){super(e,t,n,i,s,a,o,u,f),this.needsUpdate=!0}}$b.prototype.isCanvasTexture=!0;class Jb extends un{constructor(e,t,n,i,s,a,o,u,f,h){if(h=h!==void 0?h:ts,h!==ts&&h!==Js)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&h===ts&&(n=ro),n===void 0&&h===Js&&(n=Ws),super(null,i,s,a,o,u,h,n,f),this.image={width:e,height:t},this.magFilter=o!==void 0?o:nn,this.minFilter=u!==void 0?u:nn,this.flipY=!1,this.generateMipmaps=!1}}Jb.prototype.isDepthTexture=!0;new V;new V;new V;new Yt;class Zn{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(i),t.push(s),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const s=n.length;let a;t?a=t:a=e*n[s-1];let o=0,u=s-1,f;for(;o<=u;)if(i=Math.floor(o+(u-o)/2),f=n[i]-a,f<0)o=i+1;else if(f>0)u=i-1;else{u=i;break}if(i=u,n[i]===a)return i/(s-1);const h=n[i],d=n[i+1]-h,g=(a-h)/d;return(i+g)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),o=this.getPoint(s),u=t||(a.isVector2?new Fe:new V);return u.copy(o).sub(a).normalize(),u}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new V,i=[],s=[],a=[],o=new V,u=new st;for(let g=0;g<=e;g++){const x=g/e;i[g]=this.getTangentAt(x,new V),i[g].normalize()}s[0]=new V,a[0]=new V;let f=Number.MAX_VALUE;const h=Math.abs(i[0].x),c=Math.abs(i[0].y),d=Math.abs(i[0].z);h<=f&&(f=h,n.set(1,0,0)),c<=f&&(f=c,n.set(0,1,0)),d<=f&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],o),a[0].crossVectors(i[0],s[0]);for(let g=1;g<=e;g++){if(s[g]=s[g-1].clone(),a[g]=a[g-1].clone(),o.crossVectors(i[g-1],i[g]),o.length()>Number.EPSILON){o.normalize();const x=Math.acos(Rn(i[g-1].dot(i[g]),-1,1));s[g].applyMatrix4(u.makeRotationAxis(o,x))}a[g].crossVectors(i[g],s[g])}if(t===!0){let g=Math.acos(Rn(s[0].dot(s[e]),-1,1));g/=e,i[0].dot(o.crossVectors(s[0],s[e]))>0&&(g=-g);for(let x=1;x<=e;x++)s[x].applyMatrix4(u.makeRotationAxis(i[x],g*x)),a[x].crossVectors(i[x],s[x])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class No extends Zn{constructor(e=0,t=0,n=1,i=1,s=0,a=Math.PI*2,o=!1,u=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=u}getPoint(e,t){const n=t||new Fe,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const o=this.aStartAngle+e*s;let u=this.aX+this.xRadius*Math.cos(o),f=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const h=Math.cos(this.aRotation),c=Math.sin(this.aRotation),d=u-this.aX,g=f-this.aY;u=d*h-g*c+this.aX,f=d*c+g*h+this.aY}return n.set(u,f)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}No.prototype.isEllipseCurve=!0;class yd extends No{constructor(e,t,n,i,s,a){super(e,t,n,n,i,s,a),this.type="ArcCurve"}}yd.prototype.isArcCurve=!0;function Lc(){let r=0,e=0,t=0,n=0;function i(s,a,o,u){r=s,e=o,t=-3*s+3*a-2*o-u,n=2*s-2*a+o+u}return{initCatmullRom:function(s,a,o,u,f){i(a,o,f*(o-s),f*(u-a))},initNonuniformCatmullRom:function(s,a,o,u,f,h,c){let d=(a-s)/f-(o-s)/(f+h)+(o-a)/h,g=(o-a)/h-(u-a)/(h+c)+(u-o)/c;d*=h,g*=h,i(a,o,d,g)},calc:function(s){const a=s*s,o=a*s;return r+e*s+t*a+n*o}}}const Ga=new V,Fl=new Lc,Bl=new Lc,Ol=new Lc;class xd extends Zn{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new V){const n=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),u=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:u===0&&o===s-1&&(o=s-2,u=1);let f,h;this.closed||o>0?f=i[(o-1)%s]:(Ga.subVectors(i[0],i[1]).add(i[0]),f=Ga);const c=i[o%s],d=i[(o+1)%s];if(this.closed||o+2<s?h=i[(o+2)%s]:(Ga.subVectors(i[s-1],i[s-2]).add(i[s-1]),h=Ga),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let x=Math.pow(f.distanceToSquared(c),g),v=Math.pow(c.distanceToSquared(d),g),b=Math.pow(d.distanceToSquared(h),g);v<1e-4&&(v=1),x<1e-4&&(x=v),b<1e-4&&(b=v),Fl.initNonuniformCatmullRom(f.x,c.x,d.x,h.x,x,v,b),Bl.initNonuniformCatmullRom(f.y,c.y,d.y,h.y,x,v,b),Ol.initNonuniformCatmullRom(f.z,c.z,d.z,h.z,x,v,b)}else this.curveType==="catmullrom"&&(Fl.initCatmullRom(f.x,c.x,d.x,h.x,this.tension),Bl.initCatmullRom(f.y,c.y,d.y,h.y,this.tension),Ol.initCatmullRom(f.z,c.z,d.z,h.z,this.tension));return n.set(Fl.calc(u),Bl.calc(u),Ol.calc(u)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new V().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}xd.prototype.isCatmullRomCurve3=!0;function Bh(r,e,t,n,i){const s=(n-e)*.5,a=(i-t)*.5,o=r*r,u=r*o;return(2*t-2*n+s+a)*u+(-3*t+3*n-2*s-a)*o+s*r+t}function Qb(r,e){const t=1-r;return t*t*e}function Kb(r,e){return 2*(1-r)*r*e}function eM(r,e){return r*r*e}function qs(r,e,t,n){return Qb(r,e)+Kb(r,t)+eM(r,n)}function tM(r,e){const t=1-r;return t*t*t*e}function nM(r,e){const t=1-r;return 3*t*t*r*e}function iM(r,e){return 3*(1-r)*r*r*e}function rM(r,e){return r*r*r*e}function js(r,e,t,n,i){return tM(r,e)+nM(r,t)+iM(r,n)+rM(r,i)}class Rc extends Zn{constructor(e=new Fe,t=new Fe,n=new Fe,i=new Fe){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Fe){const n=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(js(e,i.x,s.x,a.x,o.x),js(e,i.y,s.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Rc.prototype.isCubicBezierCurve=!0;class _d extends Zn{constructor(e=new V,t=new V,n=new V,i=new V){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new V){const n=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(js(e,i.x,s.x,a.x,o.x),js(e,i.y,s.y,a.y,o.y),js(e,i.z,s.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}_d.prototype.isCubicBezierCurve3=!0;class Do extends Zn{constructor(e=new Fe,t=new Fe){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Fe){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new Fe;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Do.prototype.isLineCurve=!0;class sM extends Zn{constructor(e=new V,t=new V){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new V){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Pc extends Zn{constructor(e=new Fe,t=new Fe,n=new Fe){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Fe){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(qs(e,i.x,s.x,a.x),qs(e,i.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Pc.prototype.isQuadraticBezierCurve=!0;class wd extends Zn{constructor(e=new V,t=new V,n=new V){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new V){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(qs(e,i.x,s.x,a.x),qs(e,i.y,s.y,a.y),qs(e,i.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}wd.prototype.isQuadraticBezierCurve3=!0;class Nc extends Zn{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new Fe){const n=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),o=s-a,u=i[a===0?a:a-1],f=i[a],h=i[a>i.length-2?i.length-1:a+1],c=i[a>i.length-3?i.length-1:a+2];return n.set(Bh(o,u.x,f.x,h.x,c.x),Bh(o,u.y,f.y,h.y,c.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new Fe().fromArray(i))}return this}}Nc.prototype.isSplineCurve=!0;var bd=Object.freeze({__proto__:null,ArcCurve:yd,CatmullRomCurve3:xd,CubicBezierCurve:Rc,CubicBezierCurve3:_d,EllipseCurve:No,LineCurve:Do,LineCurve3:sM,QuadraticBezierCurve:Pc,QuadraticBezierCurve3:wd,SplineCurve:Nc});const aM={triangulate:function(r,e,t=2){const n=e&&e.length,i=n?e[0]*t:r.length;let s=Md(r,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,u,f,h,c,d,g;if(n&&(s=hM(r,e,s,t)),r.length>80*t){o=f=r[0],u=h=r[1];for(let x=t;x<i;x+=t)c=r[x],d=r[x+1],c<o&&(o=c),d<u&&(u=d),c>f&&(f=c),d>h&&(h=d);g=Math.max(f-o,h-u),g=g!==0?1/g:0}return ea(s,a,t,o,u,g),a}};function Md(r,e,t,n,i){let s,a;if(i===bM(r,e,t,n)>0)for(s=e;s<t;s+=n)a=Oh(s,r[s],r[s+1],a);else for(s=t-n;s>=e;s-=n)a=Oh(s,r[s],r[s+1],a);return a&&Io(a,a.next)&&(na(a),a=a.next),a}function $i(r,e){if(!r)return r;e||(e=r);let t=r,n;do if(n=!1,!t.steiner&&(Io(t,t.next)||kt(t.prev,t,t.next)===0)){if(na(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function ea(r,e,t,n,i,s,a){if(!r)return;!a&&s&&gM(r,n,i,s);let o=r,u,f;for(;r.prev!==r.next;){if(u=r.prev,f=r.next,s?lM(r,n,i,s):oM(r)){e.push(u.i/t),e.push(r.i/t),e.push(f.i/t),na(r),r=f.next,o=f.next;continue}if(r=f,r===o){a?a===1?(r=cM($i(r),e,t),ea(r,e,t,n,i,s,2)):a===2&&uM(r,e,t,n,i,s):ea($i(r),e,t,n,i,s,1);break}}}function oM(r){const e=r.prev,t=r,n=r.next;if(kt(e,t,n)>=0)return!1;let i=r.next.next;for(;i!==r.prev;){if(Qr(e.x,e.y,t.x,t.y,n.x,n.y,i.x,i.y)&&kt(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function lM(r,e,t,n){const i=r.prev,s=r,a=r.next;if(kt(i,s,a)>=0)return!1;const o=i.x<s.x?i.x<a.x?i.x:a.x:s.x<a.x?s.x:a.x,u=i.y<s.y?i.y<a.y?i.y:a.y:s.y<a.y?s.y:a.y,f=i.x>s.x?i.x>a.x?i.x:a.x:s.x>a.x?s.x:a.x,h=i.y>s.y?i.y>a.y?i.y:a.y:s.y>a.y?s.y:a.y,c=ac(o,u,e,t,n),d=ac(f,h,e,t,n);let g=r.prevZ,x=r.nextZ;for(;g&&g.z>=c&&x&&x.z<=d;){if(g!==r.prev&&g!==r.next&&Qr(i.x,i.y,s.x,s.y,a.x,a.y,g.x,g.y)&&kt(g.prev,g,g.next)>=0||(g=g.prevZ,x!==r.prev&&x!==r.next&&Qr(i.x,i.y,s.x,s.y,a.x,a.y,x.x,x.y)&&kt(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;g&&g.z>=c;){if(g!==r.prev&&g!==r.next&&Qr(i.x,i.y,s.x,s.y,a.x,a.y,g.x,g.y)&&kt(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;x&&x.z<=d;){if(x!==r.prev&&x!==r.next&&Qr(i.x,i.y,s.x,s.y,a.x,a.y,x.x,x.y)&&kt(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function cM(r,e,t){let n=r;do{const i=n.prev,s=n.next.next;!Io(i,s)&&Sd(i,n,n.next,s)&&ta(i,s)&&ta(s,i)&&(e.push(i.i/t),e.push(n.i/t),e.push(s.i/t),na(n),na(n.next),n=r=s),n=n.next}while(n!==r);return $i(n)}function uM(r,e,t,n,i,s){let a=r;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&xM(a,o)){let u=Ed(a,o);a=$i(a,a.next),u=$i(u,u.next),ea(a,e,t,n,i,s),ea(u,e,t,n,i,s);return}o=o.next}a=a.next}while(a!==r)}function hM(r,e,t,n){const i=[];let s,a,o,u,f;for(s=0,a=e.length;s<a;s++)o=e[s]*n,u=s<a-1?e[s+1]*n:r.length,f=Md(r,o,u,n,!1),f===f.next&&(f.steiner=!0),i.push(yM(f));for(i.sort(fM),s=0;s<i.length;s++)dM(i[s],t),t=$i(t,t.next);return t}function fM(r,e){return r.x-e.x}function dM(r,e){if(e=pM(r,e),e){const t=Ed(e,r);$i(e,e.next),$i(t,t.next)}}function pM(r,e){let t=e;const n=r.x,i=r.y;let s=-1/0,a;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const d=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>s){if(s=d,d===n){if(i===t.y)return t;if(i===t.next.y)return t.next}a=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!a)return null;if(n===s)return a;const o=a,u=a.x,f=a.y;let h=1/0,c;t=a;do n>=t.x&&t.x>=u&&n!==t.x&&Qr(i<f?n:s,i,u,f,i<f?s:n,i,t.x,t.y)&&(c=Math.abs(i-t.y)/(n-t.x),ta(t,r)&&(c<h||c===h&&(t.x>a.x||t.x===a.x&&mM(a,t)))&&(a=t,h=c)),t=t.next;while(t!==o);return a}function mM(r,e){return kt(r.prev,r,e.prev)<0&&kt(e.next,r,r.next)<0}function gM(r,e,t,n){let i=r;do i.z===null&&(i.z=ac(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,vM(i)}function vM(r){let e,t,n,i,s,a,o,u,f=1;do{for(t=r,r=null,s=null,a=0;t;){for(a++,n=t,o=0,e=0;e<f&&(o++,n=n.nextZ,!!n);e++);for(u=f;o>0||u>0&&n;)o!==0&&(u===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,o--):(i=n,n=n.nextZ,u--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;t=n}s.nextZ=null,f*=2}while(a>1);return r}function ac(r,e,t,n,i){return r=32767*(r-t)*i,e=32767*(e-n)*i,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function yM(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function Qr(r,e,t,n,i,s,a,o){return(i-a)*(e-o)-(r-a)*(s-o)>=0&&(r-a)*(n-o)-(t-a)*(e-o)>=0&&(t-a)*(s-o)-(i-a)*(n-o)>=0}function xM(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!_M(r,e)&&(ta(r,e)&&ta(e,r)&&wM(r,e)&&(kt(r.prev,r,e.prev)||kt(r,e.prev,e))||Io(r,e)&&kt(r.prev,r,r.next)>0&&kt(e.prev,e,e.next)>0)}function kt(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function Io(r,e){return r.x===e.x&&r.y===e.y}function Sd(r,e,t,n){const i=qa(kt(r,e,t)),s=qa(kt(r,e,n)),a=qa(kt(t,n,r)),o=qa(kt(t,n,e));return!!(i!==s&&a!==o||i===0&&Wa(r,t,e)||s===0&&Wa(r,n,e)||a===0&&Wa(t,r,n)||o===0&&Wa(t,e,n))}function Wa(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function qa(r){return r>0?1:r<0?-1:0}function _M(r,e){let t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&Sd(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function ta(r,e){return kt(r.prev,r,r.next)<0?kt(r,e,r.next)>=0&&kt(r,r.prev,e)>=0:kt(r,e,r.prev)<0||kt(r,r.next,e)<0}function wM(r,e){let t=r,n=!1;const i=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function Ed(r,e){const t=new oc(r.i,r.x,r.y),n=new oc(e.i,e.x,e.y),i=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function Oh(r,e,t,n){const i=new oc(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function na(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function oc(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function bM(r,e,t,n){let i=0;for(let s=e,a=t-n;s<t;s+=n)i+=(r[a]-r[s])*(r[s+1]+r[a+1]),a=s;return i}class Yi{static area(e){const t=e.length;let n=0;for(let i=t-1,s=0;s<t;i=s++)n+=e[i].x*e[s].y-e[s].x*e[i].y;return n*.5}static isClockWise(e){return Yi.area(e)<0}static triangulateShape(e,t){const n=[],i=[],s=[];zh(e),Uh(n,e);let a=e.length;t.forEach(zh);for(let u=0;u<t.length;u++)i.push(a),a+=t[u].length,Uh(n,t[u]);const o=aM.triangulate(n,i);for(let u=0;u<o.length;u+=3)s.push(o.slice(u,u+3));return s}}function zh(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function Uh(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}class vs extends Rt{constructor(e,t){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],s=[];for(let o=0,u=e.length;o<u;o++){const f=e[o];a(f)}this.setAttribute("position",new qt(i,3)),this.setAttribute("uv",new qt(s,2)),this.computeVertexNormals();function a(o){const u=[],f=t.curveSegments!==void 0?t.curveSegments:12,h=t.steps!==void 0?t.steps:1;let c=t.depth!==void 0?t.depth:100,d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,g=t.bevelThickness!==void 0?t.bevelThickness:6,x=t.bevelSize!==void 0?t.bevelSize:g-2,v=t.bevelOffset!==void 0?t.bevelOffset:0,b=t.bevelSegments!==void 0?t.bevelSegments:3;const y=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:MM;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=t.amount);let S,L=!1,T,m,C,N;y&&(S=y.getSpacedPoints(h),L=!0,d=!1,T=y.computeFrenetFrames(h,!1),m=new V,C=new V,N=new V),d||(b=0,g=0,x=0,v=0);const z=o.extractPoints(f);let W=z.shape;const B=z.holes;if(!Yi.isClockWise(W)){W=W.reverse();for(let fe=0,ge=B.length;fe<ge;fe++){const Ae=B[fe];Yi.isClockWise(Ae)&&(B[fe]=Ae.reverse())}}const $=Yi.triangulateShape(W,B),Q=W;for(let fe=0,ge=B.length;fe<ge;fe++){const Ae=B[fe];W=W.concat(Ae)}function K(fe,ge,Ae){return ge||console.error("THREE.ExtrudeGeometry: vec does not exist"),ge.clone().multiplyScalar(Ae).add(fe)}const j=W.length,ie=$.length;function de(fe,ge,Ae){let ke,pe,O;const F=fe.x-ge.x,ye=fe.y-ge.y,D=Ae.x-fe.x,X=Ae.y-fe.y,J=F*F+ye*ye,Y=F*X-ye*D;if(Math.abs(Y)>Number.EPSILON){const ve=Math.sqrt(J),Te=Math.sqrt(D*D+X*X),Me=ge.x-ye/ve,U=ge.y+F/ve,ce=Ae.x-X/Te,oe=Ae.y+D/Te,Ue=((ce-Me)*X-(oe-U)*D)/(F*X-ye*D);ke=Me+F*Ue-fe.x,pe=U+ye*Ue-fe.y;const q=ke*ke+pe*pe;if(q<=2)return new Fe(ke,pe);O=Math.sqrt(q/2)}else{let ve=!1;F>Number.EPSILON?D>Number.EPSILON&&(ve=!0):F<-Number.EPSILON?D<-Number.EPSILON&&(ve=!0):Math.sign(ye)===Math.sign(X)&&(ve=!0),ve?(ke=-ye,pe=F,O=Math.sqrt(J)):(ke=F,pe=ye,O=Math.sqrt(J/2))}return new Fe(ke/O,pe/O)}const we=[];for(let fe=0,ge=Q.length,Ae=ge-1,ke=fe+1;fe<ge;fe++,Ae++,ke++)Ae===ge&&(Ae=0),ke===ge&&(ke=0),we[fe]=de(Q[fe],Q[Ae],Q[ke]);const Ne=[];let Se,Ve=we.concat();for(let fe=0,ge=B.length;fe<ge;fe++){const Ae=B[fe];Se=[];for(let ke=0,pe=Ae.length,O=pe-1,F=ke+1;ke<pe;ke++,O++,F++)O===pe&&(O=0),F===pe&&(F=0),Se[ke]=de(Ae[ke],Ae[O],Ae[F]);Ne.push(Se),Ve=Ve.concat(Se)}for(let fe=0;fe<b;fe++){const ge=fe/b,Ae=g*Math.cos(ge*Math.PI/2),ke=x*Math.sin(ge*Math.PI/2)+v;for(let pe=0,O=Q.length;pe<O;pe++){const F=K(Q[pe],we[pe],ke);ze(F.x,F.y,-Ae)}for(let pe=0,O=B.length;pe<O;pe++){const F=B[pe];Se=Ne[pe];for(let ye=0,D=F.length;ye<D;ye++){const X=K(F[ye],Se[ye],ke);ze(X.x,X.y,-Ae)}}}const ue=x+v;for(let fe=0;fe<j;fe++){const ge=d?K(W[fe],Ve[fe],ue):W[fe];L?(C.copy(T.normals[0]).multiplyScalar(ge.x),m.copy(T.binormals[0]).multiplyScalar(ge.y),N.copy(S[0]).add(C).add(m),ze(N.x,N.y,N.z)):ze(ge.x,ge.y,0)}for(let fe=1;fe<=h;fe++)for(let ge=0;ge<j;ge++){const Ae=d?K(W[ge],Ve[ge],ue):W[ge];L?(C.copy(T.normals[fe]).multiplyScalar(Ae.x),m.copy(T.binormals[fe]).multiplyScalar(Ae.y),N.copy(S[fe]).add(C).add(m),ze(N.x,N.y,N.z)):ze(Ae.x,Ae.y,c/h*fe)}for(let fe=b-1;fe>=0;fe--){const ge=fe/b,Ae=g*Math.cos(ge*Math.PI/2),ke=x*Math.sin(ge*Math.PI/2)+v;for(let pe=0,O=Q.length;pe<O;pe++){const F=K(Q[pe],we[pe],ke);ze(F.x,F.y,c+Ae)}for(let pe=0,O=B.length;pe<O;pe++){const F=B[pe];Se=Ne[pe];for(let ye=0,D=F.length;ye<D;ye++){const X=K(F[ye],Se[ye],ke);L?ze(X.x,X.y+S[h-1].y,S[h-1].x+Ae):ze(X.x,X.y,c+Ae)}}}Ee(),Oe();function Ee(){const fe=i.length/3;if(d){let ge=0,Ae=j*ge;for(let ke=0;ke<ie;ke++){const pe=$[ke];je(pe[2]+Ae,pe[1]+Ae,pe[0]+Ae)}ge=h+b*2,Ae=j*ge;for(let ke=0;ke<ie;ke++){const pe=$[ke];je(pe[0]+Ae,pe[1]+Ae,pe[2]+Ae)}}else{for(let ge=0;ge<ie;ge++){const Ae=$[ge];je(Ae[2],Ae[1],Ae[0])}for(let ge=0;ge<ie;ge++){const Ae=$[ge];je(Ae[0]+j*h,Ae[1]+j*h,Ae[2]+j*h)}}n.addGroup(fe,i.length/3-fe,0)}function Oe(){const fe=i.length/3;let ge=0;re(Q,ge),ge+=Q.length;for(let Ae=0,ke=B.length;Ae<ke;Ae++){const pe=B[Ae];re(pe,ge),ge+=pe.length}n.addGroup(fe,i.length/3-fe,1)}function re(fe,ge){let Ae=fe.length;for(;--Ae>=0;){const ke=Ae;let pe=Ae-1;pe<0&&(pe=fe.length-1);for(let O=0,F=h+b*2;O<F;O++){const ye=j*O,D=j*(O+1),X=ge+ke+ye,J=ge+pe+ye,Y=ge+pe+D,ve=ge+ke+D;Ie(X,J,Y,ve)}}}function ze(fe,ge,Ae){u.push(fe),u.push(ge),u.push(Ae)}function je(fe,ge,Ae){Be(fe),Be(ge),Be(Ae);const ke=i.length/3,pe=w.generateTopUV(n,i,ke-3,ke-2,ke-1);Xe(pe[0]),Xe(pe[1]),Xe(pe[2])}function Ie(fe,ge,Ae,ke){Be(fe),Be(ge),Be(ke),Be(ge),Be(Ae),Be(ke);const pe=i.length/3,O=w.generateSideWallUV(n,i,pe-6,pe-3,pe-2,pe-1);Xe(O[0]),Xe(O[1]),Xe(O[3]),Xe(O[1]),Xe(O[2]),Xe(O[3])}function Be(fe){i.push(u[fe*3+0]),i.push(u[fe*3+1]),i.push(u[fe*3+2])}function Xe(fe){s.push(fe.x),s.push(fe.y)}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return SM(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=t[e.shapes[s]];n.push(o)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new bd[i.type]().fromJSON(i)),new vs(n,e.options)}}const MM={generateTopUV:function(r,e,t,n,i){const s=e[t*3],a=e[t*3+1],o=e[n*3],u=e[n*3+1],f=e[i*3],h=e[i*3+1];return[new Fe(s,a),new Fe(o,u),new Fe(f,h)]},generateSideWallUV:function(r,e,t,n,i,s){const a=e[t*3],o=e[t*3+1],u=e[t*3+2],f=e[n*3],h=e[n*3+1],c=e[n*3+2],d=e[i*3],g=e[i*3+1],x=e[i*3+2],v=e[s*3],b=e[s*3+1],y=e[s*3+2];return Math.abs(o-h)<Math.abs(a-f)?[new Fe(a,1-u),new Fe(f,1-c),new Fe(d,1-x),new Fe(v,1-y)]:[new Fe(o,1-u),new Fe(h,1-c),new Fe(g,1-x),new Fe(b,1-y)]}};function SM(r,e,t){if(t.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];t.shapes.push(s.uuid)}else t.shapes.push(r.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Dc extends Rt{constructor(e,t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],s=[],a=[];let o=0,u=0;if(Array.isArray(e)===!1)f(e);else for(let h=0;h<e.length;h++)f(e[h]),this.addGroup(o,u,h),o+=u,u=0;this.setIndex(n),this.setAttribute("position",new qt(i,3)),this.setAttribute("normal",new qt(s,3)),this.setAttribute("uv",new qt(a,2));function f(h){const c=i.length/3,d=h.extractPoints(t);let g=d.shape;const x=d.holes;Yi.isClockWise(g)===!1&&(g=g.reverse());for(let b=0,y=x.length;b<y;b++){const w=x[b];Yi.isClockWise(w)===!0&&(x[b]=w.reverse())}const v=Yi.triangulateShape(g,x);for(let b=0,y=x.length;b<y;b++){const w=x[b];g=g.concat(w)}for(let b=0,y=g.length;b<y;b++){const w=g[b];i.push(w.x,w.y,0),s.push(0,0,1),a.push(w.x,w.y)}for(let b=0,y=v.length;b<y;b++){const w=v[b],S=w[0]+c,L=w[1]+c,T=w[2]+c;n.push(S,L,T),u+=3}}}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return EM(t,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];n.push(a)}return new Dc(n,e.curveSegments)}}function EM(r,e){if(e.shapes=[],Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const i=r[t];e.shapes.push(i.uuid)}else e.shapes.push(r.uuid);return e}class Ic extends Rt{constructor(e=1,t=32,n=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(a+o,Math.PI);let f=0;const h=[],c=new V,d=new V,g=[],x=[],v=[],b=[];for(let y=0;y<=n;y++){const w=[],S=y/n;let L=0;y==0&&a==0?L=.5/t:y==n&&u==Math.PI&&(L=-.5/t);for(let T=0;T<=t;T++){const m=T/t;c.x=-e*Math.cos(i+m*s)*Math.sin(a+S*o),c.y=e*Math.cos(a+S*o),c.z=e*Math.sin(i+m*s)*Math.sin(a+S*o),x.push(c.x,c.y,c.z),d.copy(c).normalize(),v.push(d.x,d.y,d.z),b.push(m+L,1-S),w.push(f++)}h.push(w)}for(let y=0;y<n;y++)for(let w=0;w<t;w++){const S=h[y][w+1],L=h[y][w],T=h[y+1][w],m=h[y+1][w+1];(y!==0||a>0)&&g.push(S,L,m),(y!==n-1||u<Math.PI)&&g.push(L,T,m)}this.setIndex(g),this.setAttribute("position",new qt(x,3)),this.setAttribute("normal",new qt(v,3)),this.setAttribute("uv",new qt(b,2))}static fromJSON(e){return new Ic(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class TM extends yn{constructor(e){super(),this.type="ShadowMaterial",this.color=new Ke(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}TM.prototype.isShadowMaterial=!0;class Td extends yn{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ke(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=us,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Td.prototype.isMeshStandardMaterial=!0;class AM extends Td{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Fe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Rn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenTint=new Ke(0),this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new Ke(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new Ke(1,1,1),this.specularTintMap=null,this._clearcoat=0,this._transmission=0,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheenTint.copy(e.sheenTint),this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}AM.prototype.isMeshPhysicalMaterial=!0;class CM extends yn{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Ke(16777215),this.specular=new Ke(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=us,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=wo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}CM.prototype.isMeshPhongMaterial=!0;class LM extends yn{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ke(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=us,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}LM.prototype.isMeshToonMaterial=!0;class RM extends yn{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=us,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}RM.prototype.isMeshNormalMaterial=!0;class PM extends yn{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Ke(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ke(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=wo,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}PM.prototype.isMeshLambertMaterial=!0;class NM extends yn{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ke(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=us,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}NM.prototype.isMeshMatcapMaterial=!0;class DM extends gs{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}DM.prototype.isLineDashedMaterial=!0;const Ft={arraySlice:function(r,e,t){return Ft.isTypedArray(r)?new r.constructor(r.subarray(e,t!==void 0?t:r.length)):r.slice(e,t)},convertArray:function(r,e,t){return!r||!t&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){function e(i,s){return r[i]-r[s]}const t=r.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n},sortedArray:function(r,e,t){const n=r.length,i=new r.constructor(n);for(let s=0,a=0;a!==n;++s){const o=t[s]*e;for(let u=0;u!==e;++u)i[a++]=r[o+u]}return i},flattenJSON:function(r,e,t,n){let i=1,s=r[0];for(;s!==void 0&&s[n]===void 0;)s=r[i++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(e.push(s.time),t.push.apply(t,a)),s=r[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=r[i++];while(s!==void 0);else do a=s[n],a!==void 0&&(e.push(s.time),t.push(a)),s=r[i++];while(s!==void 0)},subclip:function(r,e,t,n,i=30){const s=r.clone();s.name=e;const a=[];for(let u=0;u<s.tracks.length;++u){const f=s.tracks[u],h=f.getValueSize(),c=[],d=[];for(let g=0;g<f.times.length;++g){const x=f.times[g]*i;if(!(x<t||x>=n)){c.push(f.times[g]);for(let v=0;v<h;++v)d.push(f.values[g*h+v])}}c.length!==0&&(f.times=Ft.convertArray(c,f.times.constructor),f.values=Ft.convertArray(d,f.values.constructor),a.push(f))}s.tracks=a;let o=1/0;for(let u=0;u<s.tracks.length;++u)o>s.tracks[u].times[0]&&(o=s.tracks[u].times[0]);for(let u=0;u<s.tracks.length;++u)s.tracks[u].shift(-1*o);return s.resetDuration(),s},makeClipAdditive:function(r,e=0,t=r,n=30){n<=0&&(n=30);const i=t.tracks.length,s=e/n;for(let a=0;a<i;++a){const o=t.tracks[a],u=o.ValueTypeName;if(u==="bool"||u==="string")continue;const f=r.tracks.find(function(y){return y.name===o.name&&y.ValueTypeName===u});if(f===void 0)continue;let h=0;const c=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=c/3);let d=0;const g=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=g/3);const x=o.times.length-1;let v;if(s<=o.times[0]){const y=h,w=c-h;v=Ft.arraySlice(o.values,y,w)}else if(s>=o.times[x]){const y=x*c+h,w=y+c-h;v=Ft.arraySlice(o.values,y,w)}else{const y=o.createInterpolant(),w=h,S=c-h;y.evaluate(s),v=Ft.arraySlice(y.resultBuffer,w,S)}u==="quaternion"&&new mn().fromArray(v).normalize().conjugate().toArray(v);const b=f.times.length;for(let y=0;y<b;++y){const w=y*g+d;if(u==="quaternion")mn.multiplyQuaternionsFlat(f.values,w,v,0,f.values,w);else{const S=g-d*2;for(let L=0;L<S;++L)f.values[w+L]-=v[L]}}}return r.blendMode=Vf,r}};class Ji{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],s=t[n-1];e:{t:{let a;n:{i:if(!(e<i)){for(let o=n+2;;){if(i===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,s)}if(n===o)break;if(s=i,i=t[++n],e<i)break t}a=t.length;break n}if(!(e>=s)){const o=t[1];e<o&&(n=2,s=o);for(let u=n-2;;){if(s===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===u)break;if(i=s,s=t[--n-1],e>=s)break t}a=n,n=0;break n}break e}for(;n<a;){const o=n+a>>>1;e<t[o]?a=o:n=o+1}if(i=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(i===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,s,e)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Ji.prototype.beforeStart_=Ji.prototype.copySampleValue_;Ji.prototype.afterEnd_=Ji.prototype.copySampleValue_;class IM extends Ji{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Zr,endingEnd:Zr}}intervalChanged_(e,t,n){const i=this.parameterPositions;let s=e-2,a=e+1,o=i[s],u=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case $r:s=e,o=2*t-n;break;case oo:s=i.length-2,o=t+i[s]-i[s+1];break;default:s=e,o=n}if(u===void 0)switch(this.getSettings_().endingEnd){case $r:a=e,u=2*n-t;break;case oo:a=1,u=n+i[1]-i[0];break;default:a=e-1,u=t}const f=(n-t)*.5,h=this.valueSize;this._weightPrev=f/(t-o),this._weightNext=f/(u-n),this._offsetPrev=s*h,this._offsetNext=a*h}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,u=e*o,f=u-o,h=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,g=this._weightNext,x=(n-t)/(i-t),v=x*x,b=v*x,y=-d*b+2*d*v-d*x,w=(1+d)*b+(-1.5-2*d)*v+(-.5+d)*x+1,S=(-1-g)*b+(1.5+g)*v+.5*x,L=g*b-g*v;for(let T=0;T!==o;++T)s[T]=y*a[h+T]+w*a[f+T]+S*a[u+T]+L*a[c+T];return s}}class Ad extends Ji{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,u=e*o,f=u-o,h=(n-t)/(i-t),c=1-h;for(let d=0;d!==o;++d)s[d]=a[f+d]*c+a[u+d]*h;return s}}class FM extends Ji{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class yi{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ft.convertArray(t,this.TimeBufferType),this.values=Ft.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ft.convertArray(e.times,Array),values:Ft.convertArray(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new FM(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ad(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new IM(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case so:t=this.InterpolantFactoryMethodDiscrete;break;case ao:t=this.InterpolantFactoryMethodLinear;break;case nl:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return so;case this.InterpolantFactoryMethodLinear:return ao;case this.InterpolantFactoryMethodSmooth:return nl}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let s=0,a=i-1;for(;s!==i&&n[s]<e;)++s;for(;a!==-1&&n[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=Ft.arraySlice(n,s,a),this.values=Ft.arraySlice(this.values,s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const u=n[o];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,u),e=!1;break}if(a!==null&&a>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,u,a),e=!1;break}a=u}if(i!==void 0&&Ft.isTypedArray(i))for(let o=0,u=i.length;o!==u;++o){const f=i[o];if(isNaN(f)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,f),e=!1;break}}return e}optimize(){const e=Ft.arraySlice(this.times),t=Ft.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===nl,s=e.length-1;let a=1;for(let o=1;o<s;++o){let u=!1;const f=e[o],h=e[o+1];if(f!==h&&(o!==1||f!==e[0]))if(i)u=!0;else{const c=o*n,d=c-n,g=c+n;for(let x=0;x!==n;++x){const v=t[c+x];if(v!==t[d+x]||v!==t[g+x]){u=!0;break}}}if(u){if(o!==a){e[a]=e[o];const c=o*n,d=a*n;for(let g=0;g!==n;++g)t[d+g]=t[c+g]}++a}}if(s>0){e[a]=e[s];for(let o=s*n,u=a*n,f=0;f!==n;++f)t[u+f]=t[o+f];++a}return a!==e.length?(this.times=Ft.arraySlice(e,0,a),this.values=Ft.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this}clone(){const e=Ft.arraySlice(this.times,0),t=Ft.arraySlice(this.values,0),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}yi.prototype.TimeBufferType=Float32Array;yi.prototype.ValueBufferType=Float32Array;yi.prototype.DefaultInterpolation=ao;class ys extends yi{}ys.prototype.ValueTypeName="bool";ys.prototype.ValueBufferType=Array;ys.prototype.DefaultInterpolation=so;ys.prototype.InterpolantFactoryMethodLinear=void 0;ys.prototype.InterpolantFactoryMethodSmooth=void 0;class Cd extends yi{}Cd.prototype.ValueTypeName="color";class co extends yi{}co.prototype.ValueTypeName="number";class BM extends Ji{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,u=(n-t)/(i-t);let f=e*o;for(let h=f+o;f!==h;f+=4)mn.slerpFlat(s,0,a,f-o,a,f,u);return s}}class aa extends yi{InterpolantFactoryMethodLinear(e){return new BM(this.times,this.values,this.getValueSize(),e)}}aa.prototype.ValueTypeName="quaternion";aa.prototype.DefaultInterpolation=ao;aa.prototype.InterpolantFactoryMethodSmooth=void 0;class xs extends yi{}xs.prototype.ValueTypeName="string";xs.prototype.ValueBufferType=Array;xs.prototype.DefaultInterpolation=so;xs.prototype.InterpolantFactoryMethodLinear=void 0;xs.prototype.InterpolantFactoryMethodSmooth=void 0;class uo extends yi{}uo.prototype.ValueTypeName="vector";class kh{constructor(e,t=-1,n,i=yc){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=pi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let a=0,o=n.length;a!==o;++a)t.push(zM(n[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=n.length;s!==a;++s)t.push(yi.toJSON(n[s]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const s=t.length,a=[];for(let o=0;o<s;o++){let u=[],f=[];u.push((o+s-1)%s,o,(o+1)%s),f.push(0,1,0);const h=Ft.getKeyframeOrder(u);u=Ft.sortedArray(u,1,h),f=Ft.sortedArray(f,1,h),!i&&u[0]===0&&(u.push(s),f.push(f[0])),a.push(new co(".morphTargetInfluences["+t[o].name+"]",u,f).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,u=e.length;o<u;o++){const f=e[o],h=f.name.match(s);if(h&&h.length>1){const c=h[1];let d=i[c];d||(i[c]=d=[]),d.push(f)}}const a=[];for(const o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],t,n));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(c,d,g,x,v){if(g.length!==0){const b=[],y=[];Ft.flattenJSON(g,b,y,x),b.length!==0&&v.push(new c(d,b,y))}},i=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let u=e.length||-1;const f=e.hierarchy||[];for(let c=0;c<f.length;c++){const d=f[c].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const g={};let x;for(x=0;x<d.length;x++)if(d[x].morphTargets)for(let v=0;v<d[x].morphTargets.length;v++)g[d[x].morphTargets[v]]=-1;for(const v in g){const b=[],y=[];for(let w=0;w!==d[x].morphTargets.length;++w){const S=d[x];b.push(S.time),y.push(S.morphTarget===v?1:0)}i.push(new co(".morphTargetInfluence["+v+"]",b,y))}u=g.length*(a||1)}else{const g=".bones["+t[c].name+"]";n(uo,g+".position",d,"pos",i),n(aa,g+".quaternion",d,"rot",i),n(uo,g+".scale",d,"scl",i)}}return i.length===0?null:new this(s,u,i,o)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function OM(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return co;case"vector":case"vector2":case"vector3":case"vector4":return uo;case"color":return Cd;case"quaternion":return aa;case"bool":case"boolean":return ys;case"string":return xs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function zM(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=OM(r.type);if(r.times===void 0){const t=[],n=[];Ft.flattenJSON(r.keys,t,n,"value"),r.times=t,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const ls={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class UM{constructor(e,t,n){const i=this;let s=!1,a=0,o=0,u;const f=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(h){o++,s===!1&&i.onStart!==void 0&&i.onStart(h,a,o),s=!0},this.itemEnd=function(h){a++,i.onProgress!==void 0&&i.onProgress(h,a,o),a===o&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(h){i.onError!==void 0&&i.onError(h)},this.resolveURL=function(h){return u?u(h):h},this.setURLModifier=function(h){return u=h,this},this.addHandler=function(h,c){return f.push(h,c),this},this.removeHandler=function(h){const c=f.indexOf(h);return c!==-1&&f.splice(c,2),this},this.getHandler=function(h){for(let c=0,d=f.length;c<d;c+=2){const g=f[c],x=f[c+1];if(g.global&&(g.lastIndex=0),g.test(h))return x}return null}}}const kM=new UM;class er{constructor(e){this.manager=e!==void 0?e:kM,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,s){n.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const si={};class HM extends er{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=ls.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;if(si[e]!==void 0){si[e].push({onLoad:t,onProgress:n,onError:i});return}const o=/^data:(.*?)(;base64)?,(.*)$/,u=e.match(o);let f;if(u){const h=u[1],c=!!u[2];let d=u[3];d=decodeURIComponent(d),c&&(d=atob(d));try{let g;const x=(this.responseType||"").toLowerCase();switch(x){case"arraybuffer":case"blob":const v=new Uint8Array(d.length);for(let y=0;y<d.length;y++)v[y]=d.charCodeAt(y);x==="blob"?g=new Blob([v.buffer],{type:h}):g=v.buffer;break;case"document":g=new DOMParser().parseFromString(d,h);break;case"json":g=JSON.parse(d);break;default:g=d;break}setTimeout(function(){t&&t(g),s.manager.itemEnd(e)},0)}catch(g){setTimeout(function(){i&&i(g),s.manager.itemError(e),s.manager.itemEnd(e)},0)}}else{si[e]=[],si[e].push({onLoad:t,onProgress:n,onError:i}),f=new XMLHttpRequest,f.open("GET",e,!0),f.addEventListener("load",function(h){const c=this.response,d=si[e];if(delete si[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ls.add(e,c);for(let g=0,x=d.length;g<x;g++){const v=d[g];v.onLoad&&v.onLoad(c)}s.manager.itemEnd(e)}else{for(let g=0,x=d.length;g<x;g++){const v=d[g];v.onError&&v.onError(h)}s.manager.itemError(e),s.manager.itemEnd(e)}},!1),f.addEventListener("progress",function(h){const c=si[e];for(let d=0,g=c.length;d<g;d++){const x=c[d];x.onProgress&&x.onProgress(h)}},!1),f.addEventListener("error",function(h){const c=si[e];delete si[e];for(let d=0,g=c.length;d<g;d++){const x=c[d];x.onError&&x.onError(h)}s.manager.itemError(e),s.manager.itemEnd(e)},!1),f.addEventListener("abort",function(h){const c=si[e];delete si[e];for(let d=0,g=c.length;d<g;d++){const x=c[d];x.onError&&x.onError(h)}s.manager.itemError(e),s.manager.itemEnd(e)},!1),this.responseType!==void 0&&(f.responseType=this.responseType),this.withCredentials!==void 0&&(f.withCredentials=this.withCredentials),f.overrideMimeType&&f.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const h in this.requestHeader)f.setRequestHeader(h,this.requestHeader[h]);f.send(null)}return s.manager.itemStart(e),f}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Ld extends er{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=ls.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function u(){o.removeEventListener("load",u,!1),o.removeEventListener("error",f,!1),ls.add(e,this),t&&t(this),s.manager.itemEnd(e)}function f(h){o.removeEventListener("load",u,!1),o.removeEventListener("error",f,!1),i&&i(h),s.manager.itemError(e),s.manager.itemEnd(e)}return o.addEventListener("load",u,!1),o.addEventListener("error",f,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class VM extends er{constructor(e){super(e)}load(e,t,n,i){const s=new Co,a=new Ld(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function u(f){a.load(e[f],function(h){s.images[f]=h,o++,o===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let f=0;f<e.length;++f)u(f);return s}}class GM extends er{constructor(e){super(e)}load(e,t,n,i){const s=new un,a=new Ld(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o;const u=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;s.format=u?qi:Gn,s.needsUpdate=!0,t!==void 0&&t(s)},n,i),s}}class WM extends Zn{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Do(t,e))}getPoint(e){const t=e*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=t){const s=n[i]-t,a=this.curves[i],o=a.getLength(),u=o===0?0:1-s/o;return a.getPointAt(u)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],o=a&&a.isEllipseCurve?e*2:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,u=a.getPoints(o);for(let f=0;f<u.length;f++){const h=u[f];n&&n.equals(h)||(t.push(h),n=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new bd[i.type]().fromJSON(i))}return this}}class lc extends WM{constructor(e){super(),this.type="Path",this.currentPoint=new Fe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Do(this.currentPoint.clone(),new Fe(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const s=new Pc(this.currentPoint.clone(),new Fe(e,t),new Fe(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,s,a){const o=new Rc(this.currentPoint.clone(),new Fe(e,t),new Fe(n,i),new Fe(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Nc(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,s,a){const o=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+o,t+u,n,i,s,a),this}absarc(e,t,n,i,s,a){return this.absellipse(e,t,n,n,i,s,a),this}ellipse(e,t,n,i,s,a,o,u){const f=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+f,t+h,n,i,s,a,o,u),this}absellipse(e,t,n,i,s,a,o,u){const f=new No(e,t,n,i,s,a,o,u);if(this.curves.length>0){const c=f.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(f);const h=f.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Fc extends lc{constructor(e){super(e),this.uuid=pi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new lc().fromJSON(i))}return this}}class vi extends bt{constructor(e,t=1){super(),this.type="Light",this.color=new Ke(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}vi.prototype.isLight=!0;class qM extends vi{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(bt.DefaultUp),this.updateMatrix(),this.groundColor=new Ke(t)}copy(e){return vi.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}qM.prototype.isHemisphereLight=!0;const Hh=new st,Vh=new V,Gh=new V;class Bc{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Fe(512,512),this.map=null,this.mapPass=null,this.matrix=new st,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Lo,this._frameExtents=new Fe(1,1),this._viewportCount=1,this._viewports=[new Ct(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Vh.setFromMatrixPosition(e.matrixWorld),t.position.copy(Vh),Gh.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Gh),t.updateMatrixWorld(),Hh.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hh),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Rd extends Bc{constructor(){super(new xn(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=nc*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Rd.prototype.isSpotLightShadow=!0;class jM extends vi{constructor(e,t,n=0,i=Math.PI/3,s=0,a=1){super(e,t),this.type="SpotLight",this.position.copy(bt.DefaultUp),this.updateMatrix(),this.target=new bt,this.distance=n,this.angle=i,this.penumbra=s,this.decay=a,this.shadow=new Rd}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}jM.prototype.isSpotLight=!0;const Wh=new st,Us=new V,zl=new V;class Pd extends Bc{constructor(){super(new xn(90,1,.5,500)),this._frameExtents=new Fe(4,2),this._viewportCount=6,this._viewports=[new Ct(2,1,1,1),new Ct(0,1,1,1),new Ct(3,1,1,1),new Ct(1,1,1,1),new Ct(3,0,1,1),new Ct(1,0,1,1)],this._cubeDirections=[new V(1,0,0),new V(-1,0,0),new V(0,0,1),new V(0,0,-1),new V(0,1,0),new V(0,-1,0)],this._cubeUps=[new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,0,1),new V(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Us.setFromMatrixPosition(e.matrixWorld),n.position.copy(Us),zl.copy(n.position),zl.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(zl),n.updateMatrixWorld(),i.makeTranslation(-Us.x,-Us.y,-Us.z),Wh.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Wh)}}Pd.prototype.isPointLightShadow=!0;class XM extends vi{constructor(e,t,n=0,i=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Pd}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}XM.prototype.isPointLight=!0;class Nd extends Bc{constructor(){super(new Sc(-5,5,5,-5,.5,500))}}Nd.prototype.isDirectionalLightShadow=!0;class YM extends vi{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(bt.DefaultUp),this.updateMatrix(),this.target=new bt,this.shadow=new Nd}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}YM.prototype.isDirectionalLight=!0;class ZM extends vi{constructor(e,t){super(e,t),this.type="AmbientLight"}}ZM.prototype.isAmbientLight=!0;class $M extends vi{constructor(e,t,n=10,i=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}$M.prototype.isRectAreaLight=!0;class Dd{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new V)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*i)),t.addScaledVector(a[5],1.092548*(i*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(n*s)),t.addScaledVector(a[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*i),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*i),t.addScaledVector(a[5],2*.429043*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*n*s),t.addScaledVector(a[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-i*i)}}Dd.prototype.isSphericalHarmonics3=!0;class Oc extends vi{constructor(e=new Dd,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Oc.prototype.isLightProbe=!0;class JM{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}}class QM extends Rt{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}QM.prototype.isInstancedBufferGeometry=!0;class KM extends er{constructor(e){super(e),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=ls.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){ls.add(e,u),t&&t(u),s.manager.itemEnd(e)}).catch(function(u){i&&i(u),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}KM.prototype.isImageBitmapLoader=!0;let ja;const e1={getContext:function(){return ja===void 0&&(ja=new(window.AudioContext||window.webkitAudioContext)),ja},setContext:function(r){ja=r}};class t1 extends er{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new HM(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{const u=o.slice(0);e1.getContext().decodeAudioData(u,function(h){t(h)})}catch(u){i?i(u):console.error(u),s.manager.itemError(e)}},n,i)}}class n1 extends Oc{constructor(e,t,n=1){super(void 0,n);const i=new Ke().set(e),s=new Ke().set(t),a=new V(i.r,i.g,i.b),o=new V(s.r,s.g,s.b),u=Math.sqrt(Math.PI),f=u*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(u),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(f)}}n1.prototype.isHemisphereLightProbe=!0;class i1 extends Oc{constructor(e,t=1){super(void 0,t);const n=new Ke().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}i1.prototype.isAmbientLightProbe=!0;class r1 extends bt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}class s1{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,s,a;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)n[s+o]=n[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(n,s,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const u=t*this._origIndex;this._mixBufferRegion(n,i,u,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let u=t,f=t+t;u!==f;++u)if(n[u]!==n[u+t]){o.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let s=n,a=i;s!==a;++s)t[s]=t[i+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[n+a]}_slerp(e,t,n,i){mn.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,s){const a=this._workIndex*s;mn.multiplyQuaternionsFlat(e,a,e,t,e,n),mn.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,n,i,s){const a=1-i;for(let o=0;o!==s;++o){const u=t+o;e[u]=e[u]*a+e[n+o]*i}}_lerpAdditive(e,t,n,i,s){for(let a=0;a!==s;++a){const o=t+a;e[o]=e[o]+e[n+a]*i}}}const zc="\\[\\]\\.:\\/",a1=new RegExp("["+zc+"]","g"),Uc="[^"+zc+"]",o1="[^"+zc.replace("\\.","")+"]",l1=/((?:WC+[\/:])*)/.source.replace("WC",Uc),c1=/(WCOD+)?/.source.replace("WCOD",o1),u1=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Uc),h1=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Uc),f1=new RegExp("^"+l1+c1+u1+h1+"$"),d1=["material","materials","bones"];class p1{constructor(e,t,n){const i=n||Mt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=n.length;i!==s;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Mt{constructor(e,t,n){this.path=t,this.parsedPath=n||Mt.parseTrackName(t),this.node=Mt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Mt.Composite(e,t,n):new Mt(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(a1,"")}static parseTrackName(e){const t=f1.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=n.nodeName.substring(i+1);d1.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(!t||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const u=n(o.children);if(u)return u}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=Mt.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let f=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===f){f=h;break}break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(f!==void 0){if(e[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[f]}}const a=e[i];if(a===void 0){const f=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Mt.Composite=p1;Mt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Mt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Mt.prototype.GetterByBindingType=[Mt.prototype._getValue_direct,Mt.prototype._getValue_array,Mt.prototype._getValue_arrayElement,Mt.prototype._getValue_toArray];Mt.prototype.SetterByBindingTypeAndVersioning=[[Mt.prototype._setValue_direct,Mt.prototype._setValue_direct_setNeedsUpdate,Mt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Mt.prototype._setValue_array,Mt.prototype._setValue_array_setNeedsUpdate,Mt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Mt.prototype._setValue_arrayElement,Mt.prototype._setValue_arrayElement_setNeedsUpdate,Mt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Mt.prototype._setValue_fromArray,Mt.prototype._setValue_fromArray_setNeedsUpdate,Mt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class m1{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const s=t.tracks,a=s.length,o=new Array(a),u={endingStart:Zr,endingEnd:Zr};for(let f=0;f!==a;++f){const h=s[f].createInterpolant(null);o[f]=h,h.settings=u}this._interpolantSettings=u,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Zv,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,s=e._clip.duration,a=s/i,o=i/s;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,s=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const u=o.parameterPositions,f=o.sampleValues;return u[0]=s,u[1]=s+n,f[0]=e/a,f[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const u=(e-s)*n;if(u<0||n===0)return;this._startTime=null,t=n*u}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const u=this._interpolants,f=this._propertyBindings;switch(this.blendMode){case Vf:for(let h=0,c=u.length;h!==c;++h)u[h].evaluate(a),f[h].accumulateAdditive(o);break;case yc:default:for(let h=0,c=u.length;h!==c;++h)u[h].evaluate(a),f[h].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,s=this._loopCount;const a=n===$v;if(e===0)return s===-1?i:a&&(s&1)===1?t-i:i;if(n===Yv){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const o=Math.floor(i/t);i-=t*o,s+=Math.abs(o);const u=this.repetitions-s;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const f=e<0;this._setEndings(f,!f,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(s&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=$r,i.endingEnd=$r):(e?i.endingStart=this.zeroSlopeAtStart?$r:Zr:i.endingStart=oo,t?i.endingEnd=this.zeroSlopeAtEnd?$r:Zr:i.endingEnd=oo)}_scheduleFading(e,t,n){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,u=a.sampleValues;return o[0]=s,u[0]=t,o[1]=s+e,u[1]=n,this}}class g1 extends Ki{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,o=e._interpolants,u=n.uuid,f=this._bindingsByRootAndName;let h=f[u];h===void 0&&(h={},f[u]=h);for(let c=0;c!==s;++c){const d=i[c],g=d.name;let x=h[g];if(x!==void 0)a[c]=x;else{if(x=a[c],x!==void 0){x._cacheIndex===null&&(++x.referenceCount,this._addInactiveBinding(x,u,g));continue}const v=t&&t._propertyBindings[c].binding.parsedPath;x=new s1(Mt.create(n,g,v),d.ValueTypeName,d.getValueSize()),++x.referenceCount,this._addInactiveBinding(x,u,g),a[c]=x}o[c].resultBuffer=x.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],u=o.knownActions,f=u[u.length-1],h=e._byClipCacheIndex;f._byClipCacheIndex=h,u[h]=f,u.pop(),e._byClipCacheIndex=null;const c=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete c[d],u.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,o=a[i],u=t[t.length-1],f=e._cacheIndex;u._cacheIndex=f,t[f]=u,t.pop(),delete o[s],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new Ad(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?kh.findByName(i,e):e;const o=a!==null?a.uuid:e,u=this._actionsByClip[o];let f=null;if(n===void 0&&(a!==null?n=a.blendMode:n=yc),u!==void 0){const c=u.actionByRoot[s];if(c!==void 0&&c.blendMode===n)return c;f=u.knownActions[0],a===null&&(a=f._clip)}if(a===null)return null;const h=new m1(this,a,t,n);return this._bindAction(h,f),this._addInactiveAction(h,o,s),h}existingAction(e,t){const n=t||this._root,i=n.uuid,s=typeof e=="string"?kh.findByName(n,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let f=0;f!==n;++f)t[f]._update(i,e,s,a);const o=this._bindings,u=this._nActiveBindings;for(let f=0;f!==u;++f)o[f].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,s=i[n];if(s!==void 0){const a=s.knownActions;for(let o=0,u=a.length;o!==u;++o){const f=a[o];this._deactivateAction(f);const h=f._cacheIndex,c=t[t.length-1];f._cacheIndex=null,f._byClipCacheIndex=null,c._cacheIndex=h,t[h]=c,t.pop(),this._removeInactiveBindingsForAction(f)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const o=n[a].actionByRoot,u=o[t];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}g1.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class v1 extends sa{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}v1.prototype.isInstancedInterleavedBuffer=!0;class qh{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Rn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class y1 extends bt{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}y1.prototype.isImmediateRenderObject=!0;const ki=new V,Xa=new st,Ul=new st;class x1 extends Cc{constructor(e){const t=Id(e),n=new Rt,i=[],s=[],a=new Ke(0,0,1),o=new Ke(0,1,0);for(let f=0;f<t.length;f++){const h=t[f];h.parent&&h.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}n.setAttribute("position",new qt(i,3)),n.setAttribute("color",new qt(s,3));const u=new gs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,u),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");Ul.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const o=t[s];o.parent&&o.parent.isBone&&(Xa.multiplyMatrices(Ul,o.matrixWorld),ki.setFromMatrixPosition(Xa),i.setXYZ(a,ki.x,ki.y,ki.z),Xa.multiplyMatrices(Ul,o.parent.matrixWorld),ki.setFromMatrixPosition(Xa),i.setXYZ(a+1,ki.x,ki.y,ki.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Id(r){const e=[];r&&r.isBone&&e.push(r);for(let t=0;t<r.children.length;t++)e.push.apply(e,Id(r.children[t]));return e}class Fd extends Cc{constructor(e=10,t=10,n=4473924,i=8947848){n=new Ke(n),i=new Ke(i);const s=t/2,a=e/t,o=e/2,u=[],f=[];for(let d=0,g=0,x=-o;d<=t;d++,x+=a){u.push(-o,0,x,o,0,x),u.push(x,0,-o,x,0,o);const v=d===s?n:i;v.toArray(f,g),g+=3,v.toArray(f,g),g+=3,v.toArray(f,g),g+=3,v.toArray(f,g),g+=3}const h=new Rt;h.setAttribute("position",new qt(u,3)),h.setAttribute("color",new qt(f,3));const c=new gs({vertexColors:!0,toneMapped:!1});super(h,c),this.type="GridHelper"}}const _1=new Float32Array(1);new Int32Array(_1.buffer);Zn.create=function(r,e){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(Zn.prototype),r.prototype.constructor=r,r.prototype.getPoint=e,r};lc.prototype.fromPoints=function(r){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)};Fd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};x1.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};er.prototype.extractUrlBase=function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),JM.extractUrlBase(r)};er.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};ci.prototype.center=function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)};ci.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};ci.prototype.isIntersectionBox=function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)};ci.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)};ci.prototype.size=function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)};fs.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Lo.prototype.setFromMatrix=function(r){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(r)};cn.prototype.flattenToArrayOffset=function(r,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,e)};cn.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)};cn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};cn.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)};cn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};cn.prototype.getInverse=function(r){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()};st.prototype.extractPosition=function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)};st.prototype.flattenToArrayOffset=function(r,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,e)};st.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new V().setFromMatrixColumn(this,3)};st.prototype.setRotationFromQuaternion=function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)};st.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};st.prototype.multiplyVector3=function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};st.prototype.multiplyVector4=function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};st.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};st.prototype.rotateAxis=function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)};st.prototype.crossVector=function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};st.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};st.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};st.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};st.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};st.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};st.prototype.applyToBufferAttribute=function(r){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)};st.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};st.prototype.makeFrustum=function(r,e,t,n,i,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,e,n,t,i,s)};st.prototype.getInverse=function(r){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(r).invert()};Li.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)};mn.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)};mn.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};ds.prototype.isIntersectionBox=function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)};ds.prototype.isIntersectionPlane=function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)};ds.prototype.isIntersectionSphere=function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)};Yt.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};Yt.prototype.barycoordFromPoint=function(r,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,e)};Yt.prototype.midpoint=function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)};Yt.prototypenormal=function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)};Yt.prototype.plane=function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)};Yt.barycoordFromPoint=function(r,e,t,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Yt.getBarycoord(r,e,t,n,i)};Yt.normal=function(r,e,t,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Yt.getNormal(r,e,t,n)};Fc.prototype.extractAllPoints=function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)};Fc.prototype.extrude=function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new vs(this,r)};Fc.prototype.makeGeometry=function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Dc(this,r)};Fe.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)};Fe.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)};Fe.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};V.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};V.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};V.prototype.getPositionFromMatrix=function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)};V.prototype.getScaleFromMatrix=function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)};V.prototype.getColumnFromMatrix=function(r,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,r)};V.prototype.applyProjection=function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)};V.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)};V.prototype.distanceToManhattan=function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)};V.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Ct.prototype.fromAttribute=function(r,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,e,t)};Ct.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};bt.prototype.getChildByName=function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)};bt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};bt.prototype.translate=function(r,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,r)};bt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};bt.prototype.applyMatrix=function(r){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)};Object.defineProperties(bt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});wn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(wn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Jv},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});gd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};xn.prototype.setLens=function(r,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(r)};Object.defineProperties(vi.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}});Object.defineProperties(Kt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===lo},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(lo)}}});Kt.prototype.setDynamic=function(r){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?lo:Qs),this};Kt.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Kt.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Rt.prototype.addIndex=function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)};Rt.prototype.addAttribute=function(r,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(e&&e.isBufferAttribute)&&!(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(r,new Kt(arguments[1],arguments[2]))):r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(r,e)};Rt.prototype.addDrawCall=function(r,e,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,e)};Rt.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};Rt.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};Rt.prototype.removeAttribute=function(r){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(r)};Rt.prototype.applyMatrix=function(r){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)};Object.defineProperties(Rt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});sa.prototype.setDynamic=function(r){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?lo:Qs),this};sa.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};vs.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};vs.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};vs.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};Ac.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};Object.defineProperties(yn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ke}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===zf}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(r){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=r}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(xr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}});Et.prototype.clearTarget=function(r,e,t,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(r),this.clear(e,t,n)};Et.prototype.animate=function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)};Et.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};Et.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};Et.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};Et.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};Et.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};Et.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};Et.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};Et.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};Et.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};Et.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};Et.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};Et.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};Et.prototype.enableScissorTest=function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)};Et.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};Et.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};Et.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};Et.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};Et.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};Et.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};Et.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};Et.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};Et.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};Et.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(Et.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(r){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=r===!0?To:Nn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}});Object.defineProperties(fd.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(mi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}});r1.prototype.load=function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return new t1().load(r,function(n){e.setBuffer(n)}),this};bc.prototype.updateCubeMap=function(r,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,e)};bc.prototype.clear=function(r,e,t,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(r,e,t,n)};hs.crossOrigin=void 0;hs.loadTexture=function(r,e,t,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new GM;i.setCrossOrigin(this.crossOrigin);const s=i.load(r,t,void 0,n);return e&&(s.mapping=e),s};hs.loadTextureCube=function(r,e,t,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new VM;i.setCrossOrigin(this.crossOrigin);const s=i.load(r,t,void 0,n);return e&&(s.mapping=e),s};hs.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};hs.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Bf}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Bf);function w1(r,e){let t=180/Math.PI*e,n=Math.PI/180,i=r+t*Math.sin(r*n),s=1e-5,a,o,u=i,f=0,h=1;for(let c=0;c<1e3&&h>s;c++)o=r-(u-t*Math.sin(n*u)),a=o/(1-e*Math.cos(n*u)),f=u+a,h=Math.abs(u-f);return f}let gr=[["Mercury",.38709927,.20563593,7.00497902,252.2503235,77.45779628,48.33076593,37e-8,1906e-8,-.00594749,149472.67411175,.16047689,-.12534081,0,0,0,0],["Venus",.72333566,.00677672,3.39467605,181.9790995,131.60246718,76.67984255,39e-7,-4107e-8,-7889e-7,58517.81538729,.00268329,-.27769418,0,0,0,0],["EM Bary",1.00000261,.01671123,-1531e-8,100.46457166,102.93768193,0,562e-8,-4392e-8,-.01294668,35999.37244981,.32327364,0,0,0,0,0],["Mars",1.52371034,.0933941,1.84969142,-4.55343205,-23.94362959,49.55953891,1847e-8,-7882e-8,-.00813131,19140.30268499,.44441088,-.29257343,0,0,0,0],["Jupiter",5.202887,.04838624,1.30439695,34.39644051,14.72847983,100.47390909,-11607e-8,-13253e-8,-.00183714,3034.74612775,.21252668,.20469106,0,0,0,0],["Saturn",9.53667594,.05386179,2.48599187,49.95424423,92.59887831,113.66242448,-.0012506,-50991e-8,.00193609,1222.49362201,-.41897216,-.28867794,0,0,0,0],["Uranus",19.18916464,.04725744,.77263783,313.23810451,170.9542763,74.01692503,-.00196176,-4397e-8,-.00242939,428.48202785,.40805281,.04240589,0,0,0,0],["Neptune",30.06992276,.00859048,1.77004347,-55.12002969,44.96476227,131.78422574,26291e-8,5105e-8,35372e-8,218.45945325,-.32241464,-.00508664,0,0,0,0],["Pluto",39.48211675,.2488273,17.14001206,238.92903833,224.06891629,110.30393684,-31596e-8,517e-7,4818e-8,145.20780515,-.04062942,-.01183482,0,0,0,0]];function kn(r){return r*Math.PI/180}function b1(r,e,t,n,i,s){let a=[[Xn(kn(n)),-Vi(kn(n)),0],[Vi(kn(n)),Xn(kn(n)),0],[0,0,1]],o=[[1,0,0],[0,Xn(kn(s)),-Vi(kn(s))],[0,Vi(kn(s)),Xn(kn(s))]],u=[[Xn(kn(i)),-Vi(kn(i)),0],[Vi(kn(i)),Xn(kn(i)),0],[0,0,1]],f=[[r],[e],[t]];return tl(tl(tl(a,o),u),f)}function ho(r,e,t){let n=r[e][2],i=r[e][1],a=(t/1e3/86400+24405875e-1-2451545)/365.25/100,o=r[e][5],u=r[e][11],f=o+u*a,h=r[e][6],c=r[e][12],d=h+c*a,g=r[e][4],x=r[e][10],v=g+x*a,b=f-d,y=v-f;(y<-180||y>180)&&(y=y%360);let w=kn(w1(y,n)),S=_0(gc((1+n)/(1-n))*M0(w/2))*2,L=i*(1-n**2)/(1+n*Xn(S)),T=L*Xn(S),m=L*Vi(S);return b1(T,m,0,d,b,r[e][3])}function M1(r,e,t){let n=[],i=e[r][1],s=Math.pow(i,3/2);for(let h=0;h<s;h+=s/100){let c=ho(e,r,Date.now()+h*365.25*3600*24*1e3);n.push(new V(c[0],c[1],c[2]))}n.push(n[0]);const a=new Rt().setFromPoints(n),o=new gs({color:t}),u=new Po(a,o),f=new Jr;return f.add(u),f}function S1(r,e,t,n,i,s,a,o){let u=149598023e3,f=r-n,h=(e-i)*Math.cos(o)-(t-s)*Math.sin(o),c=(e-i)*Math.sin(o)+(t-s)*Math.cos(o),d=[f,h,c];return console.log("x', y', z' : "+(d[0]/u).toString()+" "+(d[1]/u).toString()+" "+(d[2]/u).toString()+" "),d}function E1(r,e,t){let n,i;return n=Math.atan(t/gc(r*r+e*e)),r>0&&e>=0&&(i=Math.atan(e/r)),r<=0&&(i=Math.PI+Math.atan(e/r)),r>0&&e<0&&(i=2*Math.PI+Math.atan(e/r)),[n,i]}function T1(r,e,t,n,i,s,a,o,u,f){return r+Od[2]/gc((i-o)*(i-o)+(s-u)*(s-u)+(a-f)*(a-f))*(-Xn(n)*Xn(r)*Xn(e-t)+Vi(n)*Xn(r))}function A1(r,e,t,n){let i=Math.asin(Math.sin(t)*Math.sin(r)+Math.cos(t)*Math.cos(r)*Math.cos(n-e)),s;return console.log(Math.asin(Math.cos(r)*Math.sin(n-e)/Math.cos(i))/Math.PI*180),n-e<Math.PI?s=Math.PI+Math.acos((Math.sin(t)*Math.sin(i)-Math.sin(r))/Math.cos(t)/Math.cos(i)):s=Math.PI+Math.acos((-Math.sin(t)*Math.sin(i)+Math.sin(r))/Math.cos(t)/Math.cos(i)),[i,s]}function Bd(r,e){let t=r.getUTCFullYear(),n=r.getUTCMonth()+1,i=r.getUTCDate(),s=r.getUTCHours(),a=r.getUTCMinutes(),o=r.getUTCSeconds();(n===1||n===2)&&(t=t-1,n=n+12);let u=Math.floor(t/100),f=2-u+Math.floor(u/4),h=Math.floor(365.25*t),c=Math.floor(30.6001*(n+1)),d=f+h+c-730550.5+i+(s+a/60+o/3600)/24,g=d/36525,x=280.46061837+360.98564736629*d+387933e-9*g*g-g*g*g/3871e4+e;if(x>0)for(;x>360;)x-=360;else for(;x<0;)x+=360;return x/15}function fo(r){return r<10?"0"+r:r}function kl(r){return Math.trunc(r)+"<sup>\xB0</sup>"+fo(Math.abs(Math.trunc((r-Math.trunc(r))*60)))+"<sup>'</sup>"+fo(Math.abs(Math.round(((r-Math.trunc(r))*60-Math.trunc((r-Math.trunc(r))*60))*60)))+'<sup>"</sup>'}function cc(r){return Math.trunc(r)+"<sup>h</sup>"+fo(Math.abs(Math.trunc((r-Math.trunc(r))*60)))+"<sup>m</sup>"+fo(Math.abs(Math.round(((r-Math.trunc(r))*60-Math.trunc((r-Math.trunc(r))*60))*60)))+"<sup>s</sup>"}const jh={type:"change"},Hl={type:"start"},Vl={type:"end"};class C1 extends Ki{constructor(e,t){super(),t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new V,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Er.ROTATE,MIDDLE:Er.DOLLY,RIGHT:Er.PAN},this.touches={ONE:Tr.ROTATE,TWO:Tr.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(q){q.addEventListener("keydown",J),this._domElementKeyEvents=q},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(jh),n.update(),s=i.NONE},this.update=function(){const q=new V,Pe=new mn().setFromUnitVectors(e.up,new V(0,1,0)),ct=Pe.clone().invert(),pt=new V,Nt=new mn,ft=2*Math.PI;return function(){const en=n.object.position;q.copy(en).sub(n.target),q.applyQuaternion(Pe),o.setFromVector3(q),n.autoRotate&&s===i.NONE&&z(C()),n.enableDamping?(o.theta+=u.theta*n.dampingFactor,o.phi+=u.phi*n.dampingFactor):(o.theta+=u.theta,o.phi+=u.phi);let rn=n.minAzimuthAngle,hn=n.maxAzimuthAngle;return isFinite(rn)&&isFinite(hn)&&(rn<-Math.PI?rn+=ft:rn>Math.PI&&(rn-=ft),hn<-Math.PI?hn+=ft:hn>Math.PI&&(hn-=ft),rn<=hn?o.theta=Math.max(rn,Math.min(hn,o.theta)):o.theta=o.theta>(rn+hn)/2?Math.max(rn,o.theta):Math.min(hn,o.theta)),o.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=f,o.radius=Math.max(n.minDistance,Math.min(n.maxDistance,o.radius)),n.enableDamping===!0?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),q.setFromSpherical(o),q.applyQuaternion(ct),en.copy(n.target).add(q),n.object.lookAt(n.target),n.enableDamping===!0?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),h.set(0,0,0)),f=1,c||pt.distanceToSquared(n.object.position)>a||8*(1-Nt.dot(n.object.quaternion))>a?(n.dispatchEvent(jh),pt.copy(n.object.position),Nt.copy(n.object.quaternion),c=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Me),n.domElement.removeEventListener("pointerdown",Ae),n.domElement.removeEventListener("pointercancel",O),n.domElement.removeEventListener("wheel",X),n.domElement.removeEventListener("pointermove",ke),n.domElement.removeEventListener("pointerup",pe),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",J)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=i.NONE;const a=1e-6,o=new qh,u=new qh;let f=1;const h=new V;let c=!1;const d=new Fe,g=new Fe,x=new Fe,v=new Fe,b=new Fe,y=new Fe,w=new Fe,S=new Fe,L=new Fe,T=[],m={};function C(){return 2*Math.PI/60/60*n.autoRotateSpeed}function N(){return Math.pow(.95,n.zoomSpeed)}function z(q){u.theta-=q}function W(q){u.phi-=q}const B=function(){const q=new V;return function(ct,pt){q.setFromMatrixColumn(pt,0),q.multiplyScalar(-ct),h.add(q)}}(),se=function(){const q=new V;return function(ct,pt){n.screenSpacePanning===!0?q.setFromMatrixColumn(pt,1):(q.setFromMatrixColumn(pt,0),q.crossVectors(n.object.up,q)),q.multiplyScalar(ct),h.add(q)}}(),$=function(){const q=new V;return function(ct,pt){const Nt=n.domElement;if(n.object.isPerspectiveCamera){const ft=n.object.position;q.copy(ft).sub(n.target);let _t=q.length();_t*=Math.tan(n.object.fov/2*Math.PI/180),B(2*ct*_t/Nt.clientHeight,n.object.matrix),se(2*pt*_t/Nt.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(B(ct*(n.object.right-n.object.left)/n.object.zoom/Nt.clientWidth,n.object.matrix),se(pt*(n.object.top-n.object.bottom)/n.object.zoom/Nt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function Q(q){n.object.isPerspectiveCamera?f/=q:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*q)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function K(q){n.object.isPerspectiveCamera?f*=q:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/q)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function j(q){d.set(q.clientX,q.clientY)}function ie(q){w.set(q.clientX,q.clientY)}function de(q){v.set(q.clientX,q.clientY)}function we(q){g.set(q.clientX,q.clientY),x.subVectors(g,d).multiplyScalar(n.rotateSpeed);const Pe=n.domElement;z(2*Math.PI*x.x/Pe.clientHeight),W(2*Math.PI*x.y/Pe.clientHeight),d.copy(g),n.update()}function Ne(q){S.set(q.clientX,q.clientY),L.subVectors(S,w),L.y>0?Q(N()):L.y<0&&K(N()),w.copy(S),n.update()}function Se(q){b.set(q.clientX,q.clientY),y.subVectors(b,v).multiplyScalar(n.panSpeed),$(y.x,y.y),v.copy(b),n.update()}function Ve(q){q.deltaY<0?K(N()):q.deltaY>0&&Q(N()),n.update()}function ue(q){let Pe=!1;switch(q.code){case n.keys.UP:$(0,n.keyPanSpeed),Pe=!0;break;case n.keys.BOTTOM:$(0,-n.keyPanSpeed),Pe=!0;break;case n.keys.LEFT:$(n.keyPanSpeed,0),Pe=!0;break;case n.keys.RIGHT:$(-n.keyPanSpeed,0),Pe=!0;break}Pe&&(q.preventDefault(),n.update())}function Ee(){if(T.length===1)d.set(T[0].pageX,T[0].pageY);else{const q=.5*(T[0].pageX+T[1].pageX),Pe=.5*(T[0].pageY+T[1].pageY);d.set(q,Pe)}}function Oe(){if(T.length===1)v.set(T[0].pageX,T[0].pageY);else{const q=.5*(T[0].pageX+T[1].pageX),Pe=.5*(T[0].pageY+T[1].pageY);v.set(q,Pe)}}function re(){const q=T[0].pageX-T[1].pageX,Pe=T[0].pageY-T[1].pageY,ct=Math.sqrt(q*q+Pe*Pe);w.set(0,ct)}function ze(){n.enableZoom&&re(),n.enablePan&&Oe()}function je(){n.enableZoom&&re(),n.enableRotate&&Ee()}function Ie(q){if(T.length==1)g.set(q.pageX,q.pageY);else{const ct=Ue(q),pt=.5*(q.pageX+ct.x),Nt=.5*(q.pageY+ct.y);g.set(pt,Nt)}x.subVectors(g,d).multiplyScalar(n.rotateSpeed);const Pe=n.domElement;z(2*Math.PI*x.x/Pe.clientHeight),W(2*Math.PI*x.y/Pe.clientHeight),d.copy(g)}function Be(q){if(T.length===1)b.set(q.pageX,q.pageY);else{const Pe=Ue(q),ct=.5*(q.pageX+Pe.x),pt=.5*(q.pageY+Pe.y);b.set(ct,pt)}y.subVectors(b,v).multiplyScalar(n.panSpeed),$(y.x,y.y),v.copy(b)}function Xe(q){const Pe=Ue(q),ct=q.pageX-Pe.x,pt=q.pageY-Pe.y,Nt=Math.sqrt(ct*ct+pt*pt);S.set(0,Nt),L.set(0,Math.pow(S.y/w.y,n.zoomSpeed)),Q(L.y),w.copy(S)}function fe(q){n.enableZoom&&Xe(q),n.enablePan&&Be(q)}function ge(q){n.enableZoom&&Xe(q),n.enableRotate&&Ie(q)}function Ae(q){n.enabled!==!1&&(T.length===0&&(n.domElement.setPointerCapture(q.pointerId),n.domElement.addEventListener("pointermove",ke),n.domElement.addEventListener("pointerup",pe)),U(q),q.pointerType==="touch"?Y(q):F(q))}function ke(q){n.enabled!==!1&&(q.pointerType==="touch"?ve(q):ye(q))}function pe(q){n.enabled!==!1&&(q.pointerType==="touch"?Te():D(),ce(q),T.length===0&&(n.domElement.releasePointerCapture(q.pointerId),n.domElement.removeEventListener("pointermove",ke),n.domElement.removeEventListener("pointerup",pe)))}function O(q){ce(q)}function F(q){let Pe;switch(q.button){case 0:Pe=n.mouseButtons.LEFT;break;case 1:Pe=n.mouseButtons.MIDDLE;break;case 2:Pe=n.mouseButtons.RIGHT;break;default:Pe=-1}switch(Pe){case Er.DOLLY:if(n.enableZoom===!1)return;ie(q),s=i.DOLLY;break;case Er.ROTATE:if(q.ctrlKey||q.metaKey||q.shiftKey){if(n.enablePan===!1)return;de(q),s=i.PAN}else{if(n.enableRotate===!1)return;j(q),s=i.ROTATE}break;case Er.PAN:if(q.ctrlKey||q.metaKey||q.shiftKey){if(n.enableRotate===!1)return;j(q),s=i.ROTATE}else{if(n.enablePan===!1)return;de(q),s=i.PAN}break;default:s=i.NONE}s!==i.NONE&&n.dispatchEvent(Hl)}function ye(q){if(n.enabled!==!1)switch(s){case i.ROTATE:if(n.enableRotate===!1)return;we(q);break;case i.DOLLY:if(n.enableZoom===!1)return;Ne(q);break;case i.PAN:if(n.enablePan===!1)return;Se(q);break}}function D(q){n.dispatchEvent(Vl),s=i.NONE}function X(q){n.enabled===!1||n.enableZoom===!1||s!==i.NONE&&s!==i.ROTATE||(q.preventDefault(),n.dispatchEvent(Hl),Ve(q),n.dispatchEvent(Vl))}function J(q){n.enabled===!1||n.enablePan===!1||ue(q)}function Y(q){switch(oe(q),T.length){case 1:switch(n.touches.ONE){case Tr.ROTATE:if(n.enableRotate===!1)return;Ee(),s=i.TOUCH_ROTATE;break;case Tr.PAN:if(n.enablePan===!1)return;Oe(),s=i.TOUCH_PAN;break;default:s=i.NONE}break;case 2:switch(n.touches.TWO){case Tr.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ze(),s=i.TOUCH_DOLLY_PAN;break;case Tr.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;je(),s=i.TOUCH_DOLLY_ROTATE;break;default:s=i.NONE}break;default:s=i.NONE}s!==i.NONE&&n.dispatchEvent(Hl)}function ve(q){switch(oe(q),s){case i.TOUCH_ROTATE:if(n.enableRotate===!1)return;Ie(q),n.update();break;case i.TOUCH_PAN:if(n.enablePan===!1)return;Be(q),n.update();break;case i.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;fe(q),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ge(q),n.update();break;default:s=i.NONE}}function Te(q){n.dispatchEvent(Vl),s=i.NONE}function Me(q){n.enabled!==!1&&q.preventDefault()}function U(q){T.push(q)}function ce(q){delete m[q.pointerId];for(let Pe=0;Pe<T.length;Pe++)if(T[Pe].pointerId==q.pointerId){T.splice(Pe,1);return}}function oe(q){let Pe=m[q.pointerId];Pe===void 0&&(Pe=new Fe,m[q.pointerId]=Pe),Pe.set(q.pageX,q.pageY)}function Ue(q){const Pe=q.pointerId===T[0].pointerId?T[1]:T[0];return m[Pe.pointerId]}n.domElement.addEventListener("contextmenu",Me),n.domElement.addEventListener("pointerdown",Ae),n.domElement.addEventListener("pointercancel",O),n.domElement.addEventListener("wheel",X,{passive:!1}),this.update()}}const Hn=new Ac,L1=-26.78,po={0:15260087,1:16108583,2:2867795,3:15884831,4:14072227,5:15587712,6:9629928,7:4490452,8:14717323},Od={0:2440500,1:6051800,2:64e5,3:3396200,4:71492e3,5:60268e3,6:25559e3,7:24764e3,8:1188e3},R1={0:.106,1:.65,2:.367,3:.15,4:.52,5:.47,6:.51,7:.41,8:.6};async function P1(){let r=document.getElementById("phi-input"),e=document.getElementById("lambda-input"),t=document.getElementById("date-input"),n=document.getElementById("time-input"),i=document.getElementById("select-planet");if(t.value!==""&&n.value!==""&&i.value!==""&&r.value!==""&&e.value!==""){console.log(Hn);let s=[];for(let Q=0;Q<Hn.children.length;Q++)Hn.children[Q].type!=="Mesh"&&s.push(Hn.children[Q]);Hn.children=s;let a=new Date(t.value.substr(0,4),parseInt(t.value.substr(5,2))-1,t.value.substr(8,2),n.value.substr(0,2),n.value.substr(3,2)),o=Xs(0,0,0,15787293,2);Hn.add(o);let u=ho(gr,2,a),f=Xs(u[0],u[1],u[2],po[2],gr[2][1]);Hn.add(f);let h=149598023e3,c=u[0]*h,d=u[1]*h,g=u[2]*h;u=ho(gr,parseInt(i.value),a),f=Xs(u[0],u[1],u[2],po[parseInt(i.value)],gr[parseInt(i.value)][1]),Hn.add(f);let x=u[0]*h,v=u[1]*h,b=u[2]*h,y=Od[parseInt(i.value)],w=R1[parseInt(i.value)],S=L1+2.5*Math.log10(4*(x*x+v*v+b*b)*(Math.pow(x-c,2)+Math.pow(v-d,2)+Math.pow(b-g,2))/(h*h*y*y*w*(1+(x*(x-c)+v*(v-d)+b*(x-g))/Math.sqrt(Math.pow(x-c,2)+Math.pow(v-d,2)+Math.pow(b-g,2))/Math.sqrt(Math.pow(x,2)+Math.pow(v,2)+Math.pow(b,2))))),L=document.getElementById("delta"),T=document.getElementById("alpha"),m=document.getElementById("azimut"),C=document.getElementById("height"),N=document.getElementById("apparent-magnitude"),z=S1(x,v,b,c,d,g,0*Math.PI/180,23.43928*Math.PI/180),W=E1(z[0],z[1],z[2]),B=Date.parse(t.value+"T"+n.value+":00"),se=Bd(new Date(B),parseFloat(e.value)),$=T1(W[0],se/12*Math.PI,W[1],parseFloat(r.value)/180*Math.PI,x,v,b,c,d,g);L.innerHTML="\u0421\u043A\u043B\u043E\u043D\u0435\u043D\u0438\u0435: \u03B4 = "+kl(W[0]/Math.PI*180),T.innerHTML="\u041F\u0440\u044F\u043C\u043E\u0435 \u0432\u043E\u0441\u0445\u043E\u0436\u0434\u0435\u043D\u0438\u0435: \u03B1 = "+cc(W[1]/Math.PI*12),N.innerHTML="\u0412\u0438\u0434\u0438\u043C\u0430\u044F \u0437\u0432\u0435\u0437\u0434\u043D\u0430\u044F \u0432\u0435\u043B\u0438\u0447\u0438\u043D\u0430: m = "+(Math.round(S*100)/100).toString()+"<sup>m</sup>",A1($,W[1],parseFloat(r.value)/180*Math.PI,se/12*Math.PI),m.innerHTML="\u0410\u0437\u0438\u043C\u0443\u0442 (\u0430\u0441\u0442\u0440\u043E\u043D\u043E\u043C\u0438\u0447\u0435\u0441\u043A\u0438\u0439): A = "+kl(W[0]/Math.PI*180),C.innerHTML="\u0412\u044B\u0441\u043E\u0442\u0430: h = "+kl(W[0]/Math.PI*180)}}function N1(){let r=document.getElementById("phi-input"),e=document.getElementById("lambda-input");$a.get("https://www.cloudflare.com/cdn-cgi/trace",function(t){t=t.trim().split(`
`).reduce(function(n,i){return i=i.split("="),n[i[0]]=i[1],n},{}),console.log(t.ip),$a.get(`http://ip-api.com/json/${t.ip}`,function(n){console.log(n),r.value=Math.round(parseFloat(n.lat)*100)/100,e.value=Math.round(parseFloat(n.lon)*100)/100},"jsonp")})}function Xs(r,e,t,n,i){const s=new Ic(.02*i,32,16),a=new Ao({color:n}),o=new wn(s,a);return o.position.set(r,e,t),o}function D1(){let r=$a("#map-block");const e=new xn(75,r.width()/r.height(),.1,2e3);e.up.set(0,0,1),e.position.set(0,5,5);const t=new Et;t.setSize(r.width(),r.height()),r.append(t.domElement);const n=100,i=4,s=new Fd(n,i);s.rotateX(.5*Math.PI),Hn.add(s);const a=new C1(e,t.domElement);a.update();for(let f=0;f<=8;f++){let h=M1(f,gr,po[f]);Hn.add(h);let c=ho(gr,f,Date.now()),d=Xs(c[0],c[1],c[2],po[f],gr[f][1]);Hn.add(d)}let o=Xs(0,0,0,15787293,2);Hn.add(o),window.addEventListener("resize",function(){t.setSize(r.width(),r.height())});function u(){requestAnimationFrame(u),a.update(),t.render(Hn,e)}u()}$a(document).ready(function(){console.log(cc(Bd(new Date(Date.now()),37.62)));let r=document.getElementById("count-button"),e=document.getElementById("phi-input"),t=document.getElementById("lambda-input"),n=document.getElementById("phi-lambda-checkbox");r.addEventListener("click",P1),console.log(cc(-2.45)),n.addEventListener("change",i=>{i.currentTarget.checked?N1():(e.value="",t.value="")}),D1()});
